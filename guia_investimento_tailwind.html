<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Domine os Investimentos - Guia Completo</title>
    <link rel="stylesheet" href="dist/output.css">
    <meta name="description" content="Guia completo de investimentos com capítulos didáticos, quizzes e recursos práticos para planejamento financeiro.">
    <meta name="theme-color" content="#2563eb" />
    <meta name="color-scheme" content="light dark" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script>
        // Scroll progress bar logic (mantido)
        (function(){
            const bar = document.getElementById('scrollProgress');
            function update(){
                if(!bar) return;
                const h = document.documentElement.scrollHeight - window.innerHeight;
                const y = window.scrollY;
                const pct = h>0 ? Math.min(100, Math.max(0, (y / h) * 100)) : 0;
                bar.style.width = pct + '%';
            }
            window.addEventListener('scroll', update, { passive: true });
            window.addEventListener('resize', update);
            document.addEventListener('DOMContentLoaded', update);
            update();
        })();
    </script>
    <style type="text/css">
        @page {
            size: A4;
            margin: 2cm;
        }
        .page {
            page-break-after: always;
            min-height: 29.7cm;
        }
        @media print {
            /* Hide non-essential UI */
            .no-print, .no-print *, #sidebar, #overlay, header, .fixed, .sticky { display: none !important; }
            /* Remove backgrounds and shadows for clean print */
            * { box-shadow: none !important; text-shadow: none !important; }
            body { color: #000 !important; background: #fff !important; }
            [class*="bg-gradient"], [class*="bg-"] { background: #fff !important; }
            a { color: #000 !important; text-decoration: underline; }
        }
        /* Mobile global tightening */
        @media (max-width: 640px) {
            /* Reduce overall page paddings */
            .page { padding: 1rem !important; }
            /* Respect mobile safe areas */
            body { padding-top: env(safe-area-inset-top); padding-bottom: env(safe-area-inset-bottom); }
            #sidebar { padding-bottom: calc(1rem + env(safe-area-inset-bottom)); }
            /* Tighten common horizontal paddings */
            .px-4 { padding-left: 0.5rem !important; padding-right: 0.5rem !important; }
            .px-6 { padding-left: 0.75rem !important; padding-right: 0.75rem !important; }
            /* Card paddings */
            .p-6 { padding: 0.75rem !important; }
            .p-4 { padding: 0.75rem !important; }
            /* Gaps and spacing for grids and stacks */
            .gap-6 { gap: 0.75rem !important; }
            .space-y-6 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.75rem !important; }
            /* Make action rows stack nicely */
            .action-row { flex-direction: column !important; gap: 0.5rem !important; }
            /* Cap 8.5 simulator: full-bleed and tighter paddings */
            #cap8-5 { margin-left: -8px; margin-right: -8px; }
            #cap8-5 > .bg-white { border-radius: 0; padding: 0.75rem !important; }
            #cap8-5 .grid { gap: 0.75rem !important; }
            #cap8-5 .bg-gray-50 { padding: 0.75rem !important; }
            #cap8-5 .flex.justify-between { flex-wrap: wrap; row-gap: 0.25rem; }
            #cap8-5 input[type="range"] { width: 100%; }
            /* Reduce chart height on mobile */
            #cap8-5 .h-64 { height: 10rem !important; }
        }

        /* Dark theme polish: cards, borders, text */
        .dark .bg-white { background-color: #0f172a !important; }
        .dark .bg-gray-50 { background-color: #0b1220 !important; }
        .dark .text-gray-900 { color: #e5e7eb !important; }
        .dark .text-gray-800 { color: #e5e7eb !important; }
        .dark .text-gray-700 { color: #cbd5e1 !important; }
        .dark .text-gray-600 { color: #94a3b8 !important; }
        .dark .border-gray-200 { border-color: #263247 !important; }
        .dark .shadow-sm, .dark .shadow { box-shadow: 0 1px 2px 0 rgba(0,0,0,0.4) !important; }
        .dark .hover\:bg-gray-50:hover { background-color: #0b1220 !important; }
        /* Premium petroleum/graphite palette */
        .dark .bg-blue-50 { background-color: #0b2a55 !important; }
        .dark .text-blue-800 { color: #93c5fd !important; }
        .dark .bg-primary-100 { background-color: #0b2a55 !important; }
        .dark .text-primary-800, .dark .text-primary-700 { color: #9ac1ff !important; }
        .dark .bg-green-50 { background-color: #0b2a1b !important; }
        .dark .text-green-800 { color: #86efac !important; }
        .dark .bg-yellow-50 { background-color: #3a2a00 !important; }
        .dark .text-yellow-800, .dark .text-yellow-700 { color: #facc15 !important; }
        .dark .bg-purple-50 { background-color: #231b33 !important; }
        .dark .text-purple-800, .dark .text-purple-700 { color: #c4b5fd !important; }
        .dark .bg-gray-100 { background-color: #0e1a2a !important; }
        .dark .bg-gray-200 { background-color: #1a2740 !important; }
        .dark .text-primary-600 { color: #60a5fa !important; }
        .dark .bg-blue-600 { background-color: #2563eb !important; }
        .dark .bg-accent-500 { background-color: #eab308 !important; }

        /* Smooth theme transitions (respect reduced motion) */
        @media (prefers-reduced-motion: no-preference) {
            html, body, .page, [class*="bg-"], [class*="text-"], [class*="border-"] {
                transition: background-color 200ms ease, color 200ms ease, border-color 200ms ease, box-shadow 200ms ease;
            }
        }

        /* Typography scale and spacing */
        body { line-height: 1.65; -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility; }
        h1, h2, h3, h4 { line-height: 1.25; }
        h1 { margin-top: 1.25rem; margin-bottom: 0.75rem; }
        h2 { margin-top: 1.25rem; margin-bottom: 0.5rem; }
        h3 { margin-top: 1rem; margin-bottom: 0.5rem; }
        p { margin-bottom: 0.9rem; }
        .content-block { margin-top: 1.25rem; margin-bottom: 1.25rem; max-width: 80ch; }
        .content-block.center { margin-left: auto; margin-right: auto; }
        /* Center default main titles in pages */
        .page h1, .page h2 { text-align: center; }
        /* Center subsection titles too */
        .page h3, .page h4 { text-align: center; }
        /* If headings use flex for icon/badge alignment, center the group */
        .page h2.flex, .page h3.flex, .page h4.flex { justify-content: center; }
        /* Chapter header: keep titles centered and place actions below */
        .page .mb-8 > .flex { flex-direction: column !important; align-items: center !important; gap: 1rem; }
        .page .mb-8 > .flex > div:first-child { text-align: center; max-width: 70ch; }
        /* Action block: place below title and center content */
        .page .mb-8 > .flex > div:last-child { order: 2; display:flex; flex-direction: column; align-items: center; gap: .5rem; }
        @media (min-width: 640px) {
          .page .mb-8 > .flex > div:last-child { flex-direction: row; justify-content: center; gap: .75rem; }
        }
        @media (min-width: 768px) {
          .page .mb-8 > .flex { gap: 1.25rem; }
        }

        /* Mini TOC panel */
        #miniToc { max-height: calc(100vh - 8rem); overflow: auto; }
        #miniToc a.active { color: #2563eb; font-weight: 600; }
        /* Mini TOC polish */
        #miniToc { backdrop-filter: saturate(120%) blur(8px); }
        #miniToc .toc-list { max-height: 50vh; overflow: auto; scrollbar-width: thin; }
        #miniToc .toc-list::-webkit-scrollbar { width: 6px; }
        #miniToc .toc-list::-webkit-scrollbar-thumb { background: rgba(100,116,139,.4); border-radius: 4px; }
        #miniToc .toc-link { display:block; padding:6px 8px; border-radius:8px; transition: background-color .15s ease, color .15s ease; }
        #miniToc .toc-link:hover { background: rgba(37,99,235,.08); }
        .dark #miniToc .toc-link:hover { background: rgba(37,99,235,.15); }
        #miniToc .toc-link.active { position: relative; }
        #miniToc .toc-link.active::before { content:""; position:absolute; left:-10px; top:8px; bottom:8px; width:3px; background:#2563eb; border-radius:2px; }
        #miniToc.collapsed .toc-list { display:none; }
        #miniToc .toc-header { display:flex; align-items:center; justify-content:space-between; gap:.5rem; }
        #miniToc .chev { transition: transform .15s ease; }
        #miniToc.collapsed .chev { transform: rotate(-90deg); }
        /* Sumário (page) styles */
        .sumario-grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(360px, 1fr)); gap:1.25rem; }
        .sumario-card { position:relative; border-radius:14px; border:1px solid rgba(148,163,184,.25); background: linear-gradient(180deg, rgba(255,255,255,.85), rgba(255,255,255,.75)); box-shadow: 0 6px 20px rgba(2,6,23,.06); padding:1.5rem; }
        .dark .sumario-card { background: linear-gradient(180deg, rgba(15,23,42,.75), rgba(2,6,23,.7)); border-color: rgba(30,41,59,.6); box-shadow: 0 8px 30px rgba(0,0,0,.35); }
        .sumario-card::before { content:""; position:absolute; inset:0; border-radius:14px; padding:1px; background: linear-gradient(135deg, rgba(37,99,235,.35), rgba(234,179,8,.25)); -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); -webkit-mask-composite: xor; mask-composite: exclude; pointer-events:none; }
        /* (revert) no hover zoom/reveal animations */
        .sumario-title { display:flex; align-items:center; gap:.6rem; font-weight:700; color:#1f2937; }
        .dark .sumario-title { color:#e5e7eb; }
        .sumario-title .badge { display:inline-flex; align-items:center; justify-content:center; width:1.75rem; height:1.75rem; font-size:.85rem; border-radius:.5rem; background:#2563eb; color:#fff; box-shadow: 0 2px 10px rgba(37,99,235,.35); }
        .sumario-list { margin-top:.5rem; }
        .sumario-item { display:flex; align-items:center; gap:.5rem; padding:.4rem .5rem; border-radius:.5rem; color:#1e3a8a; }
        .dark .sumario-item { color:#93c5fd; }
        .sumario-item:hover { background: rgba(37,99,235,.08); }
        .dark .sumario-item:hover { background: rgba(37,99,235,.18); }
        .num-badge { width:1.5rem; height:1.5rem; min-width:1.5rem; border-radius:.4rem; background:rgba(37,99,235,.12); color:#2563eb; display:inline-flex; align-items:center; justify-content:center; font-size:.75rem; font-weight:700; }
        .dark .num-badge { background: rgba(37,99,235,.25); color:#9ac1ff; }
        /* details/summary for collapse */
        .sumario-card details { border:0; }
        .sumario-card summary { list-style:none; cursor:pointer; display:flex; align-items:center; justify-content:space-between; }
        .sumario-card summary::-webkit-details-marker { display:none; }
        .sumario-card .chev { transition: transform .15s ease; color:#64748b; }
        .sumario-card[open] .chev { transform: rotate(0deg); }
        .sumario-card:not([open]) .chev { transform: rotate(-90deg); }
        /* Sumário header and collapsed state */
        #sumario .sumario-header { display:flex; flex-wrap:wrap; align-items:center; justify-content:center; gap:.75rem; text-align:center; }
        @media (min-width: 768px) { #sumario .sumario-header { justify-content:space-between; text-align:left; } }
        /* Revert: collapse hides only grid */
        #sumario.sumario-collapsed .sumario-grid { display:none; }
        #sumario .toggle-btn { display:inline-flex; align-items:center; gap:.5rem; padding:.375rem .625rem; border-radius:.5rem; border:1px solid rgba(148,163,184,.4); background: rgba(255,255,255,.6); }
        .dark #sumario .toggle-btn { background: rgba(2,6,23,.5); border-color: rgba(30,41,59,.7); }
        /* (revert) remove floating reopen button styles */
        /* Small screens: tighter spacing and single column */
        @media (max-width: 640px) {
          #sumario.page { padding: 1rem; }
          .sumario-grid { grid-template-columns: 1fr; gap:1rem; }
          .sumario-card { padding:1rem; }
          .sumario-title .badge { width:1.5rem; height:1.5rem; font-size:.8rem; }
          .sumario-item { padding:.3rem .4rem; }
        }
        /* Headings offset for sticky header when using anchors */
        :target { scroll-margin-top: 5.5rem; }
        h2[id], h3[id], h4[id] { scroll-margin-top: 5.5rem; }

        /* Responsive typography using clamp for headings */
        h1 { font-size: clamp(1.875rem, 2.5vw + 1rem, 3.5rem); }
        h2 { font-size: clamp(1.5rem, 1.8vw + 0.9rem, 2.25rem); }
        h3 { font-size: clamp(1.25rem, 1.2vw + 0.8rem, 1.5rem); }
        h4 { font-size: clamp(1.125rem, 1vw + 0.75rem, 1.25rem); }

        /* Media responsiveness */
        img, video, canvas, svg { max-width: 100%; height: auto; }
        iframe { max-width: 100%; }

        /* Table responsiveness */
        .table-wrap { overflow-x: auto; -webkit-overflow-scrolling: touch; }
        .table-wrap table { width: 100%; border-collapse: collapse; }
        .table-wrap th, .table-wrap td { white-space: nowrap; }

        /* Accessibility & focus */
        :focus-visible { outline: 2px solid #2563eb; outline-offset: 2px; }
        .dark :focus-visible { outline-color: #60a5fa; }

        /* Better page spacing on very small screens */
        @media (max-width: 380px) {
          body { font-size: 0.95rem; }
        }
    </style>
    <style>
        /* Layout widening: reduce side paddings of pages and allow more horizontal breathing room */
        .page { padding-left: clamp(0.75rem, 2.5vw, 2.5rem) !important; padding-right: clamp(0.75rem, 2.5vw, 2.5rem) !important; margin-left:auto; margin-right:auto; max-width: 1220px; }
        @media (min-width: 1280px){ .page { padding-left: clamp(2rem, 5vw, 4rem) !important; padding-right: clamp(2rem, 5vw, 4rem) !important; } }

        /* Stretch chapter headers to use more horizontal space */
        .page .mb-8 > .flex { align-items: stretch; }
        .page .mb-8 > .flex > div:first-child { flex: 1 1 auto; min-width: 0; }
        .page .mb-8 > .flex > div:last-child { flex: 0 0 auto; }

        /* Let typical max-width cards expand on pages (avoid affecting modals) */
        .page .max-w-md, .page .max-w-2xl, .page .max-w-3xl, .page .max-w-4xl { max-width: 100% !important; }
        .page .mx-auto { margin-left: 0 !important; margin-right: 0 !important; }
        .page .text-center.mx-auto { margin-left: auto !important; margin-right: auto !important; }
        /* Keep centered texts centered while content stretches */
        .page .text-center { margin-left: auto; margin-right: auto; }
    </style>
    <!-- Dependencies for features used below -->
    <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body class="bg-gray-50 text-gray-800 font-sans dark:bg-gray-900 dark:text-gray-100">
    <!-- Scroll Progress Bar -->
    <div class="fixed top-0 left-0 right-0 h-1 bg-gray-200 dark:bg-gray-700 z-30">
        <div id="scrollProgress" class="h-1 bg-blue-600 w-0 transition-[width] duration-150"></div>
    </div>
    <!-- Menu de Navegação Lateral -->
    <div id="sidebar" class="fixed inset-y-0 left-0 transform -translate-x-full w-72 sm:w-80 bg-white dark:bg-gray-800 shadow-xl z-20 transition-transform duration-300 ease-in-out overflow-y-auto">
        <div class="p-6">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-xl font-bold text-gray-900 dark:text-gray-100">Sumário</h2>
                <button id="closeSidebar" class="text-gray-500 hover:text-gray-700 focus:outline-none">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            
            <nav class="space-y-1">
                <a href="#introducao" class="block px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 font-medium transition-colors">
                    <i class="fas fa-home mr-3 text-blue-500"></i> Início
                </a>
                <a href="#sumario" class="block px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 font-medium transition-colors">
                    <i class="fas fa-list-ol mr-3 text-green-500"></i> Sumário
                </a>
                
                <div class="mt-4 pt-2 border-t border-gray-100">
                    <h3 class="px-4 text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Capítulos</h3>
                    <div class="space-y-1">
                        <a href="#cap1" class="block px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 text-sm transition-colors">
                            <i class="fas fa-book-open mr-3 text-blue-400"></i> 1. Fundamentos dos Investimentos
                        </a>
                        <a href="#cap2" class="block px-4 py-2 rounded-lg hover:bg-gray-100 text-gray-700 text-sm transition-colors">
                            <i class="fas fa-piggy-bank mr-3 text-green-400"></i> 2. Renda Fixa
                        </a>
                        <a href="#cap3" class="block px-4 py-2 rounded-lg hover:bg-gray-100 text-gray-700 text-sm transition-colors">
                            <i class="fas fa-chart-line mr-3 text-yellow-400"></i> 3. Renda Variável
                        </a>
                        <a href="#cap4" class="block px-4 py-2 rounded-lg hover:bg-gray-100 text-gray-700 text-sm transition-colors">
                            <i class="fas fa-chart-pie mr-3 text-purple-400"></i> 4. Fundos de Investimento
                        </a>
                        <a href="#cap5" class="block px-4 py-2 rounded-lg hover:bg-gray-100 text-gray-700 text-sm transition-colors">
                            <i class="fas fa-building mr-3 text-red-400"></i> 5. Fundos Imobiliários
                        </a>
                        <a href="#cap6" class="block px-4 py-2 rounded-lg hover:bg-gray-100 text-gray-700 text-sm transition-colors">
                            <i class="fas fa-chart-bar mr-3 text-indigo-400"></i> 6. ETFs
                        </a>
                        <a href="#cap7" class="block px-4 py-2 rounded-lg hover:bg-gray-100 text-gray-700 text-sm transition-colors">
                            <i class="fas fa-wallet mr-3 text-teal-400"></i> 7. Planejamento Financeiro Pessoal
                        </a>
                        <a href="#cap8" class="block px-4 py-2 rounded-lg hover:bg-gray-100 text-gray-700 text-sm transition-colors">
                            <i class="fas fa-globe-americas mr-3 text-pink-400"></i> 8. Investimentos no Exterior
                        </a>
                        <a href="#cap9" class="block px-4 py-2 rounded-lg hover:bg-gray-100 text-gray-700 text-sm transition-colors">
                            <i class="fas fa-gamepad mr-3 text-orange-400"></i> 9. Questionários e Jogos de Investimento
                        </a>
                        <a href="#cap10" class="block px-4 py-2 rounded-lg hover:bg-gray-100 text-gray-700 text-sm transition-colors">
                            <i class="fas fa-flag-checkered mr-3 text-green-500"></i> 10. Conclusão e Próximos Passos
                        </a>
                    </div>
                </div>
            </nav>
            
            <div class="mt-6 pt-4 border-t border-gray-200">
                <h3 class="px-4 text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Recursos</h3>
                <div class="space-y-1">
                    <a href="recursos.html#planejador" class="w-full flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-lg transition-colors">
                        <i class="fas fa-bullseye mr-3 text-blue-500"></i> Planejador de Metas
                    </a>
                    <a href="recursos.html#controle" class="w-full flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-lg transition-colors">
                        <i class="fas fa-file-excel mr-3 text-green-500"></i> Controle de Aportes
                    </a>
                    <button onclick="showResource('glossario')" class="w-full text-left flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-lg transition-colors">
                        <i class="fas fa-book mr-3 text-yellow-400"></i> Glossário Financeiro
                    </button>
                    <button onclick="showResource('checklist')" class="w-full text-left flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-lg transition-colors">
                        <i class="fas fa-tasks mr-3 text-purple-400"></i> Checklist do Investidor
                    </button>
                </div>
            </div>

            <div class="mt-6 pt-4 border-t border-gray-200">
                <h3 class="px-4 text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Guias em PDF</h3>
                <div class="px-2 pb-2 space-y-2 text-sm">
                    <a href="pdf/ebook_investimento_final.pdf" target="_blank" rel="noopener" class="flex items-center justify-between px-3 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow hover:shadow-md">
                        Guia Completo
                        <i class="fas fa-file-pdf text-white/90"></i>
                    </a>
                    <a href="pdf/introducao_investimentos.pdf" target="_blank" rel="noopener" class="flex items-center justify-between px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                        Cap. 1 — Introdução
                        <i class="fas fa-file-pdf text-red-500"></i>
                    </a>
                    <a href="pdf/investimentos_renda_fixa.pdf" target="_blank" rel="noopener" class="flex items-center justify-between px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                        Cap. 2 — Renda Fixa
                        <i class="fas fa-file-pdf text-red-500"></i>
                    </a>
                    <a href="pdf/investimentos_renda_variavel.pdf" target="_blank" rel="noopener" class="flex items-center justify-between px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                        Cap. 3 — Renda Variável
                        <i class="fas fa-file-pdf text-red-500"></i>
                    </a>
                    <a href="pdf/fundos_investimento.pdf" target="_blank" rel="noopener" class="flex items-center justify-between px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                        Cap. 4 — Fundos de Investimento
                        <i class="fas fa-file-pdf text-red-500"></i>
                    </a>
                    <a href="pdf/etfs.pdf" target="_blank" rel="noopener" class="flex items-center justify-between px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                        Cap. 6 — ETFs
                        <i class="fas fa-file-pdf text-red-500"></i>
                    </a>
                    <a href="pdf/planejamento_financeiro_completo.pdf" target="_blank" rel="noopener" class="flex items-center justify-between px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                        Cap. 7 — Planejamento Financeiro
                        <i class="fas fa-file-pdf text-red-500"></i>
                    </a>
                    <a href="pdf/investimentos_exterior.pdf" target="_blank" rel="noopener" class="flex items-center justify-between px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                        Cap. 8 — Exterior
                        <i class="fas fa-file-pdf text-red-500"></i>
                    </a>
                    <a href="pdf/taxas_tributacao.pdf" target="_blank" rel="noopener" class="flex items-center justify-between px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                        Taxas e Tributação
                        <i class="fas fa-file-pdf text-red-500"></i>
                    </a>
                    <a href="pdf/analise_fundamentalista.pdf" target="_blank" rel="noopener" class="flex items-center justify-between px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                        Análise Fundamentalista
                        <i class="fas fa-file-pdf text-red-500"></i>
                    </a>
                    <a href="pdf/criptomoedas.pdf" target="_blank" rel="noopener" class="flex items-center justify-between px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                        Criptomoedas
                        <i class="fas fa-file-pdf text-red-500"></i>
                    </a>
                </div>
            </div>
            
            <div class="mt-6 pt-4 border-t border-gray-200">
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-lg border border-blue-100">
                    <h3 class="text-sm font-medium text-blue-800 mb-2">📩 Receba atualizações</h3>
                    <p class="text-xs text-blue-700 mb-3">Cadastre-se para receber conteúdos exclusivos e dicas de investimento diretamente no seu e-mail.</p>
                    <div class="space-y-2">
                        <input type="email" placeholder="Seu melhor e-mail" class="w-full px-3 py-2 text-sm border border-blue-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent" required>
                        <button class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white text-sm font-medium py-2 px-4 rounded-lg transition-all transform hover:scale-[1.02]">
                            Quero me cadastrar
                        </button>
                    </div>
                    <p class="mt-2 text-xs text-blue-600">Respeitamos sua privacidade. Você está seguro!</p>
                </div>
            </div>
            
            <div class="mt-6 pt-4 border-t border-gray-200 text-center">
                <p class="text-xs text-gray-500">© 2023 Guia de Investimentos<br>Todos os direitos reservados</p>
                <div class="flex justify-center space-x-4 mt-3">
                    <a href="#" class="text-gray-400 hover:text-blue-500"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="text-gray-400 hover:text-blue-700"><i class="fab fa-facebook"></i></a>
                    <a href="#" class="text-gray-400 hover:text-blue-400"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="text-gray-400 hover:text-red-600"><i class="fab fa-youtube"></i></a>
                </div>
            </div>

            <!-- Blocos Didáticos -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <h3 class="font-semibold text-blue-800 mb-2">Exemplo prático</h3>
                    <p class="text-sm text-blue-900/90">Compare P/L, ROE e Dívida Líquida/EBITDA da Empresa X com pares do mesmo setor. Prefira vantagens consistentes em múltiplos indicadores.</p>
                </div>
                <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
                    <h3 class="font-semibold text-amber-800 mb-2">Erros comuns</h3>
                    <ul class="list-disc list-inside text-amber-900/90 text-sm space-y-1">
                        <li>Olhar apenas um indicador isolado.</li>
                        <li>Ignorar qualidade de gestão e alocação de capital.</li>
                        <li>Desconsiderar ciclo setorial.</li>
                    </ul>
                </div>
                <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4">
                    <h3 class="font-semibold text-indigo-800 mb-2">Checklist</h3>
                    <ul class="list-disc list-inside text-indigo-900/90 text-sm space-y-1">
                        <li>Crescimento de receita/lucro consistente?</li>
                        <li>Endividamento saudável?</li>
                        <li>Vantagens competitivas claras?</li>
                    </ul>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mt-4">
                <div class="bg-emerald-50 border border-emerald-200 rounded-lg p-4">
                    <h3 class="font-semibold text-emerald-800 mb-2">Dicas</h3>
                    <ul class="list-disc list-inside text-emerald-900/90 text-sm space-y-1">
                        <li>Combine análise fundamentalista e acompanhamento de resultados trimestrais.</li>
                        <li>Reavalie a tese quando fatos mudarem (não por ruído de curto prazo).</li>
                    </ul>
                </div>
                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                    <h3 class="font-semibold text-gray-800 mb-2">Mini-FAQ</h3>
                    <ul class="text-sm text-gray-700 space-y-1">
                        <li><b>Qual P/L ideal?</b> Depende do setor e das perspectivas; compare com pares.</li>
                        <li><b>ROE alto sempre é bom?</b> Em geral sim, mas verifique endividamento e sustentabilidade.</li>
                    </ul>
                </div>

                <div id="flashcards-content" class="hidden">
                    <div class="p-4 sm:p-6 border rounded-lg bg-white">
                        <div class="flex flex-col gap-4">
                            <!-- Controles -->
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                <div>
                                    <label for="fc-deck" class="block text-sm font-medium text-gray-700 mb-1">Selecione o deck</label>
                                    <select id="fc-deck" class="w-full border border-gray-300 rounded-md py-2 px-3 text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"></select>
                                </div>
                                <div class="flex items-end gap-2">
                                    <button id="fc-shuffle" class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white text-sm font-medium py-2 px-3 rounded-md transition-colors"><i class="fas fa-random mr-1"></i> Embaralhar</button>
                                    <button id="fc-reset" class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 text-sm font-medium py-2 px-3 rounded-md transition-colors"><i class="fas fa-undo mr-1"></i> Reset</button>
                                </div>
                                <div class="flex items-end justify-between">
                                    <label class="inline-flex items-center text-sm text-gray-700">
                                        <input id="fc-only-unknown" type="checkbox" class="mr-2">
                                        Somente não dominados
                                    </label>
                                    <span id="fc-counter" class="text-xs text-gray-500">0/0</span>
                                </div>
                            </div>

                            <!-- Progresso -->
                            <div>
                                <div class="flex justify-between text-xs text-gray-600 mb-1">
                                    <span>Progresso</span>
                                    <span id="fc-progress-text">0%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2.5">
                                    <div id="fc-progress" class="bg-green-500 h-2.5 rounded-full" style="width: 0%"></div>
                                </div>
                            </div>

                            <!-- Card -->
                            <div class="flex flex-col items-center">
                                <div id="fc-card" class="w-full md:w-2/3 lg:w-1/2 bg-gray-50 border rounded-lg p-6 cursor-pointer select-none transition-transform" title="Clique para virar">
                                    <div id="fc-face-front" class="">
                                        <div class="text-xs uppercase tracking-wide text-gray-500 mb-2">Frente</div>
                                        <div id="fc-front-text" class="text-lg font-semibold text-gray-900">—</div>
                                    </div>
                                    <div id="fc-face-back" class="hidden">
                                        <div class="text-xs uppercase tracking-wide text-gray-500 mb-2">Verso</div>
                                        <div id="fc-back-text" class="text-gray-800">—</div>
                                    </div>
                                </div>
                                <div class="mt-3 text-xs text-gray-500">Dica: clique no cartão para alternar frente/verso.</div>
                            </div>

                            <!-- Ações -->
                            <div class="flex flex-wrap gap-2 justify-center">
                                <button id="fc-prev" class="px-4 py-2 rounded-md border text-sm hover:bg-gray-50"><i class="fas fa-chevron-left mr-1"></i> Anterior</button>
                                <button id="fc-toggle-known" class="px-4 py-2 rounded-md bg-emerald-600 hover:bg-emerald-700 text-white text-sm"><i class="fas fa-check mr-1"></i> Marcar como dominado</button>
                                <button id="fc-next" class="px-4 py-2 rounded-md border text-sm hover:bg-gray-50">Próximo <i class="fas fa-chevron-right ml-1"></i></button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Blocos Didáticos 4.1 -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mt-6">
                    <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
                        <h3 class="font-semibold text-amber-800 mb-2">Erros comuns</h3>
                        <ul class="list-disc list-inside text-amber-900/90 text-sm space-y-1">
                            <li>Escolher fundo apenas pela rentabilidade passada.</li>
                            <li>Ignorar taxas (administração/performance) e benchmark.</li>
                            <li>Não entender a estratégia e o risco do fundo.</li>
                        </ul>
                    </div>
                    <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4">
                        <h3 class="font-semibold text-indigo-800 mb-2">Checklist rápido</h3>
                        <ul class="list-disc list-inside text-indigo-900/90 text-sm space-y-1">
                            <li>Gestor com histórico consistente?</li>
                            <li>Taxas compatíveis com a categoria?</li>
                            <li>Estratégia que você entende e aceita?</li>
                        </ul>
                    </div>
                    <div class="bg-emerald-50 border border-emerald-200 rounded-lg p-4">
                        <h3 class="font-semibold text-emerald-800 mb-2">Dica prática</h3>
                        <p class="text-sm text-emerald-900/90">Prefira fundos com boa relação risco-retorno e políticas claras. Diversifique entre categorias para reduzir volatilidade.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Overlay do Menu -->
    <div id="overlay" class="fixed inset-0 bg-black bg-opacity-50 z-10 hidden"></div>

    <!-- Cabeçalho -->
    <header id="topo" class="bg-white dark:bg-gray-800 shadow-sm sticky top-0 z-10">
        <div class="w-full mx-auto px-4 sm:px-6 lg:px-10 xl:px-16 2xl:px-24">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <button id="menuBtn" class="mr-4 text-gray-500 hover:text-gray-700 focus:outline-none">
                        <i class="fas fa-bars text-2xl"></i>
                    </button>
                    <h1 class="text-xl font-bold text-gray-900">Guia de Investimentos</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="hidden sm:flex items-center text-xs px-2 py-1 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200" title="Progresso nos capítulos">
                        <i class="fas fa-circle mr-1 text-[8px] text-emerald-500"></i>
                        <span id="chaptersIndicator">0/10</span>
                    </div>
                    <a id="printBtn" href="pdf/ebook_investimento_final.pdf" target="_blank" rel="noopener" class="hidden sm:inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 shadow-sm hover:shadow" title="Baixar guia completo em PDF">
                        <i class="fas fa-file-pdf mr-2"></i> Guia Completo (PDF)
                    </a>
                    <details class="relative hidden sm:block">
                        <summary class="list-none inline-flex items-center px-3 py-2 text-sm rounded-md border border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer select-none">
                            <i class="fas fa-folder-open mr-2 text-blue-500"></i>
                            PDFs por capítulo
                            <i class="fas fa-chevron-down ml-2 text-xs"></i>
                        </summary>
                        <div class="absolute right-0 mt-2 w-72 max-w-[90vw] bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-xl p-2 z-20">
                            <ul class="text-sm divide-y divide-gray-100 dark:divide-gray-700">
                                <li>
                                    <a class="flex items-center justify-between px-3 py-2 rounded hover:bg-gray-50 dark:hover:bg-gray-700" href="pdf/introducao_investimentos.pdf" target="_blank" rel="noopener">
                                        <span><b>Cap. 1</b> Introdução aos Investimentos</span>
                                        <i class="fas fa-file-pdf text-red-500"></i>
                                    </a>
                                </li>
                                <li>
                                    <a class="flex items-center justify-between px-3 py-2 rounded hover:bg-gray-50 dark:hover:bg-gray-700" href="pdf/investimentos_renda_fixa.pdf" target="_blank" rel="noopener">
                                        <span><b>Cap. 2</b> Renda Fixa</span>
                                        <i class="fas fa-file-pdf text-red-500"></i>
                                    </a>
                                </li>
                                <li>
                                    <a class="flex items-center justify-between px-3 py-2 rounded hover:bg-gray-50 dark:hover:bg-gray-700" href="pdf/investimentos_renda_variavel.pdf" target="_blank" rel="noopener">
                                        <span><b>Cap. 3</b> Renda Variável</span>
                                        <i class="fas fa-file-pdf text-red-500"></i>
                                    </a>
                                </li>
                                <li>
                                    <a class="flex items-center justify-between px-3 py-2 rounded hover:bg-gray-50 dark:hover:bg-gray-700" href="pdf/fundos_investimento.pdf" target="_blank" rel="noopener">
                                        <span><b>Cap. 4</b> Fundos de Investimento</span>
                                        <i class="fas fa-file-pdf text-red-500"></i>
                                    </a>
                                </li>
                                <li>
                                    <a class="flex items-center justify-between px-3 py-2 rounded hover:bg-gray-50 dark:hover:bg-gray-700" href="pdf/etfs.pdf" target="_blank" rel="noopener">
                                        <span><b>Cap. 6</b> ETFs</span>
                                        <i class="fas fa-file-pdf text-red-500"></i>
                                    </a>
                                </li>
                                <li>
                                    <a class="flex items-center justify-between px-3 py-2 rounded hover:bg-gray-50 dark:hover:bg-gray-700" href="pdf/planejamento_financeiro_completo.pdf" target="_blank" rel="noopener">
                                        <span><b>Cap. 7</b> Planejamento Financeiro</span>
                                        <i class="fas fa-file-pdf text-red-500"></i>
                                    </a>
                                </li>
                                <li>
                                    <a class="flex items-center justify-between px-3 py-2 rounded hover:bg-gray-50 dark:hover:bg-gray-700" href="pdf/investimentos_exterior.pdf" target="_blank" rel="noopener">
                                        <span><b>Cap. 8</b> Investimentos no Exterior</span>
                                        <i class="fas fa-file-pdf text-red-500"></i>
                                    </a>
                                </li>
                                <li>
                                    <a class="flex items-center justify-between px-3 py-2 rounded hover:bg-gray-50 dark:hover:bg-gray-700" href="pdf/taxas_tributacao.pdf" target="_blank" rel="noopener">
                                        <span>Taxas e Tributação</span>
                                        <i class="fas fa-file-pdf text-red-500"></i>
                                    </a>
                                </li>
                                <li>
                                    <a class="flex items-center justify-between px-3 py-2 rounded hover:bg-gray-50 dark:hover:bg-gray-700" href="pdf/analise_fundamentalista.pdf" target="_blank" rel="noopener">
                                        <span>Análise Fundamentalista</span>
                                        <i class="fas fa-file-pdf text-red-500"></i>
                                    </a>
                                </li>
                                <li>
                                    <a class="flex items-center justify-between px-3 py-2 rounded hover:bg-gray-50 dark:hover:bg-gray-700" href="pdf/criptomoedas.pdf" target="_blank" rel="noopener">
                                        <span>Criptomoedas</span>
                                        <i class="fas fa-file-pdf text-red-500"></i>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </details>
                    <button class="p-2 rounded-full text-gray-500 hover:text-gray-700 focus:outline-none">
                        <i class="fas fa-search text-xl"></i>
                    </button>
                    <button id="themeToggle" class="p-2 rounded-full text-gray-500 hover:text-gray-700 dark:text-gray-300 dark:hover:text-white focus:outline-none" aria-label="Alternar tema">
                        <i class="fas fa-moon text-xl" id="themeIcon"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Capa -->
    <div class="page bg-gradient-to-br from-primary-900 to-primary-700 text-white flex flex-col items-center justify-center p-8 text-center">
        <div class="mb-12">
            <div class="text-accent-400 text-2xl font-bold tracking-widest mb-4">INVISTA COMO UM ESPECIALISTA</div>
            <h1 class="text-5xl md:text-6xl font-serif font-bold mb-6">Domine os Investimentos</h1>
            <p class="text-xl md:text-2xl mx-auto opacity-90 leading-relaxed">Guia Completo para Construir Riqueza e Alcançar a Liberdade Financeira</p>
            <div class="mt-16 text-lg">
                <p class="mb-2">Por: <span class="font-semibold">Warren Buffett</span></p>
                <p>Edição: Agosto 2023</p>
            </div>
        </div>
    </div>

    <!-- Página de Rosto -->
    <div class="page flex items-center justify-center p-12">
        <div class="text-center">
            <h1 class="text-4xl md:text-5xl font-serif font-bold text-primary-800 mb-6">Domine os Investimentos</h1>
            <p class="text-xl text-gray-600 mb-12">Estratégias Comprovadas para Construir e Multiplicar seu Patrimônio</p>
            
            <div class="border-l-4 border-accent-400 pl-6 py-4 mb-12 text-left max-w-md mx-auto">
                <p class="italic text-gray-700">"O investimento em conhecimento paga os melhores juros."</p>
                <p class="font-semibold text-right mt-2">— Benjamin Franklin</p>
            </div>
            
            <div class="mt-16">
                <p class="text-lg">Por: <span class="font-semibold">Warren Buffett</span></p>
                <p class="text-gray-600">Especialista em Investimentos e Mercado Financeiro</p>
                
                <div class="mt-16 pt-6 border-t border-gray-200">
                    <p class="text-sm text-gray-500">© 2023 Invista Como um Especialista</p>
                    <p class="text-sm text-gray-500">Todos os direitos reservados</p>
                </div>
            </div>

    <!-- Minibiografia Interativa: Warren Buffett -->
    <section id="bio" class="page p-12 mt-10">
      <div class="max-w-5xl mx-auto">
        <h2 class="text-3xl md:text-4xl font-serif font-bold text-primary-800 text-center">Warren Buffett</h2>
        <p class="text-center text-gray-600 mt-2">“Oráculo de Omaha” • Investidor de valor • CEO da Berkshire Hathaway</p>

        <div class="mt-8 grid md:grid-cols-2 gap-6">
          <!-- Card de fatos com contadores -->
          <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow bio-reveal">
            <h3 class="text-xl font-semibold text-gray-900 dark:text-gray-100">Fatos Rápidos</h3>
            <ul class="mt-4 space-y-3 text-gray-700 dark:text-gray-200">
              <li class="flex items-center justify-between">
                <span>Nascimento</span>
                <span class="font-semibold">1930 • Omaha, EUA</span>
              </li>
              <li class="flex items-center justify-between">
                <span>Discípulo de</span>
                <span class="font-semibold">Benjamin Graham</span>
              </li>
              <li class="flex items-center justify-between">
                <span>CEO da Berkshire desde</span>
                <span class="font-semibold"><span class="count" data-target="1965">0</span></span>
              </li>
              <li class="flex items-center justify-between">
                <span>Cartas anuais publicadas</span>
                <span class="font-semibold"><span class="count" data-target="50">0</span>+</span>
              </li>
            </ul>
            <div class="mt-5 text-sm text-gray-600 dark:text-gray-300">
              Filosofia: comprar empresas excelentes a preços justos, margem de segurança, foco no longo prazo e disciplina.
            </div>
          </div>

          <!-- Linha do tempo animada -->
          <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow bio-reveal">
            <h3 class="text-xl font-semibold text-gray-900 dark:text-gray-100">Linha do Tempo</h3>
            <ol class="relative mt-4 space-y-6">
              <li class="pl-6">
                <span class="absolute left-0 top-1.5 w-3 h-3 rounded-full bg-primary-600"></span>
                <div class="text-sm text-gray-600">1956</div>
                <div class="font-medium">Inicia a Buffett Partnership</div>
              </li>
              <li class="pl-6">
                <span class="absolute left-0 top-1.5 w-3 h-3 rounded-full bg-primary-600"></span>
                <div class="text-sm text-gray-600">1965</div>
                <div class="font-medium">Assume a Berkshire Hathaway</div>
              </li>
              <li class="pl-6">
                <span class="absolute left-0 top-1.5 w-3 h-3 rounded-full bg-primary-600"></span>
                <div class="text-sm text-gray-600">1988–</div>
                <div class="font-medium">Investimentos icônicos (Coca‑Cola, entre outros)</div>
              </li>
              <li class="pl-6">
                <span class="absolute left-0 top-1.5 w-3 h-3 rounded-full bg-primary-600"></span>
                <div class="text-sm text-gray-600">2006</div>
                <div class="font-medium">Compromisso filantrópico (The Giving Pledge)</div>
              </li>
            </ol>
          </div>
        </div>

        <!-- Acordeão interativo de princípios -->
        <div class="mt-8 grid md:grid-cols-3 gap-6">
          <details class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5 shadow bio-reveal" open>
            <summary class="cursor-pointer font-semibold text-gray-900 dark:text-gray-100 flex items-center justify-between">Princípios de Investimento <span class="text-gray-400">⯆</span></summary>
            <ul class="mt-3 list-disc list-inside text-gray-700 dark:text-gray-200 text-sm space-y-1">
              <li>Vantagem competitiva durável (moat)</li>
              <li>Gestão confiável e alinhada</li>
              <li>Margem de segurança</li>
              <li>Visão de longo prazo</li>
            </ul>
          </details>
          <details class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5 shadow bio-reveal">
            <summary class="cursor-pointer font-semibold text-gray-900 dark:text-gray-100 flex items-center justify-between">Leituras essenciais <span class="text-gray-400">⯆</span></summary>
            <ul class="mt-3 list-disc list-inside text-gray-700 dark:text-gray-200 text-sm space-y-1">
              <li>O Investidor Inteligente (Benjamin Graham)</li>
              <li>Security Analysis (Graham & Dodd)</li>
              <li>Cartas da Berkshire Hathaway</li>
            </ul>
          </details>
          <details class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5 shadow bio-reveal">
            <summary class="cursor-pointer font-semibold text-gray-900 dark:text-gray-100 flex items-center justify-between">Curiosidades <span class="text-gray-400">⯆</span></summary>
            <ul class="mt-3 list-disc list-inside text-gray-700 dark:text-gray-200 text-sm space-y-1">
              <li>Conhecido como “Oráculo de Omaha”.</li>
              <li>Fanático por leitura diária.</li>
              <li>Grande filantropo ao lado de Bill & Melinda Gates.</li>
            </ul>
          </details>
        </div>
      </div>

      <script>
        // Animação simples de entrada
        (function(){
          const els = document.querySelectorAll('.bio-reveal');
          els.forEach(el=>{ el.style.opacity = 0; el.style.transform = 'translateY(8px)'; });
          const io = new IntersectionObserver((entries)=>{
            entries.forEach(entry=>{
              if(entry.isIntersecting){
                entry.target.style.transition = 'all .4s ease';
                entry.target.style.opacity = 1;
                entry.target.style.transform = 'translateY(0)';
                io.unobserve(entry.target);
              }
            });
          }, { threshold: .15 });
          els.forEach(el=> io.observe(el));
        })();

        // Contadores quando visíveis
        (function(){
          const counters = document.querySelectorAll('#bio .count');
          if(!counters.length) return;
          const animate = (el)=>{
            const target = parseInt(el.getAttribute('data-target'),10)||0;
            const start = 0; const dur = 900; const t0 = performance.now();
            const step = (now)=>{
              const p = Math.min(1, (now - t0)/dur);
              const val = Math.floor(start + (target - start) * p);
              el.textContent = val;
              if(p<1) requestAnimationFrame(step);
            };
            requestAnimationFrame(step);
          };
          const io = new IntersectionObserver((entries)=>{
            entries.forEach(e=>{
              if(e.isIntersecting){ animate(e.target); io.unobserve(e.target); }
            });
          }, { threshold: .6 });
          counters.forEach(c=> io.observe(c));
        })();
      </script>
    </section>

    <!-- Invista como Warren Buffett -->
    <section id="invista-como-buffett" class="page p-12">
      <div class="max-w-6xl mx-auto">
        <div class="relative overflow-hidden rounded-2xl border border-gray-200 dark:border-gray-700 bg-white/90 dark:bg-gray-800/80 shadow">
          <div class="absolute inset-0 bg-gradient-to-br from-emerald-50 via-transparent to-primary-50 dark:from-emerald-900/10 dark:to-primary-900/10"></div>
          <div class="relative p-8 md:p-10">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-6">
              <div>
                <h2 class="text-3xl md:text-4xl font-serif font-bold text-primary-800 dark:text-gray-100">Invista como Warren Buffett</h2>
                <p class="mt-2 text-gray-700 dark:text-gray-300 max-w-2xl">Princípios práticos do Value Investing: comprar empresas excelentes a preços justos, com margem de segurança e visão de longo prazo.</p>
              </div>
              <a href="#sumario" class="inline-flex items-center gap-2 px-5 py-3 rounded-lg bg-emerald-600 hover:bg-emerald-500 text-white font-medium shadow-md hover:shadow transition">
                <i class="fas fa-check-circle"></i>
                <span>Aplicar no meu estudo</span>
              </a>
            </div>
          </div>
        </div>

        <!-- Abas de Conteúdo -->
        <div class="mt-8">
          <div class="flex flex-wrap gap-2" role="tablist" aria-label="Princípios de Buffett">
            <button id="tab-estrategia-btn" class="buffett-tab active px-4 py-2 rounded-lg text-sm font-medium bg-primary-600 text-white shadow hover:shadow-md transition" data-tab="estrategia" role="tab" aria-selected="true" aria-controls="tab-estrategia" tabindex="0"><i class="fas fa-compass mr-2"></i>Estratégia</button>
            <button id="tab-moat-btn" class="buffett-tab px-4 py-2 rounded-lg text-sm font-medium bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 transition" data-tab="moat" role="tab" aria-selected="false" aria-controls="tab-moat" tabindex="-1"><i class="fas fa-shield-alt mr-2"></i>Moat</button>
            <button id="tab-valuation-btn" class="buffett-tab px-4 py-2 rounded-lg text-sm font-medium bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 transition" data-tab="valuation" role="tab" aria-selected="false" aria-controls="tab-valuation" tabindex="-1"><i class="fas fa-calculator mr-2"></i>Valuation</button>
            <button id="tab-disciplina-btn" class="buffett-tab px-4 py-2 rounded-lg text-sm font-medium bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 transition" data-tab="disciplina" role="tab" aria-selected="false" aria-controls="tab-disciplina" tabindex="-1"><i class="fas fa-stopwatch mr-2"></i>Disciplina</button>
          </div>

          <div class="mt-6">
            <!-- Estratégia -->
            <div class="buffett-panel" id="tab-estrategia" role="tabpanel" aria-labelledby="tab-estrategia-btn" tabindex="0">
              <div class="grid md:grid-cols-3 gap-6">
                <div class="group bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow hover:shadow-lg transition">
                  <div class="flex items-center gap-3">
                    <span class="h-10 w-10 rounded-full bg-emerald-100 text-emerald-700 flex items-center justify-center"><i class="fas fa-landmark"></i></span>
                    <h3 class="font-semibold text-gray-900 dark:text-gray-100">Empresas excelentes</h3>
                  </div>
                  <p class="mt-3 text-sm text-gray-600 dark:text-gray-300">Modelos de negócio simples, previsíveis e com geração de caixa consistente.</p>
                </div>
                <div class="group bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow hover:shadow-lg transition">
                  <div class="flex items-center gap-3">
                    <span class="h-10 w-10 rounded-full bg-emerald-100 text-emerald-700 flex items-center justify-center"><i class="fas fa-balance-scale"></i></span>
                    <h3 class="font-semibold text-gray-900 dark:text-gray-100">Preço justo</h3>
                  </div>
                  <p class="mt-3 text-sm text-gray-600 dark:text-gray-300">Pagar abaixo do valor intrínseco estimado, buscando relação risco-retorno favorável.</p>
                </div>
                <div class="group bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow hover:shadow-lg transition">
                  <div class="flex items-center gap-3">
                    <span class="h-10 w-10 rounded-full bg-emerald-100 text-emerald-700 flex items-center justify-center"><i class="fas fa-hourglass-half"></i></span>
                    <h3 class="font-semibold text-gray-900 dark:text-gray-100">Longo prazo</h3>
                  </div>
                  <p class="mt-3 text-sm text-gray-600 dark:text-gray-300">Beneficiar-se do compounding, focando em décadas, não em dias.</p>
                </div>
              </div>
            </div>

            <!-- Moat -->
            <div class="buffett-panel hidden" id="tab-moat" role="tabpanel" aria-labelledby="tab-moat-btn" tabindex="0">
              <div class="grid md:grid-cols-2 gap-6">
                <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow">
                  <h3 class="font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2"><i class="fas fa-fort-awesome"></i> Tipos de Moat</h3>
                  <ul class="mt-3 list-disc list-inside text-sm text-gray-700 dark:text-gray-300 space-y-1">
                    <li>Marca forte e lealdade do cliente</li>
                    <li>Vantagens de custo/escala</li>
                    <li>Efeitos de rede</li>
                    <li>Regulação/licenças e altos custos de troca</li>
                  </ul>
                </div>
                <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow">
                  <h3 class="font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2"><i class="fas fa-search-dollar"></i> Sinais práticos</h3>
                  <ul class="mt-3 list-disc list-inside text-sm text-gray-700 dark:text-gray-300 space-y-1">
                    <li>Margens altas e estáveis ao longo do tempo</li>
                    <li>Retorno sobre capital acima dos pares</li>
                    <li>Baixa necessidade de reinvestimento para manter a vantagem</li>
                    <li>Capacidade de repassar preços sem perder demanda</li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- Valuation -->
            <div class="buffett-panel hidden" id="tab-valuation" role="tabpanel" aria-labelledby="tab-valuation-btn" tabindex="0">
              <div class="grid lg:grid-cols-2 gap-6">
                <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow">
                  <h3 class="font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2"><i class="fas fa-sliders-h"></i> Mini‑ferramenta: Margem de Segurança</h3>
                  <div class="mt-4 space-y-4">
                    <label class="block text-sm text-gray-700 dark:text-gray-300">Valor intrínseco estimado (R$)</label>
                    <input id="vi" type="number" min="0" value="100.00" step="1" class="w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100"/>
                    <div>
                      <div class="flex items-center justify-between text-sm text-gray-700 dark:text-gray-300">
                        <span>Margem de segurança</span>
                        <span><span id="mosPct">30</span>%</span>
                      </div>
                      <input id="mos" type="range" min="0" max="60" value="30" class="w-full accent-emerald-600"/>
                    </div>
                    <div class="p-4 rounded-lg bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800">
                      <div class="text-sm text-emerald-800 dark:text-emerald-200">Preço alvo para compra (R$)</div>
                      <div class="text-2xl font-bold text-emerald-700 dark:text-emerald-300"><span id="precoAlvo">70.00</span></div>
                    </div>
                  </div>
                </div>
                <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow">
                  <h3 class="font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2"><i class="fas fa-clipboard-check"></i> Checklist de Buffett</h3>
                  <ul class="mt-3 text-sm text-gray-700 dark:text-gray-300 space-y-2">
                    <li class="flex items-start gap-3"><i class="fas fa-check text-emerald-600 mt-1"></i><span>Negócio compreensível e previsível</span></li>
                    <li class="flex items-start gap-3"><i class="fas fa-check text-emerald-600 mt-1"></i><span>Moat sustentável e gestão confiável</span></li>
                    <li class="flex items-start gap-3"><i class="fas fa-check text-emerald-600 mt-1"></i><span>Fluxo de caixa forte e ROIC elevado</span></li>
                    <li class="flex items-start gap-3"><i class="fas fa-check text-emerald-600 mt-1"></i><span>Preço abaixo do valor intrínseco (com margem)</span></li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- Disciplina -->
            <div class="buffett-panel hidden" id="tab-disciplina" role="tabpanel" aria-labelledby="tab-disciplina-btn" tabindex="0">
              <div class="grid md:grid-cols-2 gap-6">
                <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow">
                  <h3 class="font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2"><i class="fas fa-dna"></i> Comportamento</h3>
                  <p class="mt-2 text-sm text-gray-700 dark:text-gray-300">Paciência, independência de opinião, foco em fundamentos e evitar ruído do mercado.</p>
                </div>
                <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow">
                  <h3 class="font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2"><i class="fas fa-user-shield"></i> O que evitar</h3>
                  <ul class="mt-3 list-disc list-inside text-sm text-gray-700 dark:text-gray-300 space-y-1">
                    <li>Endividamento excessivo</li>
                    <li>Negócios cíclicos sem vantagem clara</li>
                    <li>Promessas sem geração de caixa</li>
                    <li>Overtrading e market timing</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Recursos recomendados -->
        <div class="mt-8 grid md:grid-cols-3 gap-6">
          <a class="group rounded-xl border border-gray-200 dark:border-gray-700 p-5 bg-white dark:bg-gray-800 shadow hover:shadow-lg transition" href="https://www.berkshirehathaway.com/letters/letters.html" target="_blank" rel="noopener">
            <div class="flex items-center gap-3 text-gray-900 dark:text-gray-100"><i class="fas fa-file-alt text-primary-600"></i><span>Cartas anuais da Berkshire</span></div>
            <p class="mt-2 text-sm text-gray-600 dark:text-gray-300">Leitura essencial para entender a mentalidade de longo prazo e alocação de capital.</p>
            <span class="mt-3 inline-flex items-center text-sm text-emerald-700 group-hover:translate-x-0.5 transition"><i class="fas fa-external-link-alt mr-2"></i>Abrir</span>
          </a>
          <a class="group rounded-xl border border-gray-200 dark:border-gray-700 p-5 bg-white dark:bg-gray-800 shadow hover:shadow-lg transition" href="https://www.sec.gov/edgar/searchedgar/companysearch.html" target="_blank" rel="noopener">
            <div class="flex items-center gap-3 text-gray-900 dark:text-gray-100"><i class="fas fa-database text-primary-600"></i><span>EDGAR (SEC) • 10-K/10-Q</span></div>
            <p class="mt-2 text-sm text-gray-600 dark:text-gray-300">Pesquise relatórios para analisar fundamentos e vantagem competitiva.</p>
            <span class="mt-3 inline-flex items-center text-sm text-emerald-700 group-hover:translate-x-0.5 transition"><i class="fas fa-external-link-alt mr-2"></i>Abrir</span>
          </a>
          <a class="group rounded-xl border border-gray-200 dark:border-gray-700 p-5 bg-white dark:bg-gray-800 shadow hover:shadow-lg transition" href="#" onclick="alert('Dica: use relatórios de administração e histórico de margens como ponto de partida.'); return false;">
            <div class="flex items-center gap-3 text-gray-900 dark:text-gray-100"><i class="fas fa-lightbulb text-primary-600"></i><span>Dicas de Análise</span></div>
            <p class="mt-2 text-sm text-gray-600 dark:text-gray-300">Compare margens, ROIC e geração de caixa por pelo menos 10 anos.</p>
            <span class="mt-3 inline-flex items-center text-sm text-emerald-700 group-hover:translate-x-0.5 transition"><i class="fas fa-mouse-pointer mr-2"></i>Ver dica</span>
          </a>
        </div>

      </div>

      <script>
        // Tabs logic
        (function(){
          const tabs = document.querySelectorAll('.buffett-tab');
          const panels = {
            estrategia: document.getElementById('tab-estrategia'),
            moat: document.getElementById('tab-moat'),
            valuation: document.getElementById('tab-valuation'),
            disciplina: document.getElementById('tab-disciplina')
          };
          function activate(key){
            tabs.forEach(t=>{
              const is = t.dataset.tab===key;
              t.classList.toggle('active', is);
              if(is){
                t.classList.remove('bg-white','dark:bg-gray-800','text-gray-700','dark:text-gray-200','border','border-gray-200','dark:border-gray-700');
                t.classList.add('bg-primary-600','text-white','shadow');
              } else {
                t.classList.add('bg-white','dark:bg-gray-800','text-gray-700','dark:text-gray-200','border','border-gray-200','dark:border-gray-700');
                t.classList.remove('bg-primary-600','text-white','shadow');
              }
            });
            Object.keys(panels).forEach(k=>{
              panels[k].classList.toggle('hidden', k!==key);
            });
          }
          tabs.forEach(t=> t.addEventListener('click', ()=> activate(t.dataset.tab)));
          activate('estrategia');
        })();

        // Mini MOS calculator
        (function(){
          const vi = document.getElementById('vi');
          const mos = document.getElementById('mos');
          const mosPct = document.getElementById('mosPct');
          const out = document.getElementById('precoAlvo');
          if(!(vi&&mos&&mosPct&&out)) return;
          function update(){
            const v = Math.max(0, parseFloat(vi.value)||0);
            const m = Math.max(0, Math.min(100, parseFloat(mos.value)||0));
            mosPct.textContent = m.toFixed(0);
            const preco = v * (1 - m/100);
            out.textContent = preco.toFixed(2);
          }
          vi.addEventListener('input', update);
          mos.addEventListener('input', update);
          update();
        })();
      </script>
    </section>

    <!-- Sumário -->
    <div id="sumario" class="page p-12">
        <div class="sumario-header mb-6">
            <h1 class="text-3xl font-serif font-bold text-primary-800 inline-flex items-center gap-3">
                <span>Sumário</span>
                <span class="hidden md:inline-block h-[2px] w-24 bg-accent-400"></span>
            </h1>
            <button id="sumarioToggle" class="toggle-btn text-sm text-gray-700 dark:text-gray-200 hover:bg-white/80 dark:hover:bg-gray-800/70">
                <i class="fas fa-eye-slash"></i>
                <span>Ocultar</span>
            </button>
        </div>
        <div class="sumario-grid mt-4">
            <details class="sumario-card" open>
                <summary class="sumario-title">
                    <span class="badge">1</span>
                    <span>Fundamentos dos Investimentos</span>
                    <i class="fas fa-chevron-down chev ml-auto"></i>
                </summary>
                <ul class="sumario-list mt-3 space-y-1">
                    <li><a class="sumario-item" href="#cap1-1"><span class="num-badge">1.1</span><span>Educação Financeira</span></a></li>
                    <li><a class="sumario-item" href="#cap1-2"><span class="num-badge">1.2</span><span>Juros Compostos</span></a></li>
                    <li><a class="sumario-item" href="#cap1-3"><span class="num-badge">1.3</span><span>Perfil do Investidor</span></a></li>
                    <li><a class="sumario-item" href="#cap1-4"><span class="num-badge">1.4</span><span>Metas Financeiras</span></a></li>
                </ul>
            </details>
            <details class="sumario-card" open>
                <summary class="sumario-title">
                    <span class="badge">2</span>
                    <span>Renda Fixa</span>
                    <i class="fas fa-chevron-down chev ml-auto"></i>
                </summary>
                <ul class="sumario-list mt-3 space-y-1">
                    <li><a class="sumario-item" href="#cap2-1"><span class="num-badge">2.1</span><span>Tesouro Direto</span></a></li>
                    <li><a class="sumario-item" href="#cap2-2"><span class="num-badge">2.2</span><span>CDB, LCI, LCA</span></a></li>
                    <li><a class="sumario-item" href="#cap2-3"><span class="num-badge">2.3</span><span>Debêntures</span></a></li>
                    <li><a class="sumario-item" href="#cap2-4"><span class="num-badge">2.4</span><span>CRI e CRA</span></a></li>
                </ul>
            </details>
            <details class="sumario-card" open>
                <summary class="sumario-title">
                    <span class="badge">3</span>
                    <span>Renda Variável</span>
                    <i class="fas fa-chevron-down chev ml-auto"></i>
                </summary>
                <ul class="sumario-list mt-3 space-y-1">
                    <li><a class="sumario-item" href="#cap3-1"><span class="num-badge">3.1</span><span>Ações</span></a></li>
                    <li><a class="sumario-item" href="#cap3-2"><span class="num-badge">3.2</span><span>Análise Fundamentalista</span></a></li>
                    <li><a class="sumario-item" href="#cap3-3"><span class="num-badge">3.3</span><span>Análise Técnica</span></a></li>
                    <li><a class="sumario-item" href="#cap3-4"><span class="num-badge">3.4</span><span>Setores e Empresas</span></a></li>
                </ul>
            </details>
            <details class="sumario-card" open>
                <summary class="sumario-title">
                    <span class="badge">4</span>
                    <span>Fundos de Investimento</span>
                    <i class="fas fa-chevron-down chev ml-auto"></i>
                </summary>
                <ul class="sumario-list mt-3 space-y-1">
                    <li><a class="sumario-item" href="#cap4-1"><span class="num-badge">4.1</span><span>Tipos de Fundos</span></a></li>
                    <li><a class="sumario-item" href="#cap4-2"><span class="num-badge">4.2</span><span>Taxas e Custos</span></a></li>
                    <li><a class="sumario-item" href="#cap4-3"><span class="num-badge">4.3</span><span>Como Escolher</span></a></li>
                    <li><a class="sumario-item" href="#cap4-4"><span class="num-badge">4.4</span><span>Estratégias</span></a></li>
                </ul>
            </details>
            <details class="sumario-card" open>
                <summary class="sumario-title">
                    <span class="badge">5</span>
                    <span>Fundos Imobiliários</span>
                    <i class="fas fa-chevron-down chev ml-auto"></i>
                </summary>
                <ul class="sumario-list mt-3 space-y-1">
                    <li><a class="sumario-item" href="#cap5-1"><span class="num-badge">5.1</span><span>Como Funcionam</span></a></li>
                    <li><a class="sumario-item" href="#cap5-2"><span class="num-badge">5.2</span><span>Tipos de FIIs</span></a></li>
                    <li><a class="sumario-item" href="#cap5-3"><span class="num-badge">5.3</span><span>Estratégias</span></a></li>
                    <li><a class="sumario-item" href="#cap5-4"><span class="num-badge">5.4</span><span>Análise</span></a></li>
                </ul>
            </details>
            <details class="sumario-card" open>
                <summary class="sumario-title">
                    <span class="badge">6</span>
                    <span>ETFs</span>
                    <i class="fas fa-chevron-down chev ml-auto"></i>
                </summary>
                <ul class="sumario-list mt-3 space-y-1">
                    <li><a class="sumario-item" href="#cap6-1"><span class="num-badge">6.1</span><span>O que são ETFs</span></a></li>
                    <li><a class="sumario-item" href="#cap6-2"><span class="num-badge">6.2</span><span>Vantagens</span></a></li>
                    <li><a class="sumario-item" href="#cap6-3"><span class="num-badge">6.3</span><span>Principais ETFs</span></a></li>
                    <li><a class="sumario-item" href="#cap6-4"><span class="num-badge">6.4</span><span>Estratégias</span></a></li>
                </ul>
            </details>
            <details class="sumario-card" open>
                <summary class="sumario-title">
                    <span class="badge">7</span>
                    <span>Planejamento Financeiro Pessoal</span>
                    <i class="fas fa-chevron-down chev ml-auto"></i>
                </summary>
                <ul class="sumario-list mt-3 space-y-1">
                    <li><a class="sumario-item" href="#cap7-1"><span class="num-badge">7.1</span><span>Orçamento e Controle Financeiro</span></a></li>
                    <li><a class="sumario-item" href="#cap7-2"><span class="num-badge">7.2</span><span>Metas Financeiras</span></a></li>
                    <li><a class="sumario-item" href="#cap7-3"><span class="num-badge">7.3</span><span>Estratégias para Quitar Dívidas</span></a></li>
                    <li><a class="sumario-item" href="#cap7-4"><span class="num-badge">7.4</span><span>Reserva de Emergência</span></a></li>
                </ul>
            </details>
            <details class="sumario-card" open>
                <summary class="sumario-title">
                    <span class="badge">8</span>
                    <span>Investimentos no Exterior</span>
                    <i class="fas fa-chevron-down chev ml-auto"></i>
                </summary>
                <ul class="sumario-list mt-3 space-y-1">
                    <li><a class="sumario-item" href="#cap8-1"><span class="num-badge">8.1</span><span>Por que Investir no Exterior?</span></a></li>
                    <li><a class="sumario-item" href="#cap8-2"><span class="num-badge">8.2</span><span>ETFs Globais e Ações Internacionais</span></a></li>
                    <li><a class="sumario-item" href="#cap8-3"><span class="num-badge">8.3</span><span>REITs Internacionais e Ouro</span></a></li>
                    <li><a class="sumario-item" href="#cap8-4"><span class="num-badge">8.4</span><span>Tributação e Estratégias</span></a></li>
                </ul>
            </details>
            <details class="sumario-card" open>
                <summary class="sumario-title">
                    <span class="badge">9</span>
                    <span>Previdência Privada</span>
                    <i class="fas fa-chevron-down chev ml-auto"></i>
                </summary>
                <ul class="sumario-list mt-3 space-y-1">
                    <li><a class="sumario-item" href="#cap9-1"><span class="num-badge">9.1</span><span>Tipos de Previdência</span></a></li>
                    <li><a class="sumario-item" href="#cap9-2"><span class="num-badge">9.2</span><span>Vantagens Fiscais</span></a></li>
                    <li><a class="sumario-item" href="#cap9-3"><span class="num-badge">9.3</span><span>Como Escolher um Plano</span></a></li>
                    <li><a class="sumario-item" href="#cap9-4"><span class="num-badge">9.4</span><span>Resgates e Tributação</span></a></li>
                </ul>
            </details>
        </div>
        <div class="mt-8 text-sm text-gray-500 text-center">
            <p>Explore os capítulos. Toque nos títulos para recolher/expandir.</p>
        </div>
    </div>

    

    <div id="cap1" class="page p-12">
        <div class="mb-8">
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                <div>
                    <span class="inline-block px-3 py-1 bg-primary-100 text-primary-800 text-sm font-medium rounded-full mb-2">Capítulo 1</span>
                    <h1 class="text-3xl font-serif font-bold text-primary-800 mb-2">Fundamentos dos Investimentos</h1>
                    <p class="text-lg text-gray-700 leading-relaxed">Antes de começar a investir, é essencial entender os conceitos básicos que norteiam o mundo dos investimentos.</p>
                </div>
                <div class="flex flex-col items-center">
                    <button onclick="openStudyModal('introducao-investimentos')" class="study-topic-btn flex items-center px-6 py-3 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg transition-colors shadow-md hover:shadow-lg" data-topic-id="introducao-investimentos">
                        <i class="fas fa-graduation-cap mr-2"></i>
                        <span>Estudar Tópico</span>
                    </button>
                    <div class="mt-2 text-sm text-gray-500 flex items-center">
                        <span class="mr-2">Progresso:</span>
                        <div class="w-16 h-2 bg-gray-200 rounded-full overflow-hidden">
                            <div class="h-full bg-green-500 progress-bar" style="width: 0%"></div>
                        </div>
                        <span class="ml-2 text-xs progress-text">0%</span>
                    </div>
                    <p class="text-xs text-gray-400 mt-1 last-studied hidden">Último estudo: -</p>
                </div>
            </div>
        </div>

        <!-- Seção 1.1 -->
         <div id="cap1-1" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">1.1</span>
                Educação Financeira
            </h2>
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <p class="mb-4">A educação financeira é o alicerce para qualquer investidor. Ela envolve entender como o dinheiro funciona, como administrar suas finanças pessoais e como tomar decisões financeiras conscientes.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-8 my-8">
                    <div class="bg-blue-50 p-5 md:p-8 rounded-xl shadow-sm md:shadow-lg">
                        <h3 class="font-semibold text-blue-800 mb-3 text-lg md:text-xl">Princípios Básicos</h3>
                        <ul class="list-disc list-inside text-blue-700 space-y-1.5 text-sm md:text-base">
                            <li>Ganhe mais do que gasta</li>
                            <li>Poupe regularmente</li>
                            <li>Evite dívidas desnecessárias</li>
                            <li>Estabeleça metas financeiras</li>
                        </ul>
                    </div>
                    <div class="bg-green-50 p-5 md:p-8 rounded-xl shadow-sm md:shadow-lg">
                        <h3 class="font-semibold text-green-800 mb-3 text-lg md:text-xl">Por que é Importante?</h3>
                        <ul class="list-disc list-inside text-green-700 space-y-1.5 text-sm md:text-base">
                            <li>Tomada de decisões mais conscientes</li>
                            <li>Maior controle sobre suas finanças</li>
                            <li>Preparação para imprevistos</li>
                            <li>Construção de riqueza a longo prazo</li>
                        </ul>
                    </div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6">
                    <div class="bg-amber-50 border border-amber-200 rounded-xl p-5">
                        <h3 class="font-semibold text-amber-800 mb-2">Erros comuns</h3>
                        <ul class="list-disc list-inside text-amber-800/90 space-y-1 text-sm">
                            <li>Não ter reserva de emergência (3 a 12 meses de gastos).</li>
                            <li>Confundir alto retorno com baixo risco.</li>
                            <li>Investir sem objetivo e prazo definidos.</li>
                            <li>Ignorar taxas, impostos e inflação.</li>
                        </ul>
                    </div>
                    <div class="bg-indigo-50 border border-indigo-200 rounded-xl p-5">
                        <h3 class="font-semibold text-indigo-800 mb-2">Checklist rápido</h3>
                        <ul class="list-disc list-inside text-indigo-900/90 space-y-1 text-sm">
                            <li>Mapeei receitas e gastos (fixos/variáveis).</li>
                            <li>Defini metas SMART (específicas, mensuráveis, prazos).</li>
                            <li>Montei reserva de emergência.</li>
                            <li>Escolhi investimentos compatíveis com meu perfil de risco.</li>
                        </ul>
                    </div>
                    <div class="bg-emerald-50 border border-emerald-200 rounded-xl p-5">
                        <h3 class="font-semibold text-emerald-800 mb-2">Exemplo prático: regra 50-30-20</h3>
                        <p class="text-emerald-900/90 text-sm">Renda líquida de R$ 3.000/mês:</p>
                        <ul class="text-emerald-900/90 text-sm mt-1 space-y-1">
                            <li><b>50%</b> necessidades: R$ 1.500</li>
                            <li><b>30%</b> desejos: R$ 900</li>
                            <li><b>20%</b> investimentos/dívidas: R$ 600</li>
                        </ul>
                        <p class="text-emerald-900/80 text-xs mt-2">Ajuste os percentuais conforme sua realidade (ex.: quem tem dívidas pode alocar 30% para quitá-las).</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Seção 1.2 -->
        <div id="cap1-2" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">1.2</span>
                Juros Compostos
            </h2>
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <p class="mb-4">Conhecido como o "juro sobre juros", os juros compostos são a mágica por trás do crescimento exponencial do dinheiro ao longo do tempo.</p>
                
                <div class="bg-yellow-50 p-4 rounded-lg my-6">
                    <h3 class="font-semibold text-yellow-800 mb-2">Fórmula dos Juros Compostos</h3>
                    <p class="text-yellow-700 mb-2">M = C × (1 + i)ⁿ</p>
                    <ul class="text-sm text-yellow-700 space-y-1">
                        <li>M = Montante final</li>
                        <li>C = Capital inicial</li>
                        <li>i = Taxa de juros (em decimal)</li>
                        <li>n = Período de tempo</li>
                    </ul>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
                    <div class="bg-blue-50 border border-blue-200 rounded-xl p-5">
                        <h3 class="font-semibold text-blue-800 mb-2">Exemplo trabalhado</h3>
                        <p class="text-blue-900/90 text-sm">C = R$ 1.000, i = 1% a.m. (0,01), n = 12 meses</p>
                        <p class="text-blue-900/90 text-sm mt-1">M = 1000 × (1 + 0,01)<sup>12</sup> ≈ 1000 × 1,1268 = <b>R$ 1.126,80</b></p>
                        <div class="table-wrap mt-3">
                            <table class="text-xs w-full">
                                <thead class="text-blue-800">
                                    <tr>
                                        <th class="text-left py-1 pr-2">Mês</th>
                                        <th class="text-left py-1 pr-2">Saldo</th>
                                    </tr>
                                </thead>
                                <tbody class="text-blue-900/90">
                                    <tr><td class="py-1 pr-2">1</td><td>R$ 1.010,00</td></tr>
                                    <tr><td class="py-1 pr-2">3</td><td>R$ 1.030,30</td></tr>
                                    <tr><td class="py-1 pr-2">6</td><td>R$ 1.061,52</td></tr>
                                    <tr><td class="py-1 pr-2">12</td><td>R$ 1.126,80</td></tr>
                                </tbody>
                            </table>
                        </div>
                        <p class="text-blue-900/80 text-xs mt-2">Valores arredondados. Em aportes mensais, utiliza-se série de pagamentos (anuidade).</p>
                    </div>
                    <div class="bg-emerald-50 border border-emerald-200 rounded-xl p-5">
                        <h3 class="font-semibold text-emerald-800 mb-2">Dicas para acelerar o efeito</h3>
                        <ul class="list-disc list-inside text-emerald-900/90 space-y-1 text-sm">
                            <li>Comece cedo: tempo é o maior aliado.</li>
                            <li>Reinvista os rendimentos (capitalização).</li>
                            <li>Registre e aumente aportes ao longo do tempo.</li>
                            <li>Minimize taxas e impostos quando possível.</li>
                        </ul>
                        <details class="mt-3">
                            <summary class="cursor-pointer text-emerald-800 font-medium">Juros reais x nominais</summary>
                            <p class="text-emerald-900/90 text-sm mt-2">Juro nominal é a taxa anunciada. Juro real desconta a inflação. Aproximação: (1 + juro real) ≈ (1 + juro nominal) / (1 + inflação) − 1.</p>
                        </details>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Capítulo 2 -->
    <div id="cap2" class="page p-12">
        <div class="mb-8">
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                <div>
                    <span class="inline-block px-3 py-1 bg-primary-100 text-primary-800 text-sm font-medium rounded-full mb-2">Capítulo 2</span>
                    <h1 class="text-3xl font-serif font-bold text-primary-800 mb-2">Renda Fixa</h1>
                    <p class="text-lg text-gray-700 leading-relaxed">Os investimentos em renda fixa são aqueles em que a rentabilidade pode ser conhecida no momento da aplicação ou ao longo do tempo.</p>
                </div>
                <div class="flex flex-col items-center">
                    <button onclick="openStudyModal('renda-fixa')" class="study-topic-btn flex items-center px-6 py-3 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg transition-colors shadow-md hover:shadow-lg" data-topic-id="renda-fixa">
                        <i class="fas fa-graduation-cap mr-2"></i>
                        <span>Estudar Tópico</span>
                    </button>
                    <div class="mt-2 text-sm text-gray-500 flex items-center">
                        <span class="mr-2">Progresso:</span>
                        <div class="w-16 h-2 bg-gray-200 rounded-full overflow-hidden">
                            <div class="h-full bg-green-500 progress-bar" style="width: 0%"></div>
                        </div>
                        <span class="ml-2 text-xs progress-text">0%</span>
                    </div>
                    <p class="text-xs text-gray-400 mt-1 last-studied hidden">Último estudo: -</p>
                </div>
            </div>
        </div>

        <!-- Seção 2.1 -->
        <div id="cap2-1" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">2.1</span>
                Tesouro Direto
            </h2>
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <p class="mb-4">O Tesouro Direto é um programa de venda de títulos públicos federais para pessoas físicas, criado pelo Tesouro Nacional e operacionalizado pelo Banco Central.</p>
                
                <div class="grid md:grid-cols-3 gap-6 my-8">
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h3 class="font-semibold text-blue-800 mb-2">Vantagens</h3>
                        <ul class="list-disc list-inside text-blue-700 space-y-1 text-sm">
                            <li>Segurança do Tesouro Nacional</li>
                            <li>Baixo valor mínimo (R$ 30,00)</li>
                            <li>Liquidez diária</li>
                            <li>Diversos prazos e rentabilidades</li>
                        </ul>
                    </div>
                    <div class="bg-green-50 p-4 rounded-lg">
                        <h3 class="font-semibold text-green-800 mb-2">Principais Títulos</h3>
                        <ul class="list-disc list-inside text-green-700 space-y-1 text-sm">
                            <li>Tesouro Selic</li>
                            <li>Tesouro IPCA+</li>
                            <li>Tesouro Prefixado</li>
                            <li>Tesouro IGPM+</li>
                        </ul>
                    </div>
                    <div class="bg-purple-50 p-4 rounded-lg">
                        <h3 class="font-semibold text-purple-800 mb-2">Como Investir</h3>
                        <ol class="list-decimal list-inside text-purple-700 space-y-1 text-sm">
                            <li>Abra conta em uma corretora</li>
                            <li>Transfira o dinheiro</li>
                            <li>Escolha o título</li>
                            <li>Aplique</li>
                        </ol>
                    </div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
                    <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
                        <h3 class="font-semibold text-amber-800 mb-2">Erros comuns</h3>
                        <ul class="list-disc list-inside text-amber-900/90 text-sm space-y-1">
                            <li>Usar Tesouro Prefixado para reserva de emergência.</li>
                            <li>Vender antes do vencimento sem avaliar marcação a mercado.</li>
                            <li>Ignorar taxas (custódia B3) e tributação regressiva.</li>
                        </ul>
                    </div>
                    <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4">
                        <h3 class="font-semibold text-indigo-800 mb-2">Checklist rápido</h3>
                        <ul class="list-disc list-inside text-indigo-900/90 text-sm space-y-1">
                            <li>Objetivo e prazo definidos.</li>
                            <li>Liquidez necessária (diária ou até o vencimento).</li>
                            <li>Compatibilidade com perfil de risco.</li>
                        </ul>
                    </div>
                    <div class="bg-emerald-50 border border-emerald-200 rounded-lg p-4">
                        <h3 class="font-semibold text-emerald-800 mb-2">Dica prática</h3>
                        <p class="text-sm text-emerald-900/90">Para reserva de emergência, prefira <b>Tesouro Selic</b> por ter liquidez diária e baixa volatilidade.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Seção 2.2 -->
        <div id="cap2-2" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">2.2</span>
                CDB, LCI e LCA
            </h2>
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <p class="mb-4">Títulos de renda fixa emitidos por bancos, com diferentes características e benefícios fiscais.</p>
                
                <div class="overflow-x-auto mt-6">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Título</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Emissor</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Garantia</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Isenção IR</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Liquidez</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">CDB</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Bancos</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">FGC (até R$ 250 mil)</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Não</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Varia conforme o título</td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">LCI</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Bancos</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">FGC (até R$ 250 mil)</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-green-600 font-medium">Sim</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Somente no vencimento</td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">LCA</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Bancos</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">FGC (até R$ 250 mil)</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-green-600 font-medium">Sim</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Somente no vencimento</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <h3 class="font-semibold text-blue-800 mb-2">Exemplo prático: CDB x LCI</h3>
                        <p class="text-sm text-blue-900/90">Aporte de R$ 10.000 por 12 meses.</p>
                        <ul class="text-sm text-blue-900/90 mt-2 space-y-1">
                            <li><b>CDB 110% CDI</b> (com IR regressivo): retorno líquido depende da alíquota.</li>
                            <li><b>LCI 95% CDI</b> (isenta de IR): pode superar CDB líquido em prazos curtos.</li>
                        </ul>
                        <p class="text-xs text-blue-900/70 mt-2">Resultado depende do CDI e da sua faixa de IR no prazo. Compare sempre o <b>líquido</b>.</p>
                    </div>
                    <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
                        <h3 class="font-semibold text-amber-800 mb-2">Erros comuns</h3>
                        <ul class="list-disc list-inside text-amber-900/90 text-sm space-y-1">
                            <li>Confundir cobertura do FGC com ausência de risco.</li>
                            <li>Desconsiderar carência e liquidez.</li>
                            <li>Comparar taxas sem considerar isenção de IR.</li>
                        </ul>
                    </div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mt-4">
                    <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4">
                        <h3 class="font-semibold text-indigo-800 mb-2">Checklist</h3>
                        <ul class="list-disc list-inside text-indigo-900/90 text-sm space-y-1">
                            <li>Emissor e rating de crédito.</li>
                            <li>Garantia FGC e limites por CPF/instituição.</li>
                            <li>Carência e possibilidade de resgate.</li>
                        </ul>
                    </div>
                    <div class="bg-emerald-50 border border-emerald-200 rounded-lg p-4">
                        <h3 class="font-semibold text-emerald-800 mb-2">Dicas</h3>
                        <ul class="list-disc list-inside text-emerald-900/90 text-sm space-y-1">
                            <li>Para prazos curtos, LCI/LCA pode ser melhor pelo IR zero.</li>
                            <li>Para prazos longos, CDBs competitivos podem compensar.</li>
                        </ul>
                    </div>
                    <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                        <h3 class="font-semibold text-gray-800 mb-2">Mini-FAQ</h3>
                        <ul class="text-sm text-gray-700 space-y-1">
                            <li><b>Posso perder dinheiro?</b> Risco de crédito existe; FGC cobre até limites.</li>
                            <li><b>Tem IOF?</b> Sim, até 30 dias (regressivo).</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Capítulo 3 -->
    <div id="cap3" class="page p-12">
        <div class="mb-8">
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                <div>
                    <span class="inline-block px-3 py-1 bg-primary-100 text-primary-800 text-sm font-medium rounded-full mb-2">Capítulo 3</span>
                    <h1 class="text-3xl font-serif font-bold text-primary-800 mb-2">Renda Variável</h1>
                    <p class="text-lg text-gray-700 leading-relaxed">A renda variável oferece oportunidades de ganhos superiores, mas com maior risco. Neste capítulo, você aprenderá sobre ações, análise fundamentalista e técnica, e como montar uma carteira diversificada.</p>
                </div>
                <div class="flex flex-col items-center">
                    <button class="study-topic-btn flex items-center px-6 py-3 bg-gray-300 text-gray-600 font-medium rounded-lg cursor-not-allowed" disabled>
                        <i class="fas fa-lock mr-2"></i>
                        <span>Em Breve</span>
                    </button>
                    <p class="text-xs text-gray-500 mt-2">Conclua os capítulos anteriores</p>
                </div>
            </div>
        </div>
        
        <!-- Seção 3.1 -->
        <div id="cap3-1" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">3.1</span>
                Ações: O Básico
            </h2>
            
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <p class="mb-4">Ações representam pequenas partes do capital social de uma empresa. Ao comprar uma ação, você se torna sócio da empresa e passa a ter direitos e benefícios.</p>
                
                <div class="grid md:grid-cols-2 gap-8 my-8">
                    <div>
                        <h3 class="font-semibold text-lg mb-3 flex items-center">
                            <i class="fas fa-star text-yellow-500 mr-2"></i>
                            Tipos de Ações
                        </h3>
                        <ul class="space-y-3">
                            <li class="flex items-start">
                                <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full mr-2">ON</span>
                                <div>
                                    <span class="font-medium">Ordinárias</span>
                                    <p class="text-sm text-gray-600">Direito a voto em assembleias</p>
                                </div>
                            </li>
                            <li class="flex items-start">
                                <span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded-full mr-2">PN</span>
                                <div>
                                    <span class="font-medium">Preferenciais</span>
                                    <p class="text-sm text-gray-600">Prioridade nos dividendos</p>
                                </div>
                            </li>
                            <li class="flex items-start">
                                <span class="bg-purple-100 text-purple-800 text-xs font-medium px-2.5 py-0.5 rounded-full mr-2">UNT</span>
                                <div>
                                    <span class="font-medium">Units</span>
                                    <p class="text-sm text-gray-600">Pacote com ON e PN</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="bg-yellow-50 p-4 rounded-lg">
                        <h3 class="font-semibold text-lg mb-3 flex items-center">
                            <i class="fas fa-hand-holding-usd text-yellow-500 mr-2"></i>
                            Como Ganhar com Ações?
                        </h3>
                        <ul class="space-y-2">
                            <li class="flex items-start">
                                <i class="fas fa-arrow-up text-green-500 mt-1 mr-2"></i>
                                <span>Valorização (compra por um preço e venda por outro maior)</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-money-bill-wave text-green-500 mt-1 mr-2"></i>
                                <span>Dividendos (participação nos lucros da empresa)</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-gavel text-green-500 mt-1 mr-2"></i>
                                <span>Direitos de subscrição (direito de comprar novas ações)</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-percentage text-green-500 mt-1 mr-2"></i>
                                <span>Juros sobre capital próprio</span>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <div class="bg-blue-50 p-4 rounded-lg mt-6">
                    <h3 class="font-semibold text-blue-800 mb-2">Onde Comprar Ações?</h3>
                    <p class="text-sm text-blue-700 mb-3">As ações são negociadas na Bolsa de Valores (B3 no Brasil) através de corretoras de valores. Escolha uma corretora regulamentada pela CVM.</p>
                    
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
                        <div class="bg-white p-3 rounded-lg shadow-sm text-center">
                            <i class="fas fa-chart-line text-2xl text-blue-500 mb-2"></i>
                            <p class="text-sm font-medium">XP Investimentos</p>
                        </div>
                        <div class="bg-white p-3 rounded-lg shadow-sm text-center">
                            <i class="fas fa-piggy-bank text-2xl text-blue-500 mb-2"></i>
                            <p class="text-sm font-medium">Rico</p>
                        </div>
                        <div class="bg-white p-3 rounded-lg shadow-sm text-center">
                            <i class="fas fa-coins text-2xl text-blue-500 mb-2"></i>
                            <p class="text-sm font-medium">Clear</p>
                        </div>
                        <div class="bg-white p-3 rounded-lg shadow-sm text-center">
                            <i class="fas fa-wallet text-2xl text-blue-500 mb-2"></i>
                            <p class="text-sm font-medium">Nuinvest</p>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8 bg-gray-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-lg mb-3">Riscos do Mercado de Ações</h3>
                    <div class="space-y-4">
                        <div class="flex items-start">
                            <span class="bg-red-100 text-red-800 text-xs font-medium px-2.5 py-0.5 rounded-full mr-3 mt-1">Alto</span>
                            <div>
                                <h4 class="font-medium text-gray-900">Volatilidade</h4>
                                <p class="text-sm text-gray-600">Preços podem variar significativamente em curto prazo</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <span class="bg-yellow-100 text-yellow-800 text-xs font-medium px-2.5 py-0.5 rounded-full mr-3 mt-1">Médio</span>
                            <div>
                                <h4 class="font-medium text-gray-900">Risco de Mercado</h4>
                                <p class="text-sm text-gray-600">Fatores econômicos e políticos afetam as cotações</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded-full mr-3 mt-1">Baixo</span>
                            <div>
                                <h4 class="font-medium text-gray-900">Risco de Liquidez</h4>
                                <p class="text-sm text-gray-600">Algumas ações têm pouca negociação</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Blocos Didáticos -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mt-6">
                    <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
                        <h3 class="font-semibold text-amber-800 mb-2">Erros comuns</h3>
                        <ul class="list-disc list-inside text-amber-900/90 text-sm space-y-1">
                            <li>Comprar apenas pela “moda” ou por dicas de terceiros.</li>
                            <li>Concentrar demais em uma única ação/setor.</li>
                            <li>Vender em pânico após quedas de curto prazo.</li>
                        </ul>
                    </div>
                    <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4">
                        <h3 class="font-semibold text-indigo-800 mb-2">Checklist rápido</h3>
                        <ul class="list-disc list-inside text-indigo-900/90 text-sm space-y-1">
                            <li>Tese de investimento clara.</li>
                            <li>Horizonte de longo prazo.</li>
                            <li>Capital que você pode deixar investido.</li>
                        </ul>
                    </div>
                    <div class="bg-emerald-50 border border-emerald-200 rounded-lg p-4">
                        <h3 class="font-semibold text-emerald-800 mb-2">Dica prática</h3>
                        <p class="text-sm text-emerald-900/90">Use aportes periódicos (DCA) para reduzir risco de entrar em momentos ruins e suavizar preço médio.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Seção 3.2 -->
        <div id="cap3-2" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">3.2</span>
                Análise Fundamentalista
            </h2>
            
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <p class="mb-4">A análise fundamentalista avalia o valor real de uma empresa com base em seus fundamentos econômicos e financeiros, como receita, lucro, dívida e perspectivas de crescimento.</p>
                
                <div class="grid md:grid-cols-3 gap-6 my-8">
                    <!-- Indicadores Fundamentais -->
                    <div class="bg-white border rounded-lg p-4 shadow-sm">
                        <h3 class="font-semibold text-lg text-gray-800 mb-3 border-b pb-2">Indicadores Chave</h3>
                        <ul class="space-y-3">
                            <li>
                                <span class="font-medium">P/L (Preço/Lucro)</span>
                                <p class="text-sm text-gray-600">Razão entre preço da ação e lucro por ação</p>
                            </li>
                            <li>
                                <span class="font-medium">P/VP (Preço/Valor Patrimonial)</span>
                                <p class="text-sm text-gray-600">Relação entre valor de mercado e valor contábil</p>
                            </li>
                            <li>
                                <span class="font-medium">ROE (Return on Equity)</span>
                                <p class="text-sm text-gray-600">Retorno sobre o patrimônio líquido</p>
                            </li>
                            <li>
                                <span class="font-medium">Dívida Líquida/EBITDA</span>
                                <p class="text-sm text-gray-600">Nível de endividamento da empresa</p>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- Análise Setorial -->
                    <div class="bg-white border rounded-lg p-4 shadow-sm">
                        <h3 class="font-semibold text-lg text-gray-800 mb-3 border-b pb-2">Análise Setorial</h3>
                        <ul class="space-y-3">
                            <li class="flex items-start">
                                <i class="fas fa-industry text-blue-500 mt-1 mr-2"></i>
                                <div>
                                    <span class="font-medium">Cíclicos</span>
                                    <p class="text-sm text-gray-600">Varejo, construção civil</p>
                                </div>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-shield-alt text-green-500 mt-1 mr-2"></i>
                                <div>
                                    <span class="font-medium">Defensivos</span>
                                    <p class="text-sm text-gray-600">Energia, saneamento</p>
                                </div>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-chart-line text-purple-500 mt-1 mr-2"></i>
                                <div>
                                    <span class="font-medium">Crescimento</span>
                                    <p class="text-sm text-gray-600">Tecnologia, saúde</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- Valuation -->
                    <div class="bg-white border rounded-lg p-4 shadow-sm">
                        <h3 class="font-semibold text-lg text-gray-800 mb-3 border-b pb-2">Métodos de Valuation</h3>
                        <ul class="space-y-3">
                            <li>
                                <span class="font-medium">Fluxo de Caixa Descontado</span>
                                <p class="text-sm text-gray-600">Projeção de fluxos futuros</p>
                            </li>
                            <li>
                                <span class="font-medium">Múltiplos de Mercado</span>
                                <p class="text-sm text-gray-600">Comparação com empresas similares</p>
                            </li>
                            <li>
                                <span class="font-medium">Valor de Liquidação</span>
                                <p class="text-sm text-gray-600">Valor dos ativos em caso de venda</p>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <div class="bg-green-50 p-4 rounded-lg border-l-4 border-green-500">
                    <h3 class="font-semibold text-green-800 mb-2">Dica do Especialista</h3>
                    <p class="text-sm text-green-700">Combine múltiplos métodos de avaliação para ter uma visão mais precisa do valor justo de uma ação. Nunca tome decisões baseadas em apenas um indicador.</p>
                </div>
                
                <div class="mt-8">
                    <h3 class="font-semibold text-lg mb-3">Exemplo Prático: Análise de uma Empresa</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Indicador</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Empresa X</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Média do Setor</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Análise</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">P/L</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">15x</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">12x</td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">Acima da média</span>
                                    </td>
                                </tr>
                                <tr class="bg-gray-50">
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">P/VP</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2.5x</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">3.0x</td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Abaixo da média</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">ROE</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">18%</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">15%</td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Acima da média</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Capítulo 4 -->
    <div id="cap4" class="page p-12">
        <div class="mb-8">
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                <div>
                    <span class="inline-block px-3 py-1 bg-primary-100 text-primary-800 text-sm font-medium rounded-full mb-2">Capítulo 4</span>
                    <h1 class="text-3xl font-serif font-bold text-primary-800 mb-2">Fundos de Investimento</h1>
                    <p class="text-lg text-gray-700 leading-relaxed">Os fundos de investimento permitem que você invista em uma carteira diversificada de ativos com um valor inicial acessível, contando com a gestão profissional de especialistas.</p>
                </div>
                <div class="flex flex-col items-center">
                    <button class="study-topic-btn flex items-center px-6 py-3 bg-gray-300 text-gray-600 font-medium rounded-lg cursor-not-allowed" disabled>
                        <i class="fas fa-lock mr-2"></i>
                        <span>Em Breve</span>
                    </button>
                    <p class="text-xs text-gray-500 mt-2">Conclua os capítulos anteriores</p>
                </div>
            </div>
        </div>
        
        <!-- Seção 4.1 -->
        <div id="cap4-1" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">4.1</span>
                Tipos de Fundos
            </h2>
            
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <p class="mb-6">Existem diversos tipos de fundos de investimento, cada um com suas características, riscos e potenciais retornos. Conheça os principais:</p>
                
                <div class="space-y-6">
                    <!-- Fundo RF -->
                    <div class="border rounded-lg overflow-hidden">
                        <div class="bg-blue-600 text-white px-4 py-2 font-medium">
                            Fundos de Renda Fixa
                        </div>
                        <div class="p-4">
                            <p class="mb-3">Investem predominantemente em títulos de renda fixa, como Tesouro Direto, CDBs, debêntures e títulos do governo.</p>
                            <div class="flex flex-wrap gap-2">
                                <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Baixo Risco</span>
                                <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Liquidez Diária</span>
                                <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Rent. CDI + 0,5% a 1,5%</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Fundo Ações -->
                    <div class="border rounded-lg overflow-hidden">
                        <div class="bg-green-600 text-white px-4 py-2 font-medium">
                            Fundos de Ações
                        </div>
                        <div class="p-4">
                            <p class="mb-3">Aplicam no mínimo 67% de seu patrimônio em ações negociadas no mercado à vista de bolsas de valores.</p>
                            <div class="flex flex-wrap gap-2">
                                <span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Alto Risco</span>
                                <span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Longo Prazo</span>
                                <span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Alta Volatilidade</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Fundo Imobiliário -->
                    <div class="border rounded-lg overflow-hidden">
                        <div class="bg-purple-600 text-white px-4 py-2 font-medium">
                            Fundos Imobiliários (FIIs)
                        </div>
                        <div class="p-4">
                            <p class="mb-3">Aplicam em empreendimentos imobiliários, como shoppings, prédios comerciais e lajes corporativas, distribuindo rendimentos mensais.</p>
                            <div class="flex flex-wrap gap-2">
                                <span class="bg-purple-100 text-purple-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Médio Risco</span>
                                <span class="bg-purple-100 text-purple-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Renda Passiva</span>
                                <span class="bg-purple-100 text-purple-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Isento IR</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Fundo Multimercado -->
                    <div class="border rounded-lg overflow-hidden">
                        <div class="bg-yellow-600 text-white px-4 py-2 font-medium">
                            Fundos Multimercado
                        </div>
                        <div class="p-4">
                            <p class="mb-3">Possuem liberdade para alocar recursos em diferentes classes de ativos, como renda fixa, ações, câmbio e derivativos.</p>
                            <div class="flex flex-wrap gap-2">
                                <span class="bg-yellow-100 text-yellow-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Risco Variável</span>
                                <span class="bg-yellow-100 text-yellow-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Estratégias Diversas</span>
                                <span class="bg-yellow-100 text-yellow-800 text-xs font-medium px-2.5 py-0.5 rounded-full">Taxa de Performance</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8 bg-blue-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-blue-800 mb-2">Como Escolher um Bom Fundo?</h3>
                    <ul class="space-y-2 text-sm text-blue-700">
                        <li class="flex items-start">
                            <i class="fas fa-check-circle text-blue-500 mt-1 mr-2"></i>
                            <span>Verifique o histórico de rentabilidade (mínimo 3 anos)</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-check-circle text-blue-500 mt-1 mr-2"></i>
                            <span>Analise a taxa de administração (quanto menor, melhor)</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-check-circle text-blue-500 mt-1 mr-2"></i>
                            <span>Conheça a estratégia e política de investimento</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-check-circle text-blue-500 mt-1 mr-2"></i>
                            <span>Verifique a classificação de risco (ANBIMA)</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- Seção 4.2 -->
        <div id="cap4-2" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">4.2</span>
                Taxas e Tributação
            </h2>
            
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <p class="mb-6">Entender as taxas e a tributação é fundamental para calcular o retorno real dos seus investimentos em fundos.</p>
                
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="font-semibold text-lg mb-4 border-b pb-2">Principais Taxas</h3>
                        <div class="space-y-4">
                            <div class="p-4 border rounded-lg">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="font-medium">Taxa de Administração</span>
                                    <span class="text-sm bg-gray-100 text-gray-800 px-2 py-1 rounded">0,5% a 3% a.a.</span>
                                </div>
                                <p class="text-sm text-gray-600">Cobrada sobre o valor investido, proporcional ao período.</p>
                            </div>
                            
                            <div class="p-4 border rounded-lg">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="font-medium">Taxa de Performance</span>
                                    <span class="text-sm bg-gray-100 text-gray-800 px-2 py-1 rounded">Até 20%</span>
                                </div>
                                <p class="text-sm text-gray-600">Cobrada sobre o rendimento que exceder o benchmark.</p>
                            </div>
                            
                            <div class="p-4 border rounded-lg">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="font-medium">Come-Cotas</span>
                                    <span class="text-sm bg-gray-100 text-gray-800 px-2 py-1 rounded">15% ou 20%</span>
                                </div>
                                <p class="text-sm text-gray-600">Antecipação do IR em maio e novembro (fundos de longo prazo).</p>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="font-semibold text-lg mb-4 border-b pb-2">Tributação</h3>
                        <div class="overflow-hidden border rounded-lg">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tipo de Fundo</th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Alíquota IR</th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Come-Cotas</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200">
                                    <tr>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">Renda Fixa</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">22,5% a 15%</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">Sim</td>
                                    </tr>
                                    <tr class="bg-gray-50">
                                        <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">Ações</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">15%</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">Não</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">Imobiliário</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">Isento*</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">Não</td>
                                    </tr>
                                    <tr class="bg-gray-50">
                                        <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">Multimercado</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">22,5% a 15%</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">Depende</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <p class="mt-3 text-xs text-gray-500">* Isenção para vendas até R$ 20.000/mês na B3. Acima disso, 20% de IR sobre o ganho de capital.</p>
                        
                        <div class="mt-6 p-4 bg-green-50 rounded-lg">
                            <h4 class="font-semibold text-green-800 mb-2">Dica de Ouro</h4>
                            <p class="text-sm text-green-700">Para investimentos de longo prazo, dê preferência a fundos isentos de IR (como FIIs) ou com alíquotas menores (como fundos de ações).</p>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded-r">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-exclamation-triangle text-yellow-500 text-xl"></i>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-yellow-800">Atenção às Taxas Ocultas</h3>
                            <div class="mt-2 text-sm text-yellow-700">
                                <p>Além das taxas de administração e performance, alguns fundos podem cobrar taxas de entrada, saída e até mesmo de inatividade. Sempre leia o regulamento e o prospecto antes de investir.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Blocos Didáticos 4.2 -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mt-6">
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <h3 class="font-semibold text-blue-800 mb-2">Exemplo prático</h3>
                        <p class="text-sm text-blue-900/90">Simule o impacto da taxa de administração: em 10 anos, 2% a.a. pode consumir uma fatia relevante do retorno frente a 0,5% a.a. Compare fundos com o mesmo benchmark.</p>
                    </div>
                    <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
                        <h3 class="font-semibold text-amber-800 mb-2">Erros comuns</h3>
                        <ul class="list-disc list-inside text-amber-900/90 text-sm space-y-1">
                            <li>Desconsiderar come-cotas na projeção de retorno.</li>
                            <li>Comparar fundos de prazos distintos pelo mesmo imposto.</li>
                            <li>Ignorar o benchmark na análise de performance.</li>
                        </ul>
                    </div>
                    <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4">
                        <h3 class="font-semibold text-indigo-800 mb-2">Checklist</h3>
                        <ul class="list-disc list-inside text-indigo-900/90 text-sm space-y-1">
                            <li>Qual a alíquota efetiva de IR ao resgatar?</li>
                            <li>Existe come-cotas? Quando incide?</li>
                            <li>Taxas compatíveis com o retorno acima do benchmark?</li>
                        </ul>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mt-4">
                    <div class="bg-emerald-50 border border-emerald-200 rounded-lg p-4">
                        <h3 class="font-semibold text-emerald-800 mb-2">Dicas</h3>
                        <ul class="list-disc list-inside text-emerald-900/90 text-sm space-y-1">
                            <li>Compare sempre após taxas (rentabilidade líquida de custos).</li>
                            <li>Entenda o prazo de resgate e o regime tributário antes de investir.</li>
                        </ul>
                    </div>
                    <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                        <h3 class="font-semibold text-gray-800 mb-2">Mini-FAQ</h3>
                        <ul class="text-sm text-gray-700 space-y-1">
                            <li><b>Todo FII é isento?</b> Isenção vale para pessoa física nos rendimentos distribuídos, respeitando regras da lei; ganho de capital pode ter IR.</li>
                            <li><b>Come-cotas reduz a rentabilidade?</b> É uma antecipação do IR que afeta o efeito dos juros compostos; compare com categorias sem come-cotas.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Capítulo 5 -->
    <div id="cap5" class="page p-12">
        <div class="mb-8">
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                <div>
                    <span class="inline-block px-3 py-1 bg-primary-100 text-primary-800 text-sm font-medium rounded-full mb-2">Capítulo 5</span>
                    <h1 class="text-3xl font-serif font-bold text-primary-800 mb-2">ETFs - Fundos de Índice</h1>
                    <p class="text-lg text-gray-700 leading-relaxed">Os ETFs (Exchange Traded Funds) são fundos de investimento que replicam índices do mercado financeiro, oferecendo diversificação, baixo custo e praticidade para os investidores.</p>
                </div>
                <div class="flex flex-col items-center">
                    <button class="study-topic-btn flex items-center px-6 py-3 bg-gray-300 text-gray-600 font-medium rounded-lg cursor-not-allowed" disabled>
                        <i class="fas fa-lock mr-2"></i>
                        <span>Em Breve</span>
                    </button>
                    <p class="text-xs text-gray-500 mt-2">Conclua os capítulos anteriores</p>
                </div>
            </div>
        </div>
        
        <!-- Seção 5.1 -->
        <div id="cap5-1" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">5.1</span>
                O que são ETFs?
            </h2>
            
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div>
                        <p class="mb-4">Os ETFs são fundos de investimento que têm como objetivo replicar o desempenho de um índice de mercado, como o Ibovespa, S&P 500 ou o Índice de Ações com Governança Diferenciada (IGC).</p>
                        
                        <div class="bg-blue-50 p-4 rounded-lg mb-4">
                            <h3 class="font-semibold text-blue-800 mb-2">Principais Características</h3>
                            <ul class="space-y-2 text-sm text-blue-700">
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-blue-500 mt-1 mr-2"></i>
                                    <span>Negociados na bolsa de valores como ações</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-blue-500 mt-1 mr-2"></i>
                                    <span>Taxas de administração baixas (geralmente abaixo de 0,5% ao ano)</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-blue-500 mt-1 mr-2"></i>
                                    <span>Diversificação automática em uma cesta de ativos</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-blue-500 mt-1 mr-2"></i>
                                    <span>Liquidez diária</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-semibold text-lg mb-3">Vantagens dos ETFs</h3>
                        <div class="space-y-4">
                            <div class="flex items-start">
                                <div class="flex-shrink-0 bg-green-100 p-2 rounded-full">
                                    <i class="fas fa-chart-line text-green-600"></i>
                                </div>
                                <div class="ml-3">
                                    <h4 class="font-medium text-gray-900">Diversificação</h4>
                                    <p class="text-sm text-gray-600">Acesso a uma carteira diversificada com um único investimento</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="flex-shrink-0 bg-blue-100 p-2 rounded-full">
                                    <i class="fas fa-coins text-blue-600"></i>
                                </div>
                                <div class="ml-3">
                                    <h4 class="font-medium text-gray-900">Baixo Custo</h4>
                                    <p class="text-sm text-gray-600">Taxas menores que fundos de gestão ativa</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="flex-shrink-0 bg-purple-100 p-2 rounded-full">
                                    <i class="fas fa-exchange-alt text-purple-600"></i>
                                </div>
                                <div class="ml-3">
                                    <h4 class="font-medium text-gray-900">Liquidez</h4>
                                    <p class="text-sm text-gray-600">Negocie seus investimentos a qualquer momento durante o pregão</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Calculadora de Comparação de Custos -->
                <div class="mt-8 p-6 bg-white border border-gray-200 rounded-lg shadow-sm">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">📊 Calculadora de Custos de ETFs</h3>
                    <p class="text-sm text-gray-600 mb-4">Compare o impacto das taxas de administração no longo prazo</p>
                    
                    <div class="grid md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label for="investimento-inicial" class="block text-sm font-medium text-gray-700 mb-1">Investimento Inicial (R$)</label>
                            <input type="number" id="investimento-inicial" value="10000" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label for="aportes-mensais" class="block text-sm font-medium text-gray-700 mb-1">Aportes Mensais (R$)</label>
                            <input type="number" id="aportes-mensais" value="1000" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label for="taxa-etf1" class="block text-sm font-medium text-gray-700 mb-1">Taxa ETF 1 (% a.a.)</label>
                            <input type="number" step="0.01" id="taxa-etf1" value="0.2" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label for="taxa-etf2" class="block text-sm font-medium text-gray-700 mb-1">Taxa ETF 2 (% a.a.)</label>
                            <input type="number" step="0.01" id="taxa-etf2" value="0.5" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label for="retorno-esperado" class="block text-sm font-medium text-gray-700 mb-1">Retorno Esperado (% a.a.)</label>
                            <input type="number" step="0.1" id="retorno-esperado" value="8" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label for="periodo" class="block text-sm font-medium text-gray-700 mb-1">Período (anos)</label>
                            <input type="number" id="periodo" value="10" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    
                    <button onclick="calcularComparacaoETFs()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200">
                        Calcular Comparação
                    </button>
                    
                    <div id="resultado-comparacao" class="mt-6 hidden">
                        <h4 class="font-medium text-gray-900 mb-3">Resultado após <span id="anos-resultado">10</span> anos:</h4>
                        <div class="space-y-4">
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span>ETF 1 (<span id="taxa1-resultado">0.20</span>% a.a.)</span>
                                    <span class="font-medium" id="resultado-etf1">R$ 0,00</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2.5">
                                    <div id="barra-etf1" class="bg-blue-600 h-2.5 rounded-full" style="width: 100%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span>ETF 2 (<span id="taxa2-resultado">0.50</span>% a.a.)</span>
                                    <span class="font-medium" id="resultado-etf2">R$ 0,00</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2.5">
                                    <div id="barra-etf2" class="bg-green-500 h-2.5 rounded-full" style="width: 100%"></div>
                                </div>
                            </div>
                            <div class="mt-4 p-3 bg-yellow-50 border-l-4 border-yellow-400 rounded-r">
                                <div class="flex">
                                    <div class="flex-shrink-0">
                                        <i class="fas fa-coins text-yellow-500"></i>
                                    </div>
                                    <div class="ml-3">
                                        <p class="text-sm text-yellow-700">Economia de <span id="diferenca" class="font-medium">R$ 0,00</span> ao longo do período</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
        
        

        <div class="mt-8">
            <h3 class="font-semibold text-lg mb-3">Principais ETFs no Brasil</h3>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ticker</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nome</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Índice de Referência</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Taxa de Administração</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap">BOVA11</td>
                            <td class="px-6 py-4 whitespace-nowrap">iShares Ibovespa Fundo de Índice</td>
                            <td class="px-6 py-4 whitespace-nowrap">Ibovespa</td>
                            <td class="px-6 py-4 whitespace-nowrap">0,20% a.a.</td>
                        </tr>
                        <tr class="bg-gray-50">
                            <td class="px-6 py-4 whitespace-nowrap">IVVB11</td>
                            <td class="px-6 py-4 whitespace-nowrap">iShares S&P 500</td>
                            <td class="px-6 py-4 whitespace-nowrap">S&P 500</td>
                            <td class="px-6 py-4 whitespace-nowrap">0,23% a.a.</td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap">SMAL11</td>
                            <td class="px-6 py-4 whitespace-nowrap">iShares Índice de Ações com Governança Diferenciada</td>
                            <td class="px-6 py-4 whitespace-nowrap">IGC</td>
                            <td class="px-6 py-4 whitespace-nowrap">0,30% a.a.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Blocos Didáticos 5.1 -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mt-6">
            <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
                <h3 class="font-semibold text-amber-800 mb-2">Erros comuns</h3>
                <ul class="list-disc list-inside text-amber-900/90 text-sm space-y-1">
                    <li>Escolher ETF só pela menor taxa, ignorando liquidez e tracking error.</li>
                    <li>Concentrar em um único índice (falta de diversificação geográfica/setorial).</li>
                    <li>Negligenciar custos de corretagem e spread no rebalanceamento.</li>
                </ul>
            </div>
            <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4">
                <h3 class="font-semibold text-indigo-800 mb-2">Checklist rápido</h3>
                <ul class="list-disc list-inside text-indigo-900/90 text-sm space-y-1">
                    <li>Índice replicado é coerente com seu objetivo?</li>
                    <li>Taxa, liquidez média diária e tracking error ok?</li>
                    <li>Exposição cambial desejada (no caso de ETFs internacionais)?</li>
                </ul>
            </div>
            <div class="bg-emerald-50 border border-emerald-200 rounded-lg p-4">
                <h3 class="font-semibold text-emerald-800 mb-2">Dica prática</h3>
                <p class="text-sm text-emerald-900/90">Monte um core com ETFs amplos (ex.: Ibovespa/S&P 500) e adicione satélites específicos (ex.: small caps, setores) conforme sua tese e tolerância a risco.</p>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mt-4">
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                <h3 class="font-semibold text-blue-800 mb-2">Exemplo prático</h3>
                <p class="text-sm text-blue-900/90">Compare BOVA11 x IVVB11: riscos distintos (BR x EUA) e moedas diferentes. Uma alocação 60/40 pode reduzir volatilidade e risco local.</p>
            </div>
            <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <h3 class="font-semibold text-gray-800 mb-2">Mini-FAQ</h3>
                <ul class="text-sm text-gray-700 space-y-1">
                    <li><b>ETF paga dividendo?</b> Alguns distribuem; outros reinvestem. Veja o prospecto.</li>
                    <li><b>Tem IR?</b> Regras seguem renda variável; avalie operações e eventuais isenções.</li>
                </ul>
            </div>
        </div>

    <!-- Modais de Estudo -->
    <div id="modalContainer">
        <!-- Modal de Estudo -->
        <div id="studyModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center p-6 border-b sticky top-0 bg-white z-10">
                    <h3 id="modalTitle" class="text-2xl font-bold text-gray-900">Título do Tópico</h3>
                    <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-2xl"></i>
                    </button>
                </div>
                <div class="p-6">
                    <div class="grid md:grid-cols-3 gap-8 mb-8">
                        <!-- Resumo -->
                        <div class="md:col-span-2">
                            <h4 class="text-lg font-semibold mb-4 text-gray-800 flex items-center">
                                <i class="fas fa-file-alt text-blue-500 mr-2"></i> Resumo
                            </h4>
                            <div id="modalSummary" class="prose max-w-none text-gray-700">
                                <!-- Conteúdo será inserido via JavaScript -->
                            </div>
                        </div>
                        
                        <!-- Mapa Mental -->
                        <div>
                            <h4 class="text-lg font-semibold mb-4 text-gray-800 flex items-center">
                                <i class="fas fa-project-diagram text-green-500 mr-2"></i> Mapa Mental
                            </h4>
                            <div id="modalMindMap" class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                <!-- Mapa mental será inserido via JavaScript -->
                                <img id="mindMapImage" src="" alt="Mapa Mental" class="w-full h-auto rounded">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Citações -->
                    <div class="mt-8 pt-6 border-t">
                        <h4 class="text-lg font-semibold mb-4 text-gray-800 flex items-center">
                            <i class="fas fa-quote-right text-purple-500 mr-2"></i> Citações Importantes
                        </h4>
                        <div id="modalQuotes" class="space-y-4">
                            <!-- Citações serão inseridas via JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Recursos Adicionais -->
                    <div class="mt-8 pt-6 border-t">
                        <h4 class="text-lg font-semibold mb-4 text-gray-800 flex items-center">
                            <i class="fas fa-external-link-alt text-yellow-500 mr-2"></i> Recursos Adicionais
                        </h4>
                        <div id="modalResources" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- Recursos serão inseridos via JavaScript -->
                        </div>
                    </div>

                    <!-- Ferramentas de Estudo -->
                    <div class="mt-8 pt-6 border-t">
                        <h4 class="text-lg font-semibold mb-4 text-gray-800 flex items-center">
                            <i class="fas fa-tools text-gray-500 mr-2"></i> Ferramentas de Estudo
                        </h4>
                        <div id="studyTools"></div>
                    </div>

                    <!-- Curiosidades -->
                    <div class="mt-8 pt-6 border-t">
                        <h4 class="text-lg font-semibold mb-4 text-gray-800 flex items-center">
                            <i class="fas fa-lightbulb text-amber-500 mr-2"></i> Curiosidades
                        </h4>
                        <ul id="modalCuriosities" class="list-disc pl-5 space-y-2 text-gray-700">
                            <!-- Curiosidades inseridas via JavaScript -->
                        </ul>
                    </div>

                    <!-- Exercícios Práticos -->
                    <div class="mt-8 pt-6 border-t">
                        <h4 class="text-lg font-semibold mb-4 text-gray-800 flex items-center">
                            <i class="fas fa-dumbbell text-emerald-500 mr-2"></i> Exercícios Práticos
                        </h4>
                        <ol id="modalExercises" class="list-decimal pl-5 space-y-3 text-gray-700">
                            <!-- Exercícios inseridos via JavaScript -->
                        </ol>
                        <div id="modalExercisesHint" class="text-xs text-gray-500 mt-2">Dica: tente responder antes de procurar materiais de apoio nos recursos.</div>
                    </div>

                    <!-- FAQ Rápido -->
                    <div class="mt-8 pt-6 border-t">
                        <h4 class="text-lg font-semibold mb-4 text-gray-800 flex items-center">
                            <i class="fas fa-info-circle text-blue-500 mr-2"></i> FAQ Rápido
                        </h4>
                        <div id="modalFAQ" class="space-y-3">
                            <!-- FAQ inserido via JavaScript -->
                        </div>
                    </div>
                </div>
                <div class="bg-gray-50 px-6 py-4 flex justify-end space-x-3 border-t rounded-b-xl">
                    <button onclick="closeModal()" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                        Fechar
                    </button>
                    <button onclick="printModalContent()" class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                        <i class="fas fa-print mr-2"></i> Imprimir
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Modal de Recursos -->
        <div id="resourceModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center p-6 border-b sticky top-0 bg-white z-10">
                    <h3 id="resourceModalTitle" class="text-2xl font-bold text-gray-900">Recursos</h3>
                    <button onclick="closeResourceModal()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times text-2xl"></i>
                    </button>
                </div>
                <div class="p-6">
                    <div id="resourceContent">
                        <!-- Conteúdo será inserido via JavaScript -->
                    </div>
                </div>
                <div class="bg-gray-50 px-6 py-4 flex justify-end space-x-3 border-t rounded-b-xl">
                    <button onclick="closeResourceModal()" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                        Fechar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Capítulo 6 -->
    <div id="cap6" class="page p-12">
        <div class="mb-8">
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                <div>
                    <span class="inline-block px-3 py-1 bg-primary-100 text-primary-800 text-sm font-medium rounded-full mb-2">Capítulo 6</span>
                    <h1 class="text-3xl font-serif font-bold text-primary-800 mb-2">Criptomoedas</h1>
                    <p class="text-lg text-gray-700 leading-relaxed">As criptomoedas são ativos digitais descentralizados que utilizam criptografia para segurança. Neste capítulo, exploraremos o mercado de criptoativos, suas oportunidades e riscos.</p>
                </div>
                <div class="flex flex-col items-center">
                    <button class="study-topic-btn flex items-center px-6 py-3 bg-gray-300 text-gray-600 font-medium rounded-lg cursor-not-allowed" disabled>
                        <i class="fas fa-lock mr-2"></i>
                        <span>Em Breve</span>
                    </button>
                    <p class="text-xs text-gray-500 mt-2">Conclua os capítulos anteriores</p>
                </div>
            </div>
        </div>
        
        <!-- Seção 6.1 -->
        <div id="cap6-1" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">6.1</span>
                O que são Criptomoedas?
            </h2>
            
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div>
                        <p class="mb-4">Criptomoedas são moedas digitais que utilizam criptografia para garantir a segurança das transações e controlar a criação de novas unidades. Elas operam em uma tecnologia chamada blockchain.</p>
                        
                        <div class="bg-blue-50 p-4 rounded-lg mb-4">
                            <h3 class="font-semibold text-blue-800 mb-2">Características Principais</h3>
                            <ul class="space-y-2 text-sm text-blue-700">
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-blue-500 mt-1 mr-2"></i>
                                    <span>Descentralização: não são controladas por governos ou bancos</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-blue-500 mt-1 mr-2"></i>
                                    <span>Transparência: todas as transações são registradas no blockchain</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-blue-500 mt-1 mr-2"></i>
                                    <span>Segurança: protegidas por criptografia avançada</span>
                                </li>
                                <li class="flex items-start">
                                    <i class="fas fa-check-circle text-blue-500 mt-1 mr-2"></i>
                                    <span>Globalização: podem ser enviadas para qualquer lugar do mundo</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-semibold text-lg mb-3">Principais Criptomoedas</h3>
                        <div class="space-y-4">
                            <div class="flex items-center p-3 border rounded-lg">
                                <img src="assets/images/bitcoin.png" alt="Bitcoin" class="w-8 h-8 mr-3">
                                <div>
                                    <h4 class="font-medium">Bitcoin (BTC)</h4>
                                    <p class="text-sm text-gray-600">A primeira e mais valiosa criptomoeda</p>
                                </div>
                            </div>
                            
                            <div class="flex items-center p-3 border rounded-lg">
                                <img src="assets/images/ethereum.png" alt="Ethereum" class="w-8 h-8 mr-3">
                                <div>
                                    <h4 class="font-medium">Ethereum (ETH)</h4>
                                    <p class="text-sm text-gray-600">Plataforma para contratos inteligentes</p>
                                </div>
                            </div>
                            
                            <div class="flex items-center p-3 border rounded-lg">
                                <img src="assets/images/binance.png" alt="Binance Coin" class="w-8 h-8 mr-3">
                                <div>
                                    <h4 class="font-medium">Binance Coin (BNB)</h4>
                                    <p class="text-sm text-gray-600">Utilizada na plataforma Binance</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8">
                    <h3 class="font-semibold text-lg mb-3">Como Funciona o Blockchain?</h3>
                    <p class="mb-4">O blockchain é um livro-razão digital que registra todas as transações em blocos encadeados. Cada bloco contém um conjunto de transações e uma referência ao bloco anterior, criando uma cadeia segura e imutável.</p>
                    
                    <div class="grid md:grid-cols-3 gap-6 mt-6">
                        <div class="bg-white border rounded-lg p-4 text-center">
                            <div class="bg-blue-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-3">
                                <i class="fas fa-shield-alt text-blue-600 text-xl"></i>
                            </div>
                            <h4 class="font-semibold mb-1">Segurança</h4>
                            <p class="text-sm text-gray-600">Dados criptografados e distribuídos</p>
                        </div>
                        
                        <div class="bg-white border rounded-lg p-4 text-center">
                            <div class="bg-green-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-3">
                                <i class="fas fa-exchange-alt text-green-600 text-xl"></i>
                            </div>
                            <h4 class="font-semibold mb-1">Descentralização</h4>
                            <p class="text-sm text-gray-600">Sem ponto único de falha</p>
                        </div>
                        
                        <div class="bg-white border rounded-lg p-4 text-center">
                            <div class="bg-purple-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-3">
                                <i class="fas fa-eye-slash text-purple-600 text-xl"></i>
                            </div>
                            <h4 class="font-semibold mb-1">Transparência</h4>
                            <p class="text-sm text-gray-600">Todas as transações são públicas</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Seção 6.2 -->
        <div id="cap6-2" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">6.2</span>
                Como Investir em Criptomoedas
            </h2>
            
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <p class="mb-6">Investir em criptomoedas requer cuidado e conhecimento. Veja os passos para começar:</p>
                
                <div class="space-y-6">
                    <div class="flex">
                        <div class="flex-shrink-0 bg-blue-100 w-8 h-8 rounded-full flex items-center justify-center text-blue-700 font-bold mr-4">1</div>
                        <div>
                            <h3 class="font-semibold text-lg mb-1">Escolha uma Corretora</h3>
                            <p class="text-gray-700">Selecione uma exchange de criptomoedas confiável e regulamentada. No Brasil, algumas opções são: Mercado Bitcoin, Foxbit, Binance e NovaDAX.</p>
                        </div>
                    </div>
                    
                    <div class="flex">
                        <div class="flex-shrink-0 bg-blue-100 w-8 h-8 rounded-full flex items-center justify-center text-blue-700 font-bold mr-4">2</div>
                        <div>
                            <h3 class="font-semibold text-lg mb-1">Crie uma Conta</h3>
                            <p class="text-gray-700">Faça seu cadastro, complete a verificação de identidade (KYC) e ative a autenticação de dois fatores (2FA) para maior segurança.</p>
                        </div>
                    </div>
                    
                    <div class="flex">
                        <div class="flex-shrink-0 bg-blue-100 w-8 h-8 rounded-full flex items-center justify-center text-blue-700 font-bold mr-4">3</div>
                        <div>
                            <h3 class="font-semibold text-lg mb-1">Faça um Depósito</h3>
                            <p class="text-gray-700">Transfira recursos da sua conta bancária para a corretora. A maioria das exchanges aceita TED ou PIX.</p>
                        </div>
                    </div>
                    
                    <div class="flex">
                        <div class="flex-shrink-0 bg-blue-100 w-8 h-8 rounded-full flex items-center justify-center text-blue-700 font-bold mr-4">4</div>
                        <div>
                            <h3 class="font-semibold text-lg mb-1">Comece a Negociar</h3>
                            <p class="text-gray-700">Escolha as criptomoedas que deseja comprar e execute suas ordens de compra.</p>
                        </div>
                    </div>
                    
                    <div class="flex">
                        <div class="flex-shrink-0 bg-blue-100 w-8 h-8 rounded-full flex items-center justify-center text-blue-700 font-bold mr-4">5</div>
                        <div>
                            <h3 class="font-semibold text-lg mb-1">Armazene com Segurança</h3>
                            <p class="text-gray-700">Para maior segurança, transfira suas criptomoedas para uma carteira própria (hardware wallet ou software wallet).</p>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8 bg-yellow-50 p-4 rounded-lg border-l-4 border-yellow-400">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-exclamation-triangle text-yellow-500 text-xl"></i>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-yellow-800">Atenção aos Riscos</h3>
                            <div class="mt-2 text-sm text-yellow-700">
                                <p>O mercado de criptomoedas é altamente volátil. Nunca invista mais do que você pode perder e sempre faça sua própria pesquisa antes de investir.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Capítulo 7 -->
    <div id="cap7" class="page p-12">
        <div class="mb-8">
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                <div>
                    <span class="inline-block px-3 py-1 bg-primary-100 text-primary-800 text-sm font-medium rounded-full mb-2">Capítulo 7</span>
                    <h1 class="text-3xl font-serif font-bold text-primary-800 mb-2">Planejamento Financeiro Pessoal</h1>
                    <p class="text-lg text-gray-700 leading-relaxed">A base para uma vida financeira saudável começa com um planejamento bem estruturado. Aprenda a controlar suas finanças e alcançar seus objetivos.</p>
                </div>
                <div class="flex flex-col items-center">
                    <button onclick="openStudyModal('planejamento-financeiro')" class="study-topic-btn flex items-center px-6 py-3 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg transition-colors shadow-md hover:shadow-lg" data-topic-id="planejamento-financeiro">
                        <i class="fas fa-graduation-cap mr-2"></i>
                        <span>Estudar Tópico</span>
                    </button>
                    <div class="mt-2 text-sm text-gray-500 flex items-center">
                        <span class="mr-2">Progresso:</span>
                        <div class="w-16 h-2 bg-gray-200 rounded-full overflow-hidden">
                            <div class="h-full bg-green-500 progress-bar" style="width: 0%"></div>
                        </div>
                        <span class="ml-2 text-xs progress-text">0%</span>
                    </div>
                    <p class="text-xs text-gray-400 mt-1 last-studied hidden">Último estudo: -</p>
                </div>
            </div>
        </div>

        <!-- Seção 7.1 -->
        <div id="cap7-1" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">7.1</span>
                Orçamento e Controle Financeiro
            </h2>
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <p class="mb-6">O orçamento pessoal é a ferramenta mais importante para o controle financeiro. Ele permite que você entenda para onde seu dinheiro está indo e tome decisões mais conscientes sobre seus gastos.</p>
                
                <div class="grid md:grid-cols-2 gap-8 my-8">
                    <div>
                        <h3 class="font-semibold text-lg mb-4">Como Criar um Orçamento</h3>
                        <ol class="space-y-4 list-decimal pl-5">
                            <li class="pl-2"><span class="font-medium">Liste suas receitas totais:</span> Inclua salário, rendimentos extras e outras fontes de renda.</li>
                            <li class="pl-2"><span class="font-medium">Identifique gastos fixos:</span> Aluguel, financiamentos, contas recorrentes.</li>
                            <li class="pl-2"><span class="font-medium">Registre gastos variáveis:</span> Alimentação, lazer, compras.</li>
                            <li class="pl-2"><span class="font-medium">Categorize os gastos:</span> Essenciais, não essenciais e supérfluos.</li>
                            <li class="pl-2"><span class="font-medium">Acompanhe e ajuste:</span> Revise mensalmente e faça os ajustes necessários.</li>
                        </ol>
                    </div>
                    <div class="bg-blue-50 p-6 rounded-lg">
                        <h3 class="font-semibold text-blue-800 mb-3">Regra 50/30/20</h3>
                        <p class="text-blue-700 mb-4">Uma referência para distribuição de renda:</p>
                        <ul class="space-y-2">
                            <li class="flex items-start">
                                <span class="inline-block w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-medium mr-2 mt-0.5">50%</span>
                                <span>Necessidades essenciais (moradia, alimentação, transporte)</span>
                            </li>
                            <li class="flex items-start">
                                <span class="inline-block w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-medium mr-2 mt-0.5">30%</span>
                                <span>Estilo de vida (lazer, viagens, entretenimento)</span>
                            </li>
                            <li class="flex items-start">
                                <span class="inline-block w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-medium mr-2 mt-0.5">20%</span>
                                <span>Investimentos e metas financeiras</span>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <div class="mt-8">
                    <h3 class="font-semibold text-lg mb-3">Ferramentas Recomendadas</h3>
                    <div class="grid md:grid-cols-3 gap-6 mt-4">
                        <div class="border rounded-lg p-4 hover:shadow-md transition-shadow">
                            <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 mb-3">
                                <i class="fas fa-mobile-alt"></i>
                            </div>
                            <h4 class="font-medium mb-1">Aplicativos</h4>
                            <p class="text-sm text-gray-600">Mobills, Guiabolso, Organizze e Minhas Economias</p>
                        </div>
                        <div class="border rounded-lg p-4 hover:shadow-md transition-shadow">
                            <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center text-green-600 mb-3">
                                <i class="fas fa-file-excel"></i>
                            </div>
                            <h4 class="font-medium mb-1">Planilhas</h4>
                            <p class="text-sm text-gray-600">Modelos personalizáveis no Google Sheets ou Excel</p>
                        </div>
                        <div class="border rounded-lg p-4 hover:shadow-md transition-shadow">
                            <div class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center text-purple-600 mb-3">
                                <i class="fas fa-book"></i>
                            </div>
                            <h4 class="font-medium mb-1">Método Tradicional</h4>
                            <p class="text-sm text-gray-600">Caderno de anotações e caneta para controle manual</p>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded-r">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-lightbulb text-yellow-500 text-xl"></i>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-yellow-800">Dica do Especialista</h3>
                            <div class="mt-2 text-sm text-yellow-700">
                                <p>Reserve um dia fixo na semana para atualizar seu orçamento. A consistência é a chave para o sucesso financeiro!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Seção 7.2 -->
        <div id="cap7-2" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">7.2</span>
                Metas Financeiras
            </h2>
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <p class="mb-6">Metas financeiras bem definidas são essenciais para manter o foco e a motivação na jornada de educação financeira. Elas funcionam como um GPS para suas finanças.</p>
                
                <div class="grid md:grid-cols-2 gap-8 my-8">
                    <div>
                        <h3 class="font-semibold text-lg mb-4">Tipos de Metas</h3>
                        <div class="space-y-4">
                            <div class="p-4 border rounded-lg">
                                <h4 class="font-medium text-blue-700 mb-2">Curto Prazo (até 1 ano)</h4>
                                <p class="text-sm text-gray-700">Ex: Comprar um notebook, fazer uma viagem, montar a reserva de emergência.</p>
                            </div>
                            <div class="p-4 border rounded-lg">
                                <h4 class="font-medium text-blue-700 mb-2">Médio Prazo (1 a 5 anos)</h4>
                                <p class="text-sm text-gray-700">Ex: Comprar um carro, dar entrada em um imóvel, fazer um curso de especialização.</p>
                            </div>
                            <div class="p-4 border rounded-lg">
                                <h4 class="font-medium text-blue-700 mb-2">Longo Prazo (acima de 5 anos)</h4>
                                <p class="text-sm text-gray-700">Ex: Aposentadoria, comprar uma casa, independência financeira.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="font-semibold text-lg mb-4">Como Definir Metas Eficazes</h3>
                        <div class="p-4 bg-blue-50 rounded-lg">
                            <h4 class="font-medium text-blue-800 mb-3">Método SMART</h4>
                            <ul class="space-y-2">
                                <li class="flex items-start">
                                    <span class="inline-block w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-medium mr-2 mt-0.5">S</span>
                                    <span><span class="font-medium">Específica:</span> Seja claro sobre o que deseja alcançar.</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="inline-block w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-medium mr-2 mt-0.5">M</span>
                                    <span><span class="font-medium">Mensurável:</span> Defina valores e prazos concretos.</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="inline-block w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-medium mr-2 mt-0.5">A</span>
                                    <span><span class="font-medium">Alcançável:</span> Seja realista com suas possibilidades.</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="inline-block w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-medium mr-2 mt-0.5">R</span>
                                    <span><span class="font-medium">Relevante:</span> Alinhe com seus valores e objetivos de vida.</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="inline-block w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-xs font-medium mr-2 mt-0.5">T</span>
                                    <span><span class="font-medium">Temporal:</span> Defina um prazo para realização.</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8">
                    <h3 class="font-semibold text-lg mb-3">Exemplo Prático</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Meta</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Valor (R$)</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Prazo</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mensalidade</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Reserva de Emergência</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">15.000</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">10 meses</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">1.500</td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Viagem Internacional</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">10.000</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">20 meses</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">500</td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Entrada do Apartamento</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">50.000</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">60 meses</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">833</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Seção 7.3 -->
        <div id="cap7-3" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">7.3</span>
                Estratégias para Quitar Dívidas
            </h2>
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <p class="mb-6">Quitar dívidas é o primeiro passo para alcançar a liberdade financeira. Conheça as melhores estratégias para se livrar das dívidas de forma eficiente e organizada.</p>
                
                <div class="grid md:grid-cols-2 gap-8 my-8">
                    <div>
                        <h3 class="font-semibold text-lg mb-4">Métodos de Pagamento de Dívidas</h3>
                        <div class="space-y-4">
                            <div class="p-4 border rounded-lg">
                                <h4 class="font-medium text-blue-700 mb-2">Método da Bola de Neve</h4>
                                <p class="text-sm text-gray-700 mb-2">Ordene as dívidas do menor para o maior valor e pague o máximo possível da menor dívida, enquanto paga o mínimo nas outras.</p>
                                <p class="text-xs text-gray-500"><span class="font-medium">Vantagem:</span> Motivação rápida ao ver dívidas sendo quitadas.</p>
                            </div>
                            <div class="p-4 border rounded-lg">
                                <h4 class="font-medium text-blue-700 mb-2">Método da Avalanche</h4>
                                <p class="text-sm text-gray-700 mb-2">Foque na dívida com a maior taxa de juros primeiro, pagando o máximo possível nela e o mínimo nas outras.</p>
                                <p class="text-xs text-gray-500"><span class="font-medium">Vantagem:</span> Economiza em juros no longo prazo.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="font-semibold text-lg mb-4">Dicas para Negociação</h3>
                        <div class="space-y-4">
                            <div class="p-4 bg-green-50 rounded-lg">
                                <h4 class="font-medium text-green-800 mb-2">1. Pesquise as taxas de juros</h4>
                                <p class="text-sm text-green-700">Compare as taxas de juros do mercado antes de fazer qualquer negociação.</p>
                            </div>
                            <div class="p-4 bg-green-50 rounded-lg">
                                <h4 class="font-medium text-green-800 mb-2">2. Peça desconto</h4>
                                <p class="text-sm text-green-700">Muitas instituições oferecem descontos para pagamento à vista ou antecipado.</p>
                            </div>
                            <div class="p-4 bg-green-50 rounded-lg">
                                <h4 class="font-medium text-green-800 mb-2">3. Considere um empréstimo consignado</h4>
                                <p class="text-sm text-green-700">Pode ter taxas menores que o rotativo do cartão de crédito.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8 p-4 bg-red-50 border-l-4 border-red-400 rounded-r">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-exclamation-triangle text-red-500 text-xl"></i>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-red-800">Cuidado com as armadilhas</h3>
                            <div class="mt-2 text-sm text-red-700">
                                <p>Evite fazer novas dívidas enquanto estiver pagando as antigas. Fuja de empréstimos com juros abusivos e cheque especial.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Seção 7.4 -->
        <div id="cap7-4" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">7.4</span>
                Reserva de Emergência
            </h2>
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <p class="mb-6">A reserva de emergência é a base da segurança financeira. Ela serve como proteção contra imprevistos como desemprego, problemas de saúde ou reparos inesperados.</p>
                
                <div class="grid md:grid-cols-2 gap-8 my-8">
                    <div>
                        <h3 class="font-semibold text-lg mb-4">Como Calcular sua Reserva</h3>
                        <p class="mb-4">O valor ideal varia conforme seu perfil e estabilidade financeira:</p>
                        <ul class="space-y-3 mb-6">
                            <li class="flex items-start">
                                <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                <span><span class="font-medium">Mínimo recomendado:</span> 3 meses de despesas essenciais</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                <span><span class="font-medium">Ideal:</span> 6 a 12 meses de despesas essenciais</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                <span><span class="font-medium">Autônomos e profissionais liberais:</span> 12 meses ou mais</span>
                            </li>
                        </ul>
                        
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h4 class="font-medium text-blue-800 mb-2">Exemplo Prático</h4>
                            <p class="text-sm text-blue-700">Se suas despesas mensais são R$ 3.000, sua reserva deve ser entre R$ 9.000 (3 meses) e R$ 36.000 (12 meses).</p>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="font-semibold text-lg mb-4">Onde Manter sua Reserva</h3>
                        <div class="space-y-4">
                            <div class="p-4 border rounded-lg">
                                <h4 class="font-medium text-blue-700 mb-2">1. Tesouro Selic</h4>
                                <p class="text-sm text-gray-700">Baixo risco, liquidez diária e isenção de IR para pessoas físicas.</p>
                            </div>
                            <div class="p-4 border rounded-lg">
                                <h4 class="font-medium text-blue-700 mb-2">2. CDB com liquidez diária</h4>
                                <p class="text-sm text-gray-700">Oferecido por bancos, com proteção do FGC até R$ 250 mil por CPF.</p>
                            </div>
                            <div class="p-4 border rounded-lg">
                                <h4 class="font-medium text-blue-700 mb-2">3. Fundos DI</h4>
                                <p class="text-sm text-gray-700">Fundos de investimento de baixo risco, com liquidez diária.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8 bg-green-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-green-800 mb-3">Dicas Importantes</h3>
                    <ul class="space-y-2">
                        <li class="flex items-start">
                            <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                            <span>Mantenha sua reserva separada da sua conta corrente para evitar gastos desnecessários.</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                            <span>Atualize o valor periodicamente para acompanhar mudanças no seu padrão de vida.</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                            <span>Use a reserva apenas para emergências reais, não para compras ou viagens.</span>
                        </li>
                    </ul>
                </div>
                
                <div class="mt-8">
                    <h3 class="font-semibold text-lg mb-3">Calculadora de Reserva de Emergência</h3>
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <label for="despesas" class="block text-sm font-medium text-gray-700 mb-1">Despesas Mensais (R$)</label>
                                <input type="number" id="despesas" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Ex: 3000">
                            </div>
                            <div>
                                <label for="meses" class="block text-sm font-medium text-gray-700 mb-1">Meses de Reserva</label>
                                <select id="meses" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="3">3 meses (mínimo)</option>
                                    <option value="6" selected>6 meses (recomendado)</option>
                                    <option value="12">12 meses (ideal)</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                            <p class="text-sm text-gray-600 mb-1">Sua reserva de emergência deve ser de:</p>
                            <p class="text-2xl font-bold text-blue-700" id="resultado-reserva">R$ 0,00</p>
                        </div>
                        <button onclick="calcularReserva()" class="mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors">Calcular</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Capítulo 8 -->
    <div id="cap8" class="page p-12">
        <div class="mb-8">
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                <div>
                    <span class="inline-block px-3 py-1 bg-primary-100 text-primary-800 text-sm font-medium rounded-full mb-2">Capítulo 8</span>
                    <h1 class="text-3xl font-serif font-bold text-primary-800 mb-2">Investimentos no Exterior</h1>
                    <p class="text-lg text-gray-700 leading-relaxed">Expanda seus horizontes de investimento além das fronteiras do Brasil e diversifique sua carteira em nível global.</p>
                </div>
                <div class="flex flex-col items-center">
                    <button onclick="openStudyModal('investimentos-exterior')" class="study-topic-btn flex items-center px-6 py-3 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg transition-colors shadow-md hover:shadow-lg" data-topic-id="investimentos-exterior">
                        <i class="fas fa-graduation-cap mr-2"></i>
                        <span>Estudar Tópico</span>
                    </button>
                    <div class="mt-2 text-sm text-gray-500 flex items-center">
                        <span class="mr-2">Progresso:</span>
                        <div class="w-16 h-2 bg-gray-200 rounded-full overflow-hidden">
                            <div class="h-full bg-green-500 progress-bar" style="width: 0%"></div>
                        </div>
                        <span class="ml-2 text-xs progress-text">0%</span>
                    </div>
                    <p class="text-xs text-gray-400 mt-1 last-studied hidden">Último estudo: -</p>
                </div>
            </div>
        </div>

        <!-- Seção 8.1 -->
        <div id="cap8-1" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">8.1</span>
                Por que Investir no Exterior?
            </h2>
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <p class="mb-6">Investir no exterior pode trazer diversos benefícios para sua carteira, como diversificação geográfica, exposição a diferentes moedas e acesso a empresas inovadoras que não estão listadas no mercado brasileiro.</p>
                
                <div class="grid md:grid-cols-2 gap-8 my-8">
                    <div>
                        <h3 class="font-semibold text-lg mb-4">Vantagens dos Investimentos Internacionais</h3>
                        <div class="space-y-4">
                            <div class="p-4 border rounded-lg hover:shadow-md transition-shadow">
                                <h4 class="font-medium text-blue-700 mb-2">Diversificação Geográfica</h4>
                                <p class="text-sm text-gray-700">Reduza o risco da sua carteira ao investir em diferentes economias ao redor do mundo, não ficando exposto apenas ao cenário econômico brasileiro.</p>
                            </div>
                            <div class="p-4 border rounded-lg hover:shadow-md transition-shadow">
                                <h4 class="font-medium text-blue-700 mb-2">Exposição a Moedas Fortes</h4>
                                <p class="text-sm text-gray-700">Invista em ativos denominados em moedas fortes como Dólar e Euro, protegendo seu patrimônio da desvalorização do Real.</p>
                            </div>
                            <div class="p-4 border rounded-lg hover:shadow-md transition-shadow">
                                <h4 class="font-medium text-blue-700 mb-2">Acesso a Empresas Globais</h4>
                                <p class="text-sm text-gray-700">Invista em gigantes globais como Apple, Amazon, Tesla e outras empresas inovadoras que não estão listadas na B3.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="font-semibold text-lg mb-4">Riscos a Considerar</h3>
                        <div class="space-y-4">
                            <div class="p-4 bg-red-50 rounded-lg">
                                <h4 class="font-medium text-red-700 mb-2">Variação Cambial</h4>
                                <p class="text-sm text-red-600">A valorização do Real pode reduzir seus ganhos em moeda estrangeira. Por outro lado, a desvalorização pode aumentar seus retornos.</p>
                            </div>
                            <div class="p-4 bg-red-50 rounded-lg">
                                <h4 class="font-medium text-red-700 mb-2">Regulamentação e Tributação</h4>
                                <p class="text-sm text-red-600">Cada país tem suas próprias regras tributárias e regulatórias que podem afetar seus investimentos.</p>
                            </div>
                            <div class="p-4 bg-red-50 rounded-lg">
                                <h4 class="font-medium text-red-700 mb-2">Liquidez e Custos</h4>
                                <p class="text-sm text-red-600">Algumas operações podem ter custos mais altos e menor liquidez dependendo do ativo e da corretora utilizada.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8">
                    <h3 class="font-semibold text-lg mb-4">Como Começar a Investir no Exterior</h3>
                    <div class="grid md:grid-cols-3 gap-6">
                        <div class="border rounded-lg p-4 hover:shadow-md transition-shadow">
                            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 text-xl mb-3">
                                <i class="fas fa-university"></i>
                            </div>
                            <h4 class="font-medium mb-2">1. Escolha uma Corretora Internacional</h4>
                            <p class="text-sm text-gray-600">Selecione uma corretora confiável que ofereça acesso aos mercados internacionais, como Interactive Brokers, TD Ameritrade ou Avenue.</p>
                        </div>
                        <div class="border rounded-lg p-4 hover:shadow-md transition-shadow">
                            <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center text-green-600 text-xl mb-3">
                                <i class="fas fa-file-invoice-dollar"></i>
                            </div>
                            <h4 class="font-medium mb-2">2. Documentação Necessária</h4>
                            <p class="text-sm text-gray-600">Prepare documentos como passaporte, comprovante de residência e declaração de imposto de renda para abrir sua conta.</p>
                        </div>
                        <div class="border rounded-lg p-4 hover:shadow-md transition-shadow">
                            <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center text-purple-600 text-xl mb-3">
                                <i class="fas fa-exchange-alt"></i>
                            </div>
                            <h4 class="font-medium mb-2">3. Remessa Internacional</h4>
                            <p class="text-sm text-gray-600">Utilize serviços de câmbio como Remessa Online, Wise ou corretoras especializadas para enviar dinheiro para o exterior com taxas competitivas.</p>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8 p-4 bg-blue-50 border-l-4 border-blue-400 rounded-r">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-lightbulb text-blue-500 text-xl"></i>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-blue-800">Dica do Especialista</h3>
                            <div class="mt-2 text-sm text-blue-700">
                                <p>Comece com uma pequena porcentagem do seu patrimônio (5-10%) em investimentos internacionais e vá aumentando gradualmente conforme for se familiarizando com os processos e riscos.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Seção 8.2 -->
        <div id="cap8-2" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">8.2</span>
                ETFs Globais e Ações Internacionais
            </h2>
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <p class="mb-6">Os ETFs globais e as ações internacionais são as principais formas de expor sua carteira ao mercado externo, cada um com suas características e vantagens.</p>
                
                <div class="grid md:grid-cols-2 gap-8 my-8">
                    <div>
                        <h3 class="font-semibold text-lg mb-4">ETFs Globais</h3>
                        <p class="mb-4">Os ETFs (Exchange Traded Funds) globais são fundos de investimento negociados em bolsa que replicam índices de diversos países ou setores ao redor do mundo.</p>
                        
                        <div class="space-y-4">
                            <div class="p-4 border rounded-lg hover:shadow-md transition-shadow">
                                <h4 class="font-medium text-blue-700 mb-2">Vantagens dos ETFs Globais</h4>
                                <ul class="list-disc pl-5 space-y-1 text-sm text-gray-700">
                                    <li>Diversificação com um único investimento</li>
                                    <li>Baixas taxas de administração</li>
                                    <li>Liquidez geralmente alta</li>
                                    <li>Exposição a mercados de difícil acesso</li>
                                </ul>
                            </div>
                            
                            <div class="p-4 bg-blue-50 rounded-lg">
                                <h4 class="font-medium text-blue-800 mb-2">Exemplos de ETFs Globais Populares</h4>
                                <div class="space-y-3 mt-2">
                                    <div class="flex justify-between items-center">
                                        <span class="font-medium">VT</span>
                                        <span class="text-sm text-gray-600">Vanguard Total World Stock ETF</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="font-medium">VXUS</span>
                                        <span class="text-sm text-gray-600">Vanguard Total International Stock ETF</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="font-medium">IXUS</span>
                                        <span class="text-sm text-gray-600">iShares Core MSCI Total International Stock ETF</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="font-semibold text-lg mb-4">Ações Internacionais</h3>
                        <p class="mb-4">Investir diretamente em ações de empresas estrangeiras permite selecionar empresas específicas para sua carteira, mas exige mais conhecimento e acompanhamento.</p>
                        
                        <div class="space-y-4">
                            <div class="p-4 border rounded-lg hover:shadow-md transition-shadow">
                                <h4 class="font-medium text-blue-700 mb-2">Como Escolher Ações Internacionais</h4>
                                <ul class="list-disc pl-5 space-y-1 text-sm text-gray-700">
                                    <li>Analise os fundamentos da empresa</li>
                                    <li>Entenda o setor e o mercado de atuação</li>
                                    <li>Considere a exposição cambial</li>
                                    <li>Avalie a governança corporativa</li>
                                </ul>
                            </div>
                            
                            <div class="p-4 bg-green-50 rounded-lg">
                                <h4 class="font-medium text-green-800 mb-2">Empresas Globais para Considerar</h4>
                                <div class="grid grid-cols-2 gap-3 mt-2">
                                    <div class="flex items-center">
                                        <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 mr-2">
                                            <i class="fab fa-apple"></i>
                                        </div>
                                        <span class="text-sm font-medium">Apple (AAPL)</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center text-yellow-600 mr-2">
                                            <i class="fab fa-amazon"></i>
                                        </div>
                                        <span class="text-sm font-medium">Amazon (AMZN)</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-8 h-8 bg-blue-200 rounded-full flex items-center justify-center text-blue-800 mr-2">
                                            <i class="fab fa-microsoft"></i>
                                        </div>
                                        <span class="text-sm font-medium">Microsoft (MSFT)</span>
                                    </div>
                                    <div class="flex items-center">
                                        <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center text-green-600 mr-2">
                                            <i class="fas fa-robot"></i>
                                        </div>
                                        <span class="text-sm font-medium">Tesla (TSLA)</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8">
                    <h3 class="font-semibold text-lg mb-4">Comparação: ETFs vs Ações Individuais</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Característica</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ETFs Globais</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações Individuais</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Diversificação</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Alta (centenas de ativos)</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Baixa (depende do número de ações)</td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Risco</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Diluído entre vários ativos</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Concentrado em poucas empresas</td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Custos</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Taxas baixas (0,03% - 0,20% ao ano)</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Custos de corretagem por operação</td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Tempo de Gestão</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Baixo (gestão passiva)</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Alto (análise constante necessária)</td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Potencial de Retorno</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Médio (acompanha o mercado)</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Alto (seleção acertada de ações)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="mt-8 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded-r">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-exclamation-triangle text-yellow-500 text-xl"></i>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-yellow-800">Atenção</h3>
                            <div class="mt-2 text-sm text-yellow-700">
                                <p>Antes de investir em ações internacionais, esteja ciente das diferenças de horário de negociação, impostos sobre dividendos e eventuais taxas de custódia em moeda estrangeira.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Seção 8.3 -->
        <div id="cap8-3" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">8.3</span>
                REITs Internacionais e Ouro
            </h2>
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <p class="mb-6">Além de ações e ETFs, existem outras formas de diversificar internacionalmente, como os REITs (Fundos de Investimento Imobiliário) globais e o ouro, um ativo tradicionalmente visto como reserva de valor.</p>
                
                <div class="grid md:grid-cols-2 gap-8 my-8">
                    <!-- REITs Internacionais -->
                    <div>
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center text-purple-600 text-xl mr-3">
                                <i class="fas fa-building"></i>
                            </div>
                            <h3 class="font-semibold text-lg">REITs Internacionais</h3>
                        </div>
                        
                        <p class="mb-4 text-sm text-gray-700">Os REITs (Real Estate Investment Trusts) são fundos de investimento imobiliário que permitem investir em propriedades comerciais, shoppings, hospitais e outros empreendimentos ao redor do mundo, recebendo rendimentos através de aluguéis e valorização dos imóveis.</p>
                        
                        <div class="space-y-3">
                            <div class="p-3 bg-purple-50 rounded-lg">
                                <h4 class="font-medium text-purple-800 mb-1">Vantagens dos REITs Globais</h4>
                                <ul class="list-disc pl-5 text-sm text-gray-700">
                                    <li>Exposição ao mercado imobiliário internacional</li>
                                    <li>Rendimentos regulares através de dividendos</li>
                                    <li>Baixa correlação com ações em alguns mercados</li>
                                    <li>Gestão profissional das propriedades</li>
                                </ul>
                            </div>
                            
                            <div class="p-3 bg-white border border-gray-200 rounded-lg">
                                <h4 class="font-medium text-gray-800 mb-2">Exemplos de REITs Globais</h4>
                                <div class="space-y-2">
                                    <div class="flex justify-between items-center text-sm">
                                        <span class="font-medium">PLD</span>
                                        <span class="text-gray-600">Prologis (armazéns logísticos)</span>
                                    </div>
                                    <div class="flex justify-between items-center text-sm">
                                        <span class="font-medium">AMT</span>
                                        <span class="text-gray-600">American Tower (torres de telecomunicações)</span>
                                    </div>
                                    <div class="flex justify-between items-center text-sm">
                                        <span class="font-medium">O</span>
                                        <span class="text-gray-600">Realty Income (lojas de varejo)</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ouro -->
                    <div>
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center text-yellow-600 text-xl mr-3">
                                <i class="fas fa-coins"></i>
                            </div>
                            <h3 class="font-semibold text-lg">Ouro como Investimento Global</h3>
                        </div>
                        
                        <p class="mb-4 text-sm text-gray-700">O ouro é considerado um ativo de refúgio em momentos de crise e incerteza econômica, servindo como proteção contra a desvalorização de moedas e inflação.</p>
                        
                        <div class="space-y-3">
                            <div class="p-3 bg-yellow-50 rounded-lg">
                                <h4 class="font-medium text-yellow-800 mb-1">Formas de Investir em Ouro</h4>
                                <ul class="list-disc pl-5 text-sm text-gray-700">
                                    <li><strong>Físico:</strong> Barras e moedas (ex: Krugerrand, Canadian Maple Leaf)</li>
                                    <li><strong>ETFs:</strong> Como GLD, IAU, OURO11 (Brasil)</li>
                                    <li><strong>Contratos Futuros:</strong> Negociados em bolsas de mercadorias</li>
                                    <li><strong>Ações de Mineradoras:</strong> Como NEM, GOLD, VALE3</li>
                                </ul>
                            </div>
                            
                            <div class="p-3 bg-white border border-gray-200 rounded-lg">
                                <h4 class="font-medium text-gray-800 mb-2">Vantagens do Ouro</h4>
                                <div class="grid grid-cols-2 gap-2 text-sm">
                                    <div class="p-2 bg-gray-50 rounded">
                                        <div class="font-medium text-green-600">✓ Proteção</div>
                                        <div class="text-xs text-gray-500">Contra inflação e crises</div>
                                    </div>
                                    <div class="p-2 bg-gray-50 rounded">
                                        <div class="font-medium text-green-600">✓ Liquidez</div>
                                        <div class="text-xs text-gray-500">Fácil conversão em dinheiro</div>
                                    </div>
                                    <div class="p-2 bg-gray-50 rounded">
                                        <div class="font-medium text-green-600">✓ Aceitação</div>
                                        <div class="text-xs text-gray-500">Universalmente valorizado</div>
                                    </div>
                                    <div class="p-2 bg-gray-50 rounded">
                                        <div class="font-medium text-green-600">✓ Diversificação</div>
                                        <div class="text-xs text-gray-500">Baixa correlação com ações</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8">
                    <h3 class="font-semibold text-lg mb-4">Considerações sobre Tributação</h3>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <div class="grid md:grid-cols-2 gap-6">
                            <div>
                                <h4 class="font-medium text-gray-800 mb-2">REITs Internacionais</h4>
                                <ul class="list-disc pl-5 space-y-1 text-sm text-gray-700">
                                    <li>Nos EUA, há retenção de 30% sobre dividendos para estrangeiros</li>
                                    <li>No Brasil, os rendimentos são tributados como renda variável</li>
                                    <li>É necessário declarar no Carnê Leão ou DIRPF</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-medium text-gray-800 mb-2">Ouro</h4>
                                <ul class="list-disc pl-5 space-y-1 text-sm text-gray-700">
                                    <li>No Brasil, ouro como ativo financeiro tem isenção de IOF e IR para vendas abaixo de R$35.000 por mês</li>
                                    <li>Para valores superiores, incide 15% de IR sobre o ganho de capital</li>
                                    <li>Ouro físico tem incidência de ICMS na compra</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8 p-4 bg-blue-50 border-l-4 border-blue-400 rounded-r">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-lightbulb text-blue-500 text-xl"></i>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-blue-800">Estratégia Recomendada</h3>
                            <div class="mt-2 text-sm text-blue-700">
                                <p>Considere alocar de 5% a 15% do seu portfólio em ouro e REITs internacionais como forma de diversificação e proteção. Lembre-se que esses ativos devem complementar, e não substituir, uma carteira diversificada de ações e títulos.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Seção 8.4 -->
        <div id="cap8-4" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">8.4</span>
                Tributação e Estratégias de Investimento Internacional
            </h2>
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <p class="mb-6">Entender a tributação e desenvolver estratégias eficientes são passos essenciais para quem deseja investir no exterior de forma otimizada e em conformidade com a legislação.</p>
                
                <div class="mb-8">
                    <h3 class="font-semibold text-lg mb-4">Tributação de Investimentos no Exterior</h3>
                    
                    <div class="grid md:grid-cols-2 gap-6 mb-8">
                        <div class="border rounded-lg overflow-hidden">
                            <div class="bg-blue-600 text-white px-4 py-2 font-medium">Imposto de Renda (Brasil)</div>
                            <div class="p-4">
                                <ul class="space-y-2 text-sm">
                                    <li class="flex items-start">
                                        <span class="text-blue-600 mr-2">•</span>
                                        <span>Até R$ 5 milhões: Isento (isenção para PF até 2023)</span>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="text-blue-600 mr-2">•</span>
                                        <span>Acima de R$ 5 milhões: 15% sobre o ganho de capital</span>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="text-blue-600 mr-2">•</span>
                                        <span>Dividendos: Isentos (mas podem ter retenção na fonte no exterior)</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="border rounded-lg overflow-hidden">
                            <div class="bg-green-600 text-white px-4 py-2 font-medium">Países Mais Comuns</div>
                            <div class="p-4">
                                <div class="space-y-3">
                                    <div>
                                        <h4 class="font-medium text-gray-800">Estados Unidos</h4>
                                        <p class="text-xs text-gray-600">30% de retenção em dividendos (pode ser reduzido para 15% com formulário W-8BEN)</p>
                                    </div>
                                    <div>
                                        <h4 class="font-medium text-gray-800">Europa</h4>
                                        <p class="text-xs text-gray-600">Varia por país (15-35%), com possibilidade de redução por tratados</p>
                                    </div>
                                    <div>
                                        <h4 class="font-medium text-gray-800">Japão e Outros</h4>
                                        <p class="text-xs text-gray-600">Taxas específicas por país, geralmente entre 10-20%</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r mb-8">
                        <div class="flex">
                            <div class="flex-shrink-0">
                                <i class="fas fa-exclamation-circle text-yellow-500"></i>
                            </div>
                            <div class="ml-3
                            ">
                                <h3 class="text-sm font-medium text-yellow-800">Atenção à Legislação</h3>
                                <div class="mt-2 text-sm text-yellow-700">
                                    <p>O Brasil tem acordo para evitar bitributação com vários países, o que pode reduzir a carga tributária. Consulte sempre um contador especializado em investimentos internacionais.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mb-8">
                    <h3 class="font-semibold text-lg mb-4">Estratégias de Investimento Internacional</h3>
                    
                    <div class="grid md:grid-cols-3 gap-6 mb-6">
                        <div class="border rounded-lg p-4 hover:shadow-md transition-shadow">
                            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 text-xl mb-3 mx-auto">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <h4 class="font-medium text-center mb-2">Diversificação Geográfica</h4>
                            <p class="text-sm text-gray-600 text-center">Distribua seus investimentos por diferentes regiões para reduzir riscos específicos de cada país.</p>
                        </div>
                        
                        <div class="border rounded-lg p-4 hover:shadow-md transition-shadow">
                            <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center text-green-600 text-xl mb-3 mx-auto">
                                <i class="fas fa-coins"></i>
                            </div>
                            <h4 class="font-medium text-center mb-2">Hedge Cambial</h4>
                            <p class="text-sm text-gray-600 text-center">Mantenha parte de seus investimentos em moedas fortes para se proteger contra a desvalorização do Real.</p>
                        </div>
                        
                        <div class="border rounded-lg p-4 hover:shadow-md transition-shadow">
                            <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center text-purple-600 text-xl mb-3 mx-auto">
                                <i class="fas fa-piggy-bank"></i>
                            </div>
                            <h4 class="font-medium text-center mb-2">Aproveitar Vantagens Fiscais</h4>
                            <p class="text-sm text-gray-600 text-center">Considere investir através de jurisdições com benefícios fiscais, como Irlanda ou Luxemburgo.</p>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-medium text-gray-800 mb-3">Exemplo de Alocação Internacional</h4>
                        <div class="space-y-3">
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span>Estados Unidos</span>
                                    <span class="font-medium">50%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-blue-600 h-2 rounded-full" style="width: 50%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span>Europa</span>
                                    <span class="font-medium">20%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-green-600 h-2 rounded-full" style="width: 20%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span>Mercados Emergentes</span>
                                    <span class="font-medium">15%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-yellow-500 h-2 rounded-full" style="width: 15%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span>Ásia-Pacífico</span>
                                    <span class="font-medium">10%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-red-500 h-2 rounded-full" style="width: 10%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span>Outros</span>
                                    <span class="font-medium">5%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-purple-500 h-2 rounded-full" style="width: 5%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg">
                    <h3 class="font-semibold text-lg mb-4 text-center">Checklist para Começar a Investir no Exterior</h3>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="flex items-start">
                            <div class="flex-shrink-0 mt-1">
                                <div class="flex items-center justify-center h-5 w-5 rounded-full bg-blue-100">
                                    <svg class="h-3 w-3 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                    </svg>
                                </div>
                            </div>
                            <p class="ml-3 text-sm text-gray-700">Defina seus objetivos e horizonte de investimento</p>
                        </div>
                        <div class="flex items-start">
                            <div class="flex-shrink-0 mt-1">
                                <div class="flex items-center justify-center h-5 w-5 rounded-full bg-blue-100">
                                    <svg class="h-3 w-3 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                    </svg>
                                </div>
                            </div>
                            <p class="ml-3 text-sm text-gray-700">Escolha uma corretora internacional confiável</p>
                        </div>
                        <div class="flex items-start">
                            <div class="flex-shrink-0 mt-1">
                                <div class="flex items-center justify-center h-5 w-5 rounded-full bg-blue-100">
                                    <svg class="h-3 w-3 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                    </svg>
                                </div>
                            </div>
                            <p class="ml-3 text-sm text-gray-700">Entenda os custos envolvidos (câmbio, corretagem, custódia)</p>
                        </div>
                        <div class="flex items-start">
                            <div class="flex-shrink-0 mt-1">
                                <div class="flex items-center justify-center h-5 w-5 rounded-full bg-blue-100">
                                    <svg class="h-3 w-3 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                    </svg>
                                </div>
                            </div>
                            <p class="ml-3 text-sm text-gray-700">Diversifique por setores, países e moedas</p>
                        </div>
                        <div class="flex items-start">
                            <div class="flex-shrink-0 mt-1">
                                <div class="flex items-center justify-center h-5 w-5 rounded-full bg-blue-100">
                                    <svg class="h-3 w-3 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                    </svg>
                                </div>
                            </div>
                            <p class="ml-3 text-sm text-gray-700">Monitore regularmente seus investimentos</p>
                        </div>
                        <div class="flex items-start">
                            <div class="flex-shrink-0 mt-1">
                                <div class="flex items-center justify-center h-5 w-5 rounded-full bg-blue-100">
                                    <svg class="h-3 w-3 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                    </svg>
                                </div>
                            </div>
                            <p class="ml-3 text-sm text-gray-700">Mantenha-se atualizado sobre mudanças regulatórias e tributárias</p>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8 p-4 bg-green-50 border-l-4 border-green-500 rounded-r">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-check-circle text-green-500 text-xl"></i>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-green-800">Próximos Passos</h3>
                            <div class="mt-2 text-sm text-green-700">
                                <p>Agora que você já conhece as possibilidades de investimento no exterior, comece definindo sua estratégia e alocação de ativos. Lembre-se que o importante é começar com o que cabe no seu orçamento e ir aumentando sua exposição internacional gradualmente.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Seção 8.5 - Simulador de Alocação de Ativos -->
        <div id="cap8-5" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">8.5</span>
                Simulador de Alocação de Ativos
            </h2>
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <p class="mb-6">Use este simulador para planejar sua alocação de ativos entre diferentes classes de investimento. Ajuste os valores para ver como diferentes alocações podem afetar o risco e retorno esperado da sua carteira.</p>
                
                <div class="grid md:grid-cols-3 gap-8">
                    <div class="md:col-span-2">
                        <div class="space-y-6">
                            <!-- Ações Nacionais -->
                            <div>
                                <div class="flex justify-between mb-2">
                                    <label for="acoes-br" class="text-sm font-medium text-gray-700">Ações Nacionais</label>
                                    <span id="acoes-br-value" class="text-sm text-gray-600">30%</span>
                                </div>
                                <input type="range" id="acoes-br" min="0" max="100" value="30" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                            
                            <!-- Ações Internacionais -->
                            <div>
                                <div class="flex justify-between mb-2">
                                    <label for="acoes-int" class="text-sm font-medium text-gray-700">Ações Internacionais</label>
                                    <span id="acoes-int-value" class="text-sm text-gray-600">30%</span>
                                </div>
                                <input type="range" id="acoes-int" min="0" max="100" value="30" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                            
                            <!-- Renda Fixa -->
                            <div>
                                <div class="flex justify-between mb-2">
                                    <label for="renda-fixa" class="text-sm font-medium text-gray-700">Renda Fixa</label>
                                    <span id="renda-fixa-value" class="text-sm text-gray-600">30%</span>
                                </div>
                                <input type="range" id="renda-fixa" min="0" max="100" value="30" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                            
                            <!-- Criptomoedas -->
                            <div>
                                <div class="flex justify-between mb-2">
                                    <label for="cripto" class="text-sm font-medium text-gray-700">Criptomoedas</label>
                                    <span id="cripto-value" class="text-sm text-gray-600">10%</span>
                                </div>
                                <input type="range" id="cripto" min="0" max="100" value="10" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                            
                            <!-- Total -->
                            <div class="pt-4 mt-4 border-t border-gray-200">
                                <div class="flex justify-between items-center">
                                    <span class="text-sm font-medium text-gray-900">Total Alocado</span>
                                    <span id="total-alocado" class="px-3 py-1 text-sm font-bold rounded-full">100%</span>
                                </div>
                                <div id="alocacao-aviso" class="mt-1 text-xs text-red-600 hidden">A soma deve ser igual a 100%</div>
                            </div>
                        </div>
                        
                        <button id="aplicar-alocacao" class="mt-6 w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200">
                            Aplicar Alocação
                        </button>
                    </div>
                    
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-semibold text-lg mb-4">Sua Carteira</h3>
                        <div class="h-64 flex items-center justify-center">
                            <canvas id="alocacao-chart"></canvas>
                        </div>
                        <div id="risco-retorno" class="mt-6 p-4 bg-white rounded-lg border border-gray-200">
                            <h4 class="font-medium text-gray-900 mb-2">Perfil de Risco</h4>
                            <div class="w-full bg-gray-200 rounded-full h-2.5 mb-4">
                                <div id="barra-risco" class="bg-gradient-to-r from-green-500 via-yellow-500 to-red-500 h-2.5 rounded-full" style="width: 50%"></div>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <div class="text-xs text-gray-500">Risco</div>
                                    <div id="nivel-risco" class="font-medium">Moderado</div>
                                </div>
                                <div>
                                    <div class="text-xs text-gray-500">Retorno Esperado</div>
                                    <div id="retorno-esperado" class="font-medium">7-9% a.a.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="dicas-alocacao" class="mt-8 p-4 bg-blue-50 border-l-4 border-blue-500 rounded-r hidden">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-lightbulb text-blue-500 text-xl"></i>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-blue-800">Dicas de Alocação</h3>
                            <div id="dicas-conteudo" class="mt-2 text-sm text-blue-700">
                                <!-- Dicas serão inseridas aqui via JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Seção 8.6 - Comparador de Corretoras Internacionais -->
        <div id="cap8-6" class="mb-12">
            <h2 class="text-2xl font-serif font-bold text-primary-700 mb-6 flex items-center">
                <span class="inline-block w-8 h-8 bg-accent-500 text-white rounded-full flex items-center justify-center mr-3 text-sm">8.6</span>
                Comparador de Corretoras Internacionais
            </h2>
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <p class="mb-6">Compare as principais corretoras internacionais para encontrar a que melhor atende ao seu perfil de investidor e objetivos financeiros.</p>
                
                <div class="mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                        <div>
                            <label for="pais" class="block text-sm font-medium text-gray-700 mb-1">País de Residência</label>
                            <select id="pais" class="w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                <option value="">Selecione</option>
                                <option value="BR">Brasil</option>
                                <option value="PT">Portugal</option>
                                <option value="US">Estados Unidos</option>
                                <option value="UK">Reino Unido</option>
                            </select>
                        </div>
                        <div>
                            <label for="valor" class="block text-sm font-medium text-gray-700 mb-1">Valor para Investir</label>
                            <div class="relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 sm:text-sm">$</span>
                                </div>
                                <input type="text" id="valor" class="focus:ring-blue-500 focus:border-blue-500 block w-full pl-7 pr-12 sm:text-sm border-gray-300 rounded-md" placeholder="0.00">
                                <div class="absolute inset-y-0 right-0 flex items-center">
                                    <select class="focus:ring-blue-500 focus:border-blue-500 h-full py-0 pl-2 pr-7 border-transparent bg-transparent text-gray-500 sm:text-sm rounded-md">
                                        <option>USD</option>
                                        <option>BRL</option>
                                        <option>EUR</option>
                                        <option>GBP</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Ativos de Interesse</label>
                            <div class="mt-1">
                                <select multiple class="w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 h-[42px] overflow-hidden">
                                    <option>Ações EUA</option>
                                    <option>ETFs Globais</option>
                                    <option>REITs</option>
                                    <option>Fundos Imobiliários</option>
                                    <option>Opções</option>
                                    <option>Futuros</option>
                                </select>
                            </div>
                        </div>
                        <div class="flex items-end">
                            <button id="filtrar-corretoras" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200">
                                Filtrar
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Corretora</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Taxas</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Atendimento</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Plataforma</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Avaliação</th>
                                <th scope="col" class="relative px-6 py-3">
                                    <span class="sr-only">Ações</span>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="tabela-corretoras" class="bg-white divide-y divide-gray-200">
                            <!-- Dados serão inseridos via JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <div id="sem-resultados" class="mt-8 text-center py-12 bg-gray-50 rounded-lg hidden">
                    <i class="fas fa-search text-gray-400 text-4xl mb-4"></i>
                    <h3 class="text-lg font-medium text-gray-900">Nenhuma corretora encontrada</h3>
                    <p class="mt-1 text-sm text-gray-500">Tente ajustar os filtros para encontrar a corretora ideal para você.</p>
                </div>
                
                <div class="mt-8 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded-r">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-exclamation-triangle text-yellow-500 text-xl"></i>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-yellow-800">Importante</h3>
                            <div class="mt-2 text-sm text-yellow-700">
                                <p>As informações fornecidas são apenas para fins educacionais e não constituem recomendações de investimento. Faça sua própria pesquisa antes de abrir uma conta em qualquer corretora.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Capítulo 9: Questionários e Jogos de Investimento -->
    <div id="cap9" class="mt-12 sm:mt-16">
        <div class="w-full mx-auto px-2 sm:px-6 lg:px-10 xl:px-16 2xl:px-24">
            <div class="bg-white shadow rounded-lg p-3 sm:p-6">
                <div class="flex items-center mb-4 sm:mb-6">
                    <div class="w-9 h-9 sm:w-10 sm:h-10 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center mr-3">
                        <i class="fas fa-gamepad text-sm sm:text-base"></i>
                    </div>
                    <h2 class="text-xl sm:text-2xl font-bold text-gray-900 leading-snug">Capítulo 9 — Questionários e Jogos de Investimento</h2>
                </div>

                <!-- Tabs -->
                <div class="border-b border-gray-200 mb-4 sm:mb-6">
                    <div class="-mb-px overflow-x-auto">
                        <nav class="flex space-x-6 sm:space-x-8 min-w-max px-1" aria-label="Tabs">
                            <button class="tab-button flex-none border-b-2 border-blue-500 text-blue-600 whitespace-nowrap py-3 sm:py-4 px-2 sm:px-1 text-xs sm:text-sm font-medium" data-tab="quiz">Quiz</button>
                            <button class="tab-button flex-none border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-3 sm:py-4 px-2 sm:px-1 text-xs sm:text-sm font-medium" data-tab="simulador">Simuladores</button>
                            <button class="tab-button flex-none border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-3 sm:py-4 px-2 sm:px-1 text-xs sm:text-sm font-medium" data-tab="desafios">Desafios</button>
                            <button class="tab-button flex-none border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-3 sm:py-4 px-2 sm:px-1 text-xs sm:text-sm font-medium" data-tab="flashcards">Flashcards</button>
                        </nav>
                    </div>
                </div>

                <!-- Conteúdo das Abas -->
                <div id="quiz-content">
                    <h3 class="text-base sm:text-lg font-semibold text-gray-900 mb-2">🧠 Teste seu conhecimento: ETFs</h3>
                    <p class="text-xs sm:text-sm text-gray-600 mb-3 sm:mb-4">Responda as perguntas abaixo para verificar seu aprendizado:</p>

                    <div id="etf-quiz-container" class="space-y-8">
                        <!-- Populado via JavaScript (inicializarQuiz) -->
                    </div>

                    <div class="mt-4 sm:mt-6 pt-3 sm:pt-4 border-t border-gray-200 flex flex-col sm:flex-row gap-3 sm:gap-0 sm:justify-between sm:items-center">
                        <button id="etf-verificar-respostas" class="w-full sm:w-auto bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-4 rounded-md transition-colors duration-200">
                            Verificar Respostas
                        </button>
                        <div id="etf-resultado-quiz" class="text-sm font-medium"></div>
                    </div>
                </div>

                <div id="simulador-content" class="hidden">
                    <h3 class="text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4">🧮 Simuladores</h3>
                    <div class="grid gap-4 sm:gap-6">
                        <!-- Juros Compostos -->
                        <section class="p-4 border rounded-lg bg-gray-50">
                            <h4 class="font-semibold text-gray-800 mb-3">Juros Compostos</h4>
                            <div class="flex flex-wrap gap-2 text-xs mb-3" role="tablist">
                                <button class="px-3 py-1 rounded bg-blue-600 text-white" data-jc-tab="unico">Aporte Único</button>
                                <button class="px-3 py-1 rounded bg-gray-200" data-jc-tab="mensal">Aportes Mensais</button>
                            </div>
                            <div data-jc-pane="unico">
                                <div class="grid sm:grid-cols-4 gap-3">
                                    <input class="border rounded px-3 py-2 text-sm" type="number" step="0.01" placeholder="Capital (R$)" id="jc_c">
                                    <input class="border rounded px-3 py-2 text-sm" type="number" step="0.0001" placeholder="Taxa (% a.m.)" id="jc_i">
                                    <input class="border rounded px-3 py-2 text-sm" type="number" placeholder="Meses" id="jc_n">
                                    <button class="bg-blue-600 text-white rounded px-4 py-2" id="jc_calc_unico">Calcular</button>
                                </div>
                                <div class="mt-3 text-sm" id="jc_out_unico"></div>
                            </div>
                            <div data-jc-pane="mensal" class="hidden">
                                <div class="grid sm:grid-cols-5 gap-3">
                                    <input class="border rounded px-3 py-2 text-sm" type="number" step="0.01" placeholder="Aporte mensal (R$)" id="jcm_p">
                                    <input class="border rounded px-3 py-2 text-sm" type="number" step="0.01" placeholder="Meses" id="jcm_n">
                                    <input class="border rounded px-3 py-2 text-sm" type="number" step="0.0001" placeholder="Taxa (% a.m.)" id="jcm_i">
                                    <input class="border rounded px-3 py-2 text-sm" type="number" step="0.01" placeholder="Inicial (R$)" id="jcm_c" value="0">
                                    <button class="bg-blue-600 text-white rounded px-4 py-2" id="jc_calc_mensal">Calcular</button>
                                </div>
                                <div class="mt-3 text-sm" id="jc_out_mensal"></div>
                            </div>
                        </section>

                        <!-- Reserva de Emergência -->
                        <section class="p-4 border rounded-lg bg-gray-50">
                            <h4 class="font-semibold text-gray-800 mb-3">Reserva de Emergência</h4>
                            <div class="grid sm:grid-cols-5 gap-3">
                                <input class="border rounded px-3 py-2 text-sm" type="number" step="0.01" placeholder="Gastos mensais (R$)" id="re_gasto">
                                <input class="border rounded px-3 py-2 text-sm" type="number" placeholder="Meses alvo" id="re_meses" value="6">
                                <input class="border rounded px-3 py-2 text-sm" type="number" step="0.0001" placeholder="Taxa (% a.m.)" id="re_i" value="0.6">
                                <input class="border rounded px-3 py-2 text-sm" type="number" step="0.01" placeholder="Aporte mensal (R$)" id="re_aporte" value="0">
                                <button class="bg-emerald-600 text-white rounded px-4 py-2" id="re_calc">Calcular</button>
                            </div>
                            <div class="mt-3 text-sm" id="re_out"></div>
                        </section>

                        <!-- Nominal x Real -->
                        <section class="p-4 border rounded-lg bg-gray-50">
                            <h4 class="font-semibold text-gray-800 mb-3">Comparador: Taxa Nominal x Real</h4>
                            <div class="grid sm:grid-cols-4 gap-3">
                                <input class="border rounded px-3 py-2 text-sm" type="number" step="0.01" placeholder="Nominal (% a.a.)" id="tx_nom">
                                <input class="border rounded px-3 py-2 text-sm" type="number" step="0.01" placeholder="Inflação (% a.a.)" id="tx_inf">
                                <button class="bg-indigo-600 text-white rounded px-4 py-2" id="tx_calc">Calcular</button>
                                <div class="text-sm" id="tx_out"></div>
                            </div>
                        </section>
                    </div>
                </div>

                <div id="desafios-content" class="hidden">
                    <h3 class="text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4">🎯 Desafios</h3>
                    <div class="grid gap-3 sm:gap-4 sm:grid-cols-2">
                        <div class="p-3 sm:p-4 border rounded-lg">
                            <h4 class="font-medium text-gray-800 mb-2">Desafio: Montar Carteira Equilibrada</h4>
                            <p class="text-sm text-gray-600 mb-3">Monte uma carteira com 100% de alocação usando o simulador e alcance perfil Moderado.</p>
                            <button class="text-blue-600 text-sm hover:underline" onclick="document.querySelector('#cap8')?.scrollIntoView({behavior:'smooth'});">Abrir simulador</button>
                        </div>
                        <div class="p-3 sm:p-4 border rounded-lg">
                            <h4 class="font-medium text-gray-800 mb-2">Flashcards (em breve)</h4>
                            <p class="text-sm text-gray-600">Revise conceitos chave com cartões de estudo interativos.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Capítulo 10 -->
    <div id="cap10" class="page p-12">
        <div class="mb-8">
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                <div>
                    <span class="inline-block px-3 py-1 bg-primary-100 text-primary-800 text-sm font-medium rounded-full mb-2">Capítulo 10</span>
                    <h1 class="text-3xl font-serif font-bold text-primary-800 mb-2">Conclusão e Próximos Passos</h1>
                    <p class="text-lg text-gray-700 leading-relaxed">Parabéns por chegar até aqui! Nesta conclusão, você consolida os principais aprendizados e define ações práticas para evoluir no seu plano de investimentos.</p>
                </div>
            </div>
        </div>

        <div class="grid md:grid-cols-3 gap-6">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="font-semibold text-lg mb-3 flex items-center">
                    <i class="fas fa-clipboard-check text-green-600 mr-2"></i>
                    Resumo do Guia
                </h2>
                <ul class="list-disc list-inside text-sm text-gray-700 space-y-2">
                    <li>Fundamentos, Renda Fixa e Renda Variável</li>
                    <li>Fundos de Investimento e Fundos Imobiliários</li>
                    <li>ETFs, Planejamento Financeiro e Exterior</li>
                    <li>Questionários e ferramentas de estudo</li>
                </ul>
            </div>

            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="font-semibold text-lg mb-3 flex items-center">
                    <i class="fas fa-tasks text-blue-600 mr-2"></i>
                    Seus Próximos Passos
                </h2>
                <ol class="list-decimal list-inside text-sm text-gray-700 space-y-2">
                    <li>Defina metas e prazos claros</li>
                    <li>Monte sua carteira inicial diversificada</li>
                    <li>Automatize aportes mensais</li>
                    <li>Revise sua alocação trimestralmente</li>
                </ol>
                <div class="mt-4 p-4 bg-blue-50 rounded-lg">
                    <p class="text-sm text-blue-700">Dica: registre suas decisões e mantenha um diário de investimentos.</p>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="font-semibold text-lg mb-3 flex items-center">
                    <i class="fas fa-tools text-purple-600 mr-2"></i>
                    Ferramentas Úteis
                </h2>
                <div class="space-y-3">
                    <a href="recursos.html#planejador" class="flex items-center p-3 border rounded-lg hover:bg-gray-50 transition-colors">
                        <i class="fas fa-bullseye text-xl text-blue-500 w-8"></i>
                        <span class="ml-3">Planejador de Metas</span>
                    </a>
                    <a href="recursos.html#controle" class="flex items-center p-3 border rounded-lg hover:bg-gray-50 transition-colors">
                        <i class="fas fa-file-excel text-xl text-green-500 w-8"></i>
                        <span class="ml-3">Controle de Aportes</span>
                    </a>
                    <a href="recursos.html#portfolio" class="flex items-center p-3 border rounded-lg hover:bg-gray-50 transition-colors">
                        <i class="fas fa-chart-pie text-xl text-purple-500 w-8"></i>
                        <span class="ml-3">Portfolio Tracker</span>
                    </a>
                </div>
            </div>
        </div>

        <div class="mt-10 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg p-6 sm:p-8 flex flex-col sm:flex-row items-center justify-between gap-4">
            <div>
                <h3 class="text-2xl font-serif font-bold">Hora de Colocar em Prática</h3>
                <p class="opacity-90">Baixe os materiais, defina seu plano e acompanhe sua evolução mês a mês.</p>
            </div>
            <div class="w-full sm:w-auto grid grid-cols-1 sm:grid-cols-2 gap-3">
                <a id="downloadPDFBottom" href="#" class="inline-flex items-center justify-center px-5 py-3 bg-white text-blue-700 font-medium rounded-md hover:bg-blue-50 transition-colors">
                    <i class="fas fa-file-pdf mr-2"></i> Baixar PDF
                </a>
                <a href="#cap1" class="inline-flex items-center justify-center px-5 py-3 bg-blue-700/20 text-white font-medium rounded-md hover:bg-blue-700/30 transition-colors">
                    <i class="fas fa-redo mr-2"></i> Reiniciar Guia
                </a>
            </div>
        </div>
    </div>

    <!-- Floating Quick Actions -->
    <div class="fixed bottom-6 right-6 z-30 space-y-3">
        <a href="#top" onclick="window.scrollTo({top:0,behavior:'smooth'})" class="flex items-center justify-center w-12 h-12 rounded-full shadow bg-blue-600 text-white hover:bg-blue-700" title="Voltar ao topo">
            <i class="fas fa-arrow-up"></i>
        </a>
        <a href="recursos.html" class="flex items-center justify-center w-12 h-12 rounded-full shadow bg-emerald-600 text-white hover:bg-emerald-700" title="Abrir Recursos">
            <i class="fas fa-toolbox"></i>
        </a>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/tippy.js@6/dist/tippy-bundle.umd.js"></script>
    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Flag para desativar tooltips avançados se causarem erro
        const DISABLE_ENHANCED_TOOLTIPS = true;

        // Dados dos tópicos
        const topicData = {
            // Capítulo 1: Introdução aos Investimentos
            'introducao-investimentos': {
                id: 'introducao-investimentos',
                title: 'Introdução aos Investimentos',
                summary: `
                    <div class="prose max-w-none">
                        <p>Investir é alocar recursos financeiros com a expectativa de obter ganhos no futuro. É uma forma de fazer seu dinheiro trabalhar para você, gerando renda passiva e construindo riqueza ao longo do tempo.</p>
                        <p class="mt-4 font-medium">Neste capítulo, você aprenderá:</p>
                        <ul class="list-disc pl-5 mt-2 space-y-2">
                            <li>O que são investimentos e por que são importantes</li>
                            <li>Diferença entre poupar e investir</li>
                            <li>Conceitos fundamentais: juros compostos, liquidez e diversificação</li>
                            <li>Como começar a investir com pouco dinheiro</li>
                        </ul>
                    </div>
                `,
                mindMap: 'https://placehold.co/800x400?text=Mapa+Introdu%C3%A7%C3%A3o+%C3%A0s+Investimentos',
                quotes: [
                    {
                        text: "Não guarde o que sobra depois de gastar, gaste o que sobra depois de guardar.",
                        author: "Warren Buffett"
                    },
                    {
                        text: "O hábito de economizar é em si mesmo uma educação; estimula cada virtude, ensina abnegação, consolida a ordem mental, acalma a inquietação e ajuda a crescer na direção de objetivos valiosos.",
                        author: "T. T. Munger"
                    }
                ],
                resources: [
                    {
                        title: 'Planejador de Metas',
                        url: 'recursos.html#planejador',
                        type: 'planner',
                        icon: 'bullseye'
                    },
                    {
                        title: 'Controle de Aportes',
                        url: 'recursos.html#controle',
                        type: 'spreadsheet',
                        icon: 'file-excel'
                    }
                ],
                quiz: [
                    {
                        question: "Qual a principal diferença entre poupar e investir?",
                        options: [
                            "Não há diferença, são a mesma coisa",
                            "Poupar é guardar dinheiro, investir é fazer o dinheiro render",
                            "Investir é mais arriscado que poupar",
                            "Poupar é para curto prazo, investir para longo prazo"
                        ],
                        answer: 1,
                        explanation: "Poupar significa guardar dinheiro, enquanto investir é aplicar esse dinheiro para que ele gere retorno ao longo do tempo."
                    },
                    {
                        question: "O que são juros compostos?",
                        options: [
                            "Juros calculados apenas sobre o valor inicial",
                            "Juros sobre juros, onde os rendimentos são reinvestidos",
                            "Uma forma de empréstimo bancário",
                            "Um tipo de investimento de renda fixa"
                        ],
                        answer: 1,
                        explanation: "Juros compostos são os juros calculados sobre o valor inicial mais os juros acumulados, criando um efeito de crescimento exponencial."
                    }
                ],
                flashcards: [
                    {
                        front: "O que é liquidez?",
                        back: "Facilidade com que um investimento pode ser convertido em dinheiro sem perda significativa de valor."
                    },
                    {
                        front: "O que significa diversificação?",
                        back: "Estratégia de distribuir os investimentos por diferentes tipos de ativos para reduzir riscos."
                    }
                ],
                curiosities: [
                    'O termo "portfólio" vem do italiano portafoglio, que significava uma pasta para carregar documentos.',
                    'Pequenos aportes regulares podem superar grandes aportes esporádicos graças aos juros compostos.'
                ],
                exercises: [
                    {
                        question: 'Liste 3 objetivos financeiros e classifique-os em curto, médio e longo prazos.',
                        answer: 'Ex.: curto: montar reserva; médio: entrada do imóvel; longo: aposentadoria.',
                        explanation: 'A classificação ajuda a escolher produtos com prazos e riscos adequados a cada meta.'
                    },
                    {
                        question: 'Calcule o aporte mensal necessário para atingir R$ 50.000 em 5 anos a 0,7% a.m.',
                        answer: 'Aprox. R$ 566/mês.',
                        explanation: 'Usando fórmula de série uniforme: PMT = FV * i / ((1+i)^n - 1). Para i=0,007 e n=60, PMT≈50000*0,007/((1,007)^60-1).'
                    }
                ],
                faq: [
                    { q: 'Preciso de muito dinheiro para começar?', a: 'Não. É possível começar com valores baixos em produtos como Tesouro Direto e ETFs fracionados.' },
                    { q: 'Posso perder todo meu dinheiro?', a: 'Risco existe, mas pode ser mitigado com diversificação, horizonte de longo prazo e produtos adequados ao seu perfil.' }
                ],
                progress: 0, // 0 a 100
                lastStudied: null,
                notes: ''
            },
            // Capítulo 2: Renda Fixa
            'renda-fixa': {
                id: 'renda-fixa',
                title: 'Renda Fixa',
                summary: `
                    <div class="prose max-w-none">
                        <p>Investimentos em renda fixa são aqueles em que a rentabilidade pode ser conhecida no momento da aplicação ou ao longo do tempo.</p>
                        <p class="mt-4 font-medium">Neste capítulo, você aprenderá sobre:</p>
                        <ul class="list-disc pl-5 mt-2 space-y-2">
                            <li>O que são títulos de renda fixa</li>
                            <li>Tipos de títulos: prefixados, pós-fixados e híbridos</li>
                            <li>Riscos e vantagens da renda fixa</li>
                            <li>Como escolher os melhores títulos</li>
                        </ul>
                    </div>
                `,
                mindMap: 'https://placehold.co/800x400?text=Mapa+Renda+Fixa',
                quotes: [
                    {
                        text: "O segredo para ficar rico é colocar dinheiro para trabalhar para você e fazer com que o dinheiro ganhe dinheiro.",
                        author: "Robert Kiyosaki"
                    }
                ],
                resources: [
                    {
                        title: 'Comparador de CDBs',
                        url: '#',
                        type: 'tool',
                        icon: 'chart-line'
                    },
                    {
                        title: 'Calendário de Vencimentos',
                        url: '#',
                        type: 'calendar',
                        icon: 'calendar-alt'
                    }
                ],
                quiz: [
                    {
                        question: "O que significa CDI?",
                        options: [
                            "Certificado de Depósito Interbancário",
                            "Conta de Depósito Interbancário",
                            "Certificado de Depósito Bancário",
                            "Conta de Depósito Bancário"
                        ],
                        answer: 0,
                        explanation: "CDI significa Certificado de Depósito Interbancário, uma taxa usada como referência para investimentos de renda fixa."
                    }
                ],
                flashcards: [
                    {
                        front: "O que é um título prefixado?",
                        back: "Título cuja taxa de juros é definida no momento da aplicação."
                    },
                    {
                        front: "O que é um título pós-fixado?",
                        back: "Título cuja rentabilidade é atrelada a um índice, como o CDI ou IPCA."
                    }
                ],
                curiosities: [
                    'No Tesouro Direto, o Tesouro Selic costuma ser a escolha para reserva de emergência pela baixa volatilidade.',
                    'Títulos IPCA+ protegem o poder de compra ao pagar juros reais acima da inflação.'
                ],
                exercises: [
                    {
                        question: 'Compare um CDB 110% do CDI com um Tesouro Prefixado de 10% a.a. para 2 anos. Qual tende a render mais?',
                        answer: 'Depende do CDI médio no período. Se CDI médio > 9,09% a.a., 110% do CDI supera 10% a.a.; caso contrário, o prefixado tende a ganhar.',
                        explanation: '110% do CDI equivale a 1,1×CDI. A taxa de indiferença é 10%/1,1 ≈ 9,09% a.a. Compare com expectativa para o CDI em 2 anos.'
                    },
                    {
                        question: 'Qual título usaria para reserva de emergência? Explique.',
                        answer: 'Tesouro Selic ou CDB com liquidez diária e boa taxa.',
                        explanation: 'Reserva pede liquidez diária, baixo risco e baixa volatilidade. Prefixados/IPCA+ têm marcação a mercado e não são ideais.'
                    }
                ],
                faq: [
                    { q: 'Tenho perdas em renda fixa?', a: 'Pode haver marcação a mercado em títulos prefixados e IPCA+ antes do vencimento, gerando oscilações.' },
                    { q: 'Existe FGC?', a: 'Sim, alguns produtos privados têm cobertura do FGC até os limites vigentes. Títulos públicos não precisam de FGC.' }
                ],
                progress: 0,
                lastStudied: null,
                notes: ''
            },
            // Capítulo 7: Planejamento Financeiro Pessoal
            'planejamento-financeiro': {
                id: 'planejamento-financeiro',
                title: 'Planejamento Financeiro Pessoal',
                summary: `
                    <div class="prose max-w-none">
                        <p>Planejamento financeiro é o processo de organizar sua vida financeira para alcançar objetivos de curto, médio e longo prazos.</p>
                        <p class="mt-4 font-medium">Neste capítulo, você aprenderá:</p>
                        <ul class="list-disc pl-5 mt-2 space-y-2">
                            <li>Como montar um orçamento e controlar gastos</li>
                            <li>Definição de metas SMART e priorização</li>
                            <li>Criação e uso da reserva de emergência</li>
                            <li>Métodos para reduzir dívidas e organizar aportes</li>
                        </ul>
                    </div>
                `,
                mindMap: 'https://placehold.co/800x400?text=Mapa+Planejamento+Financeiro',
                quotes: [
                    { text: 'Um objetivo sem um plano é apenas um desejo.', author: 'Antoine de Saint-Exupéry' }
                ],
                resources: [
                    { title: 'Planilha de Orçamento 50/30/20', url: 'recursos.html#orcamento', type: 'planilha', icon: 'file-excel' },
                    { title: 'Simulador de Reserva', url: '#cap9', type: 'simulador', icon: 'piggy-bank' }
                ],
                quiz: [
                    {
                        question: 'Qual a função principal da reserva de emergência?',
                        options: ['Aumentar retorno de longo prazo', 'Cobrir imprevistos sem endividar', 'Garantir renda passiva'],
                        answer: 1,
                        explanation: 'A reserva de emergência evita endividamento em situações inesperadas.'
                    }
                ],
                flashcards: [
                    { front: 'Regra 50/30/20', back: '50% necessidades, 30% desejos, 20% investimentos/metas.' },
                    { front: 'Meta SMART', back: 'Específica, Mensurável, Atingível, Relevante e Temporal.' }
                ],
                curiosities: [
                    'A regra 1ª de finanças pessoais é pagar-se primeiro, automatizando aportes.',
                    'Pequenos cortes em despesas recorrentes têm grande impacto no longo prazo.'
                ],
                exercises: [
                    {
                        question: 'Monte um orçamento 50/30/20 com base na sua renda atual.',
                        answer: 'Destine 50% a necessidades, 30% a desejos e 20% a investimentos/metas.',
                        explanation: 'A regra 50/30/20 é um ponto de partida. Ajuste percentuais conforme sua realidade e objetivos.'
                    },
                    {
                        question: 'Calcule o tamanho da sua reserva de emergência (em meses) e um plano de aporte.',
                        answer: 'Ex.: 6 meses de despesas. Se despesas = R$ 3.000/mês, meta = R$ 18.000.',
                        explanation: 'Defina meses alvo (3–12). Aporte mensal = Meta / prazo em meses; prefira aplicações de alta liquidez e baixa volatilidade.'
                    }
                ],
                faq: [
                    { q: 'Reserva em renda fixa ou conta remunerada?', a: 'Priorize liquidez diária e baixa volatilidade (ex.: Tesouro Selic, CDBs com liquidez diária, contas remuneradas confiáveis).' },
                    { q: 'Como sair das dívidas?', a: 'Renegocie juros, priorize dívidas caras (bola de neve/avalanche) e ajuste o orçamento.' }
                ],
                progress: 0,
                lastStudied: null,
                notes: ''
            },

            // Capítulo 8: Investindo no Exterior
            'investimentos-exterior': {
                id: 'investimentos-exterior',
                title: 'Investindo no Exterior',
                summary: `
                    <div class="prose max-w-none">
                        <p>Investir fora do país amplia a diversificação geográfica, setorial e cambial, reduzindo riscos locais e potencializando retornos.</p>
                        <p class="mt-4 font-medium">Neste capítulo, você verá:</p>
                        <ul class="list-disc pl-5 mt-2 space-y-2">
                            <li>Principais formas de investir no exterior (BDRs, ETFs, corretoras internacionais)</li>
                            <li>Custos, tributação e documentos necessários</li>
                            <li>Estratégias de alocação e hedge cambial</li>
                        </ul>
                    </div>
                `,
                mindMap: 'https://placehold.co/800x400?text=Mapa+Investir+no+Exterior',
                quotes: [
                    { text: 'Não coloque todos os ovos na mesma cesta – especialmente a cesta do seu país.', author: 'Diversificação Internacional' }
                ],
                resources: [
                    { title: 'Guia de Abertura em Corretora Global', url: 'recursos.html#corretoras', type: 'guia', icon: 'globe' },
                    { title: 'Simulador Nominal x Real', url: '#cap9', type: 'simulador', icon: 'calculator' }
                ],
                quiz: [
                    {
                        question: 'O que é BDR?',
                        options: ['Ação estrangeira listada diretamente no Brasil', 'Certificado que representa ação no exterior', 'ETF internacional'],
                        answer: 1,
                        explanation: 'BDR é um recibo de depósito que representa um valor mobiliário emitido no exterior.'
                    }
                ],
                flashcards: [
                    { front: 'Hedge Cambial', back: 'Proteção contra variação do câmbio em uma posição internacional.' },
                    { front: 'Withholding Tax', back: 'Imposto retido na fonte sobre rendimentos no exterior.' }
                ],
                curiosities: [
                    'Diversificar geograficamente reduz o risco de eventos locais afetarem todo o portfólio.',
                    'BDRs permitem exposição internacional sem enviar recursos ao exterior.'
                ],
                exercises: [
                    {
                        question: 'Proponha uma alocação internacional (10%, 20% ou 30%) para seu perfil e justifique.',
                        answer: 'Ex.: 20% internacional para perfil moderado.',
                        explanation: 'A alocação depende de tolerância a risco, horizonte e necessidade de proteção cambial e setorial.'
                    },
                    {
                        question: 'Explique quando usar hedge cambial em uma carteira internacional.',
                        answer: 'Quando a variação do câmbio adicionar risco indesejado aos objetivos.',
                        explanation: 'Hedge reduz volatilidade cambial, mas também pode reduzir ganhos quando a moeda estrangeira se valoriza.'
                    }
                ],
                faq: [
                    { q: 'Qual a tributação de ETFs internacionais?', a: 'Depende do veículo (local ou no exterior). Verifique regras de IR, isenções e eventuais tratados.' },
                    { q: 'É obrigatório declarar?', a: 'Sim, investimentos no exterior e BDRs devem ser declarados seguindo as normas da Receita Federal.' }
                ],
                progress: 0,
                lastStudied: null,
                notes: ''
            },
            // Adicione mais tópicos aqui seguindo o mesmo padrão
        };

        // Elementos do menu
        const menuBtn = document.getElementById('menuBtn');
        const sidebar = document.getElementById('sidebar');
        const closeBtn = document.getElementById('closeSidebar');
        const overlay = document.getElementById('overlay');
        const header = document.getElementById('topo');
        let lastScroll = 0;

        // Funções robustas de Modal e Estudo
        function closeStudyModal() {
            const modal = document.getElementById('studyModal');
            if (!modal) return;
            modal.classList.add('hidden');
            modal.style.display = 'none';
            document.body.classList.remove('overflow-hidden');
        }

        function openStudyModal(topicId, event = null) {
            try {
                if (event) event.preventDefault();
                const topic = topicData[topicId];
                if (!topic) return console.warn('[StudyModal] topicId inválido:', topicId);

                // Título e resumo
                const titleEl = document.getElementById('modalTitle');
                const summaryEl = document.getElementById('modalSummary');
                if (titleEl) titleEl.textContent = topic.title || '';
                if (summaryEl) summaryEl.innerHTML = `${topic.summary || ''}`;

                // Mapa mental
                const mindImg = document.getElementById('mindMapImage');
                if (mindImg) {
                    if (topic.mindMap) {
                        mindImg.src = topic.mindMap;
                        mindImg.alt = `Mapa mental de ${topic.title}`;
                        mindImg.parentElement?.classList?.remove('hidden');
                    } else {
                        mindImg.src = '';
                        mindImg.alt = '';
                        mindImg.parentElement?.classList?.add('hidden');
                    }
                }

                // Citações
                const quotesContainer = document.getElementById('modalQuotes');
                if (quotesContainer) {
                    const quotes = Array.isArray(topic.quotes) ? topic.quotes : [];
                    quotesContainer.innerHTML = quotes.length ? quotes.map(q => (
                        `<div class="bg-gray-50 p-4 rounded-lg mb-4 border-l-4 border-blue-500">`
                        + `<p class="text-gray-700 italic">"${q.text}"</p>`
                        + `<p class="text-sm text-gray-500 mt-2">— ${q.author || ''}</p>`
                        + `</div>`
                    )).join('') : '';
                }

                // Recursos
                const resourcesContainer = document.getElementById('modalResources');
                if (resourcesContainer) {
                    const refs = Array.isArray(topic.resources) ? topic.resources : [];
                    resourcesContainer.innerHTML = refs.length ? refs.map(r => (
                        `<a href="${r.url}" target="_blank" rel="noopener" class="flex items-center p-3 border rounded-lg hover:bg-gray-50 transition-colors">`
                        + `<i class="fas fa-${r.icon || 'link'} text-blue-500 text-xl w-8"></i>`
                        + `<div class="ml-3">`
                        + `<h4 class="font-medium">${r.title}</h4>`
                        + `<p class="text-sm text-gray-500">${r.type || ''}</p>`
                        + `</div>`
                        + `</a>`
                    )).join('') : `<div class="text-sm text-gray-500">Sem recursos adicionais cadastrados.</div>`;
                }

                // Curiosidades
                const curios = document.getElementById('modalCuriosities');
                if (curios) {
                    const items = Array.isArray(topic.curiosities) ? topic.curiosities : [];
                    curios.innerHTML = items.length ? items.map(c => `<li>${c}</li>`).join('') : `<li class="text-gray-500">Nenhuma curiosidade cadastrada.</li>`;
                }

                // Exercícios
                const exercises = document.getElementById('modalExercises');
                if (exercises) {
                    const items = Array.isArray(topic.exercises) ? topic.exercises : [];
                    exercises.innerHTML = items.length ? items.map((e, idx) => {
                        const q = typeof e === 'string' ? e : (e.question || '');
                        const a = typeof e === 'object' && e.answer ? `<p class='mt-1'><span class='font-medium'>Resposta:</span> ${e.answer}</p>` : '';
                        const expl = typeof e === 'object' && e.explanation ? `<p class='mt-1 text-gray-700'><span class='font-medium'>Explicação:</span> ${e.explanation}</p>` : '';
                        return `<li><div><span class="font-medium">Exercício ${idx + 1}:</span> ${q}</div>${(a||expl) ? `<details class='mt-2 bg-gray-50 rounded border p-3'><summary class='cursor-pointer text-sm text-gray-700'>Mostrar resposta</summary><div class='mt-2 text-sm text-gray-800'>${a}${expl}</div></details>` : ''}</li>`;
                    }).join('') : `<li class="text-gray-500">Nenhum exercício cadastrado.</li>`;
                }

                // FAQ
                const faq = document.getElementById('modalFAQ');
                if (faq) {
                    const items = Array.isArray(topic.faq) ? topic.faq : [];
                    faq.innerHTML = items.length ? items.map(f => (
                        `<div class="border rounded-lg p-3">`
                        + `<div class="font-medium text-gray-900">${f.q}</div>`
                        + `<div class="text-sm text-gray-700 mt-1">${f.a}</div>`
                        + `</div>`
                    )).join('') : `<div class="text-sm text-gray-500">Nenhuma pergunta frequente cadastrada.</div>`;
                }

                // Ferramentas de Estudo
                const studyTools = document.getElementById('studyTools');
                if (studyTools) {
                    const pct = topic.progress || 0;
                    studyTools.innerHTML = `
                        <div class="space-y-4">
                            <button data-action="quiz" data-topic="${topicId}" class="w-full flex items-center justify-between px-4 py-3 bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors">
                                <span>Fazer Quiz</span>
                                <i class="fas fa-question-circle"></i>
                            </button>
                            <button data-action="flashcards" data-topic="${topicId}" class="w-full flex items-center justify-between px-4 py-3 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors">
                                <span>Cartões de Estudo</span>
                                <i class="fas fa-layer-group"></i>
                            </button>
                            <div class="mt-4 p-4 bg-yellow-50 rounded-lg">
                                <h4 class="font-medium text-yellow-800 mb-2">Seu Progresso</h4>
                                <div class="w-full bg-gray-200 rounded-full h-2.5 mb-2">
                                    <div class="bg-blue-600 h-2.5 rounded-full progress-bar" style="width: ${pct}%"></div>
                                </div>
                                <p class="text-sm text-gray-600">${pct}% completo</p>
                            </div>
                        </div>`;
                }

                // Atualiza e abre modal
                topic.lastStudied = new Date().toISOString();
                updateTopicCard(topicId);
                const modal = document.getElementById('studyModal');
                if (modal) {
                    modal.classList.remove('hidden');
                    modal.style.display = 'flex';
                    modal.style.zIndex = '9999';
                    document.body.classList.add('overflow-hidden');
                }
            } catch (err) {
                console.error('[StudyModal] Erro ao abrir modal:', err);
            }
        }

        // Expor globalmente
        window.openStudyModal = openStudyModal;
        window.closeStudyModal = closeStudyModal;
        // Expor globalmente após a definição
        window.openStudyModal = openStudyModal;

        // Função para atualizar o card do tópico
        function updateTopicCard(topicId) {
            const topic = topicData[topicId];
            if (!topic) return;

            const card = document.querySelector(`[data-topic-id="${topicId}"]`);
            if (!card) return;

            const progressBar = card.querySelector('.progress-bar');
            const progressText = card.querySelector('.progress-text');
            const lastStudied = card.querySelector('.last-studied');
            
            if (progressBar) {
                progressBar.style.width = `${topic.progress}%`;
            }
            if (progressText) {
                progressText.textContent = `${topic.progress}%`;
            }
            if (lastStudied && topic.lastStudied) {
                const date = new Date(topic.lastStudied);
                lastStudied.textContent = `Último estudo: ${date.toLocaleDateString()}`;
                lastStudied.classList.remove('invisible');
            }
        }

        // Função para mostrar o quiz
        function showQuiz(topicId) {
            // Garante que o modal existe
            if (typeof openStudyModal === 'function') openStudyModal(topicId || 'quiz');
            const modal = document.getElementById('studyModal');
            if (!modal) return;
            const titleEl = modal.querySelector('[data-s-title]');
            const summaryEl = modal.querySelector('[data-s-summary]');
            const bullets = modal.querySelector('[data-s-bullets]');
            const actions = modal.querySelector('[data-s-actions]');
            titleEl.textContent = 'Quiz Rápido';
            summaryEl.textContent = 'Responda as 3 perguntas abaixo para validar seu entendimento.';
            const questions = [
                { q: 'O que é liquidez?', opts: ['Capacidade de o ativo render mais', 'Facilidade de converter em dinheiro', 'Garantia do FGC'], a: 1 },
                { q: 'Tesouro Selic é indicado para:', opts: ['Reserva de emergência', 'Objetivos de 20 anos', 'Alto risco'], a: 0 },
                { q: 'Diversificação ajuda a:', opts: ['Aumentar risco específico', 'Reduzir risco não-sistemático', 'Eliminar risco de mercado'], a: 1 }
            ];
            bullets.innerHTML = questions.map((it, idx)=>{
                const name = `q${idx}`;
                return `<div class="mb-2">
                    <div class="font-medium mb-1">${idx+1}. ${it.q}</div>
                    ${it.opts.map((o,i)=>`<label class="flex items-center gap-2 text-sm"><input type="radio" name="${name}" value="${i}" class="text-blue-600"> ${o}</label>`).join('')}
                </div>`;
            }).join('');
            actions.innerHTML = '<button id="quizSubmit" class="mt-2 px-3 py-1.5 text-sm rounded-md bg-blue-600 text-white hover:bg-blue-700">Ver resultado</button> <span id="quizScore" class="ml-2 text-sm"></span>';
            setTimeout(()=>{
                document.getElementById('quizSubmit')?.addEventListener('click', ()=>{
                    let score = 0;
                    questions.forEach((it,idx)=>{
                        const sel = modal.querySelector(`input[name="q${idx}"]:checked`);
                        if (sel && parseInt(sel.value) === it.a) score++;
                    });
                    const pct = Math.round((score / questions.length) * 100);
                    const scoreEl = document.getElementById('quizScore');
                    if (scoreEl) scoreEl.textContent = `Acertos: ${score}/${questions.length} (${pct}%)`;
                });
            }, 0);
        }

        // Função para mostrar os cartões de estudo
        function showFlashcards(topicId) {
            if (typeof openStudyModal === 'function') openStudyModal(topicId || 'flashcards');
            const modal = document.getElementById('studyModal');
            if (!modal) return;
            modal.querySelector('[data-s-title]').textContent = 'Flashcards';
            modal.querySelector('[data-s-summary]').textContent = 'Revise conceitos chave alternando frente/verso dos cartões.';
            const items = [
                { front: 'Liquidez', back: 'Facilidade de converter o ativo em dinheiro sem perda relevante.' },
                { front: 'Risco x Retorno', back: 'Em geral, maior risco exige maior retorno esperado.' },
                { front: 'Diversificação', back: 'Combinar ativos para reduzir risco específico sem reduzir muito o retorno.' }
            ];
            const bullets = modal.querySelector('[data-s-bullets]');
            bullets.innerHTML = `<div class="grid sm:grid-cols-2 gap-3">${items.map((it,idx)=>`
                <div class="p-3 border rounded-md bg-gray-50 dark:bg-gray-800/60 cursor-pointer" data-card="${idx}">
                    <div class="front font-medium">${it.front}</div>
                    <div class="back hidden text-sm text-gray-700 dark:text-gray-300">${it.back}</div>
                </div>`).join('')}</div>`;
            const actions = modal.querySelector('[data-s-actions]');
            actions.innerHTML = '<span class="text-xs text-gray-500">Clique em um cartão para virar</span>';
            bullets.querySelectorAll('[data-card]').forEach(card=>{
                card.addEventListener('click', ()=>{
                    const front = card.querySelector('.front');
                    const back = card.querySelector('.back');
                    front.classList.toggle('hidden');
                    back.classList.toggle('hidden');
                });
            });
        }

        // Função para abrir o menu
        function openMenu() {
            sidebar.classList.remove('-translate-x-full');
            overlay.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        // Função para fechar o menu
        function closeMenu() {
            sidebar.classList.add('-translate-x-full');
            overlay.classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        // Abrir menu ao clicar no botão
        menuBtn.addEventListener('click', openMenu);

        // Fechar menu ao clicar no botão de fechar
        closeBtn.addEventListener('click', closeMenu);

        // Fechar menu ao clicar no overlay
        overlay.addEventListener('click', closeMenu);

        // Adicionar botões de estudo aos cards de tópicos
        document.addEventListener('DOMContentLoaded', function() {
            // Adicionar evento de clique aos botões de estudo
            document.querySelectorAll('.study-topic-btn').forEach(button => {
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    const topicId = this.getAttribute('data-topic-id');
                    if (topicId) {
                        openStudyModal(topicId, e);
                    }
                });
            });

            // Delegação: abrir Estudo ao clicar nos botões
            document.addEventListener('click', function(e){
                const btn = e.target.closest('.study-topic-btn, [data-action="open-study"]');
                if (!btn) return;
                const topicId = btn.getAttribute('data-topic-id') || btn.getAttribute('data-topic') || btn.getAttribute('data-id');
                if (!topicId) return;
                e.preventDefault();
                openStudyModal(topicId, e);
            });

            // Fechar modal: ESC, overlay e botões data-modal-close
            document.addEventListener('keydown', function(e){
                if (e.key === 'Escape') closeStudyModal();
            });
            document.addEventListener('click', function(e){
                const modal = document.getElementById('studyModal');
                if (!modal) return;
                if (e.target === modal) closeStudyModal();
                if (e.target.closest('[data-modal-close]')) closeStudyModal();
            });

            // Adicionar tooltips (seguro)
            try {
                if (!DISABLE_ENHANCED_TOOLTIPS && typeof tippy === 'function') {
                    tippy('[data-tippy-content]', {
                        placement: 'top',
                        animation: 'scale',
                        theme: 'light',
                        arrow: true
                    });
                }
            } catch (e) {
                // Falha ao iniciar tippy, seguir sem quebrar a página
            }

            // Inicializar tooltips do Bootstrap (seguro)
            try {
                if (!DISABLE_ENHANCED_TOOLTIPS && window.bootstrap && typeof bootstrap.Tooltip === 'function') {
                    const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
                    tooltipTriggerList.map(function (tooltipTriggerEl) {
                        return new bootstrap.Tooltip(tooltipTriggerEl);
                    });
                }
            } catch (e) {
                // Ignorar erros de bootstrap tooltip
            }

            // ---- Simuladores: Juros Compostos (tabs) ----
            (function initJurosCompostosTabs(){
                const tabButtons = document.querySelectorAll('[data-jc-tab]');
                const panes = document.querySelectorAll('[data-jc-pane]');
                if (!tabButtons.length || !panes.length) return;
                tabButtons.forEach(btn=>{
                    btn.addEventListener('click', ()=>{
                        const target = btn.getAttribute('data-jc-tab');
                        tabButtons.forEach(b=>{
                            b.classList.remove('bg-blue-600','text-white');
                            b.classList.add('bg-gray-200');
                        });
                        btn.classList.add('bg-blue-600','text-white');
                        btn.classList.remove('bg-gray-200');
                        panes.forEach(p=>{
                            if (p.getAttribute('data-jc-pane') === target) p.classList.remove('hidden');
                            else p.classList.add('hidden');
                        });
                    });
                });
            })();

            // ---- Simuladores: Cálculos ----
            const fmtBRL = (v)=> v.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });

            // Aporte único
            const jcCalcUnico = document.getElementById('jc_calc_unico');
            if (jcCalcUnico) {
                jcCalcUnico.addEventListener('click', ()=>{
                    const C = parseFloat(document.getElementById('jc_c')?.value || '0');
                    const i = parseFloat(document.getElementById('jc_i')?.value || '0')/100; // mês
                    const n = parseInt(document.getElementById('jc_n')?.value || '0',10);
                    if (C<=0 || i<0 || n<=0) { document.getElementById('jc_out_unico').textContent = 'Preencha os campos corretamente.'; return; }
                    const M = C * Math.pow(1+i, n);
                    const J = M - C;
                    document.getElementById('jc_out_unico').innerHTML = `
                        Valor futuro: <b>${fmtBRL(M)}</b> · Juros: <b>${fmtBRL(J)}</b>`;
                });
            }

            // Aportes mensais
            const jcCalcMensal = document.getElementById('jc_calc_mensal');
            if (jcCalcMensal) {
                jcCalcMensal.addEventListener('click', ()=>{
                    const P = parseFloat(document.getElementById('jcm_p')?.value || '0');
                    const n = parseInt(document.getElementById('jcm_n')?.value || '0',10);
                    const i = parseFloat(document.getElementById('jcm_i')?.value || '0')/100;
                    const C0 = parseFloat(document.getElementById('jcm_c')?.value || '0');
                    if (P<0 || i<0 || n<=0 || C0<0) { document.getElementById('jc_out_mensal').textContent = 'Preencha os campos corretamente.'; return; }
                    const fvC0 = C0 * Math.pow(1+i, n);
                    const fvP = i === 0 ? P * n : P * ((Math.pow(1+i, n) - 1) / i);
                    const M = fvC0 + fvP;
                    const totalAportado = C0 + P * n;
                    const J = M - totalAportado;
                    document.getElementById('jc_out_mensal').innerHTML = `
                        Valor futuro: <b>${fmtBRL(M)}</b> · Total aportado: <b>${fmtBRL(totalAportado)}</b> · Juros: <b>${fmtBRL(J)}</b>`;
                });
            }

            // Reserva de Emergência
            const reCalc = document.getElementById('re_calc');
            if (reCalc) {
                reCalc.addEventListener('click', ()=>{
                    const gasto = parseFloat(document.getElementById('re_gasto')?.value || '0');
                    const mesesAlvo = parseInt(document.getElementById('re_meses')?.value || '0',10);
                    const i = parseFloat(document.getElementById('re_i')?.value || '0')/100; // a.m.
                    const aporte = parseFloat(document.getElementById('re_aporte')?.value || '0');
                    const alvo = gasto * mesesAlvo;
                    let texto = `Meta: <b>${fmtBRL(alvo)}</b>. `;
                    if (alvo<=0) { document.getElementById('re_out').innerHTML = 'Informe gastos e meses válidos.'; return; }
                    // Estimar meses necessários com aportes e juros via iteração até 600 meses
                    let saldo = 0, m=0;
                    while (saldo < alvo && m < 600) {
                        saldo = saldo * (1+i) + aporte;
                        m++;
                    }
                    if (aporte>0) {
                        texto += `Com aporte mensal de ${fmtBRL(aporte)} e taxa ${ (i*100).toFixed(2) }% a.m., você atinge em ~<b>${m}</b> meses (estimado).`;
                    } else {
                        texto += `Sem aportes, junte o valor total alvo em aplicação líquida e segura (ex.: Tesouro Selic).`;
                    }
                    document.getElementById('re_out').innerHTML = texto;
                });
            }

            // Nominal x Real
            const txCalc = document.getElementById('tx_calc');
            if (txCalc) {
                txCalc.addEventListener('click', ()=>{
                    const nom = parseFloat(document.getElementById('tx_nom')?.value || '0');
                    const inf = parseFloat(document.getElementById('tx_inf')?.value || '0');
                    const real = ((1 + nom/100) / (1 + inf/100) - 1) * 100;
                    document.getElementById('tx_out').innerHTML = `Taxa real aproximada: <b>${real.toFixed(2)}% a.a.</b>`;
                });
            }
        });

        // Fechar menu ao pressionar a tecla ESC
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeMenu();
            }
        });

        // Esconder/mostrar header ao rolar
        window.addEventListener('scroll', () => {
            const currentScroll = window.pageYOffset;
            
            if (currentScroll <= 0) {
                header.classList.remove('transform', '-translate-y-full');
                return;
            }
            
            if (currentScroll > lastScroll && !header.classList.contains('-translate-y-full')) {
                // Rolar para baixo
                header.classList.add('transform', '-translate-y-full');
            } else if (currentScroll < lastScroll && header.classList.contains('-translate-y-full')) {
                // Rolar para cima
                header.classList.remove('transform', '-translate-y-full');
            }
            
            lastScroll = currentScroll;
        });

        // Ativar link ativo no menu
        const sections = document.querySelectorAll('div[id^="cap"]');
        const navItems = document.querySelectorAll('#sidebar nav a');
        
        function setActiveLink() {
            let current = '';
            
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.offsetHeight;
                
                if (pageYOffset >= (sectionTop - sectionHeight / 3)) {
                    current = section.getAttribute('id');
                }
            });
            
            navItems.forEach(item => {
                item.classList.remove('bg-blue-50', 'text-blue-700');
                item.classList.add('text-gray-700');
                
                if (item.getAttribute('href') === `#${current}`) {
                    item.classList.remove('text-gray-700');
                    item.classList.add('bg-blue-50', 'text-blue-700');
                }
            });
        }
        
        window.addEventListener('scroll', setActiveLink);
        document.addEventListener('DOMContentLoaded', setActiveLink);

        // Botão de voltar ao topo
        const backToTopBtn = document.createElement('button');
        backToTopBtn.innerHTML = '<i class="fas fa-arrow-up"></i>';
        backToTopBtn.className = 'fixed bottom-6 right-6 w-12 h-12 bg-blue-600 text-white rounded-full shadow-lg flex items-center justify-center text-xl transform transition-transform hover:scale-110 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 z-10';
        backToTopBtn.style.display = 'none';
        document.body.appendChild(backToTopBtn);

        window.addEventListener('scroll', () => {
            if (window.pageYOffset > 300) {
                backToTopBtn.style.display = 'flex';
            } else {
                backToTopBtn.style.display = 'none';
            }
        });

        backToTopBtn.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Suave rolagem para âncoras
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                const href = this.getAttribute('href');
                if (!href || href === '#') return;
                const target = document.querySelector(href);
                if (!target) return;
                e.preventDefault();
                target.scrollIntoView({ behavior: 'smooth' });
            });
        });

        // Fechar modal de recursos ao clicar fora do conteúdo
        const resModal = document.getElementById('resourceModal');
        if (resModal) {
            resModal.addEventListener('click', (e)=>{
                if (e.target && e.target.id === 'resourceModal') {
                    closeResourceModal();
                }
            });
        }

        // Função para calcular a reserva de emergência
        function calcularReserva() {
            const despesas = parseFloat(document.getElementById('despesas').value) || 0;
            const meses = parseInt(document.getElementById('meses').value) || 6;
            const resultado = despesas * meses;
            
            // Formata o valor em reais
            const formatoMoeda = {
                style: 'currency',
                currency: 'BRL',
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            };
            
            document.getElementById('resultado-reserva').textContent = 
                resultado.toLocaleString('pt-BR', formatoMoeda);
        }
        
        // Adiciona evento de clique ao botão de calcular
        const calcularBtn = document.querySelector('button[onclick="calcularReserva()"]');
        if (calcularBtn) {
            calcularBtn.addEventListener('click', calcularReserva);
        }
        
        // Adiciona evento de tecla Enter no campo de despesas
        const inputDespesas = document.getElementById('despesas');
        if (inputDespesas) {
            inputDespesas.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    calcularReserva();
                }
            });
        }

        // Função para formatar valores monetários
        function formatarMoeda(valor) {
            return valor.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        }

        // Função para calcular a comparação entre ETFs
        function calcularComparacaoETFs() {
            // Obter valores dos inputs
            const investimentoInicial = parseFloat(document.getElementById('investimento-inicial').value) || 0;
            const aportesMensais = parseFloat(document.getElementById('aportes-mensais').value) || 0;
            const taxaETF1 = parseFloat(document.getElementById('taxa-etf1').value) / 100 || 0;
            const taxaETF2 = parseFloat(document.getElementById('taxa-etf2').value) / 100 || 0;
            const retornoEsperado = parseFloat(document.getElementById('retorno-esperado').value) / 100 || 0;
            const periodo = parseInt(document.getElementById('periodo').value) || 0;

            // Calcular retorno líquido para cada ETF
            const retornoLiquido1 = Math.pow(1 + retornoEsperado - taxaETF1, 1/12) - 1;
            const retornoLiquido2 = Math.pow(1 + retornoEsperado - taxaETF2, 1/12) - 1;

            let montante1 = investimentoInicial;
            let montante2 = investimentoInicial;

            // Simular os aportes mensais
            for (let i = 0; i < periodo * 12; i++) {
                montante1 = (montante1 * (1 + retornoLiquido1)) + aportesMensais;
                montante2 = (montante2 * (1 + retornoLiquido2)) + aportesMensais;
            }

            // Atualizar a interface
            document.getElementById('anos-resultado').textContent = periodo;
            document.getElementById('taxa1-resultado').textContent = (taxaETF1 * 100).toFixed(2);
            document.getElementById('taxa2-resultado').textContent = (taxaETF2 * 100).toFixed(2);
            
            document.getElementById('resultado-etf1').textContent = formatarMoeda(montante1);
            document.getElementById('resultado-etf2').textContent = formatarMoeda(montante2);
            
            const diferenca = Math.abs(montante1 - montante2);
            document.getElementById('diferenca').textContent = formatarMoeda(diferenca);
            
            // Ajustar as barras de progresso
            const maiorMontante = Math.max(montante1, montante2);
            const percentual1 = (montante1 / maiorMontante) * 100;
            const percentual2 = (montante2 / maiorMontante) * 100;
            
            document.getElementById('barra-etf1').style.width = `${percentual1}%`;
            document.getElementById('barra-etf2').style.width = `${percentual2}%`;
            
            // Mostrar os resultados
            document.getElementById('resultado-comparacao').classList.remove('hidden');
        }

        // Dados do quiz
        const quizData = [
            {
                pergunta: "O que significa a sigla ETF?",
                opcoes: [
                    "Exchange Traded Fund",
                    "Efficient Trading Fund",
                    "Equity Trading Fund",
                    "Exchange Trading Fee"
                ],
                resposta: 0,
                explicacao: "ETF significa Exchange Traded Fund, que é um fundo de investimento negociado em bolsa, como uma ação."
            },
            {
                pergunta: "Qual é uma vantagem dos ETFs em relação aos fundos de investimento tradicionais?",
                opcoes: [
                    "Taxas de administração mais altas",
                    "Negociação em tempo real durante o pregão",
                    "Gestão ativa do portfólio",
                    "Maior alavancagem"
                ],
                resposta: 1,
                explicacao: "Uma das principais vantagens dos ETFs é que eles são negociados em tempo real durante o pregão, assim como ações."
            },
            {
                pergunta: "Qual é o principal índice de referência do ETF BOVA11?",
                opcoes: [
                    "S&P 500",
                    "IBrX",
                    "Ibovespa",
                    "IFIX"
                ],
                resposta: 2,
                explicacao: "O BOVA11 replica o desempenho do Ibovespa, o principal índice da bolsa de valores brasileira."
            },
            {
                pergunta: "O que significa dizer que um ETF é 'passivo'?",
                opcoes: [
                    "Não tem gestão ativa",
                    "Não paga dividendos",
                    "Tem baixa liquidez",
                    "É isento de impostos"
                ],
                resposta: 0,
                explicacao: "Um ETF passivo segue um índice de referência sem tentar superá-lo, ao contrário dos fundos ativos que buscam bater o mercado."
            }
        ];

        // Inicializar o quiz (ETF)
        function inicializarQuiz() {
            const container = document.getElementById('etf-quiz-container');
            
            quizData.forEach((pergunta, index) => {
                const questaoDiv = document.createElement('div');
                questaoDiv.className = 'bg-white p-4 rounded-lg shadow-sm';
                questaoDiv.innerHTML = `
                    <h4 class="font-medium text-gray-800 mb-3">${index + 1}. ${pergunta.pergunta}</h4>
                    <div class="space-y-2">
                        ${pergunta.opcoes.map((opcao, i) => `
                            <div class="flex items-center">
                                <input type="radio" id="q${index}_${i}" name="q${index}" value="${i}" class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300">
                                <label for="q${index}_${i}" class="ml-2 text-sm text-gray-700">${opcao}</label>
                            </div>
                        `).join('')}
                    </div>
                    <div id="feedback-${index}" class="mt-2 text-sm hidden"></div>
                `;
                container.appendChild(questaoDiv);
            });

            // Adicionar evento ao botão de verificar respostas
            const btn = document.getElementById('etf-verificar-respostas');
            if (btn) btn.addEventListener('click', verificarRespostas);
        }

        // Verificar as respostas do quiz
        function verificarRespostas() {
            let acertos = 0;
            const totalPerguntas = quizData.length;
            
            quizData.forEach((pergunta, index) => {
                const respostaSelecionada = document.querySelector(`input[name="q${index}"]:checked`);
                const feedbackDiv = document.getElementById(`feedback-${index}`);
                
                if (respostaSelecionada) {
                    const respostaUsuario = parseInt(respostaSelecionada.value);
                    
                    if (respostaUsuario === pergunta.resposta) {
                        feedbackDiv.innerHTML = `✅ <span class="text-green-700">Correto! ${pergunta.explicacao}</span>`;
                        acertos++;
                    } else {
                        feedbackDiv.innerHTML = `❌ <span class="text-red-700">Incorreto. ${pergunta.explicacao}</span>`;
                    }
                    
                    feedbackDiv.classList.remove('hidden');
                } else {
                    feedbackDiv.innerHTML = '⚠️ <span class="text-yellow-700">Por favor, selecione uma resposta.</span>';
                    feedbackDiv.classList.remove('hidden');
                }
            });
            
            // Mostrar resultado final
            const resultadoDiv = document.getElementById('etf-resultado-quiz');
            const percentualAcerto = Math.round((acertos / totalPerguntas) * 100);
            
            if (percentualAcerto >= 70) {
                resultadoDiv.innerHTML = `🎉 Parabéns! Você acertou ${acertos} de ${totalPerguntas} (${percentualAcerto}%)`;
                resultadoDiv.className = 'text-sm font-medium text-green-600';
            } else {
                resultadoDiv.innerHTML = `📝 Você acertou ${acertos} de ${totalPerguntas} (${percentualAcerto}%). Continue estudando!`;
                resultadoDiv.className = 'text-sm font-medium text-yellow-600';
            }
            
            // Rolar para o resultado
            resultadoDiv.scrollIntoView({ behavior: 'smooth' });
        }

        // Inicializar quando o DOM estiver pronto
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar o quiz
            if (typeof inicializarQuiz === 'function') {
                inicializarQuiz();
            }
            
            // Inicializar a calculadora de comparação de ETFs
            const calcularBtn = document.getElementById('calcular-comparacao');
            const periodoInput = document.getElementById('periodo');
            
            if (calcularBtn) {
                calcularBtn.addEventListener('click', calcularComparacaoETFs);
            }
            
            if (periodoInput) {
                periodoInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        calcularComparacaoETFs();
                    }
                });
            }
            
            // Tabs: Questionários (8.9)
            const tabButtons = document.querySelectorAll('.tab-button');
            const panes = {
                quiz: document.getElementById('quiz-content'),
                simulador: document.getElementById('simulador-content'),
                desafios: document.getElementById('desafios-content'),
                flashcards: document.getElementById('flashcards-content')
            };
            tabButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    // Toggle active class on buttons
                    tabButtons.forEach(b => b.classList.remove('active', 'border-blue-500', 'text-blue-600'));
                    btn.classList.add('active', 'border-blue-500', 'text-blue-600');
                    // Show corresponding pane
                    Object.values(panes).forEach(p => p && p.classList.add('hidden'));
                    const key = btn.getAttribute('data-tab');
                    const pane = panes[key];
                    if (pane) pane.classList.remove('hidden');
                });
            });

            // Print button
            const printBtn = document.getElementById('printBtn');
            if (printBtn) {
                printBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    window.print();
                });
            }

            // Inicializar o Simulador de Alocação de Ativos (8.5)
            inicializarSimuladorAlocacao();
            // Inicializar Flashcards (Cap. 9)
            if (typeof inicializarFlashcards === 'function') {
                inicializarFlashcards();
            }
            
            // Inicializar o Comparador de Corretoras (8.6)
            inicializarComparadorCorretoras();
        });
        
        // Flashcards (Cap. 9)
        const FC_STORAGE_PREFIX = 'fc_progress_';
        const fcState = {
            decks: [],
            currentDeckId: null,
            order: [],
            pointer: 0,
            back: false,
            onlyUnknown: false,
            known: new Set()
        };

        function getFlashcardDecks() {
            try {
                return Object.values(topicData)
                    .filter(t => Array.isArray(t.flashcards) && t.flashcards.length > 0)
                    .map(t => ({ id: t.id, title: t.title || t.id, cards: t.flashcards }));
            } catch (e) {
                console.warn('topicData não disponível para flashcards');
                return [];
            }
        }

        function loadKnownSet(deckId) {
            try {
                const raw = localStorage.getItem(FC_STORAGE_PREFIX + deckId);
                return new Set(raw ? JSON.parse(raw) : []);
            } catch {
                return new Set();
            }
        }

        function saveKnownSet(deckId, set) {
            try {
                localStorage.setItem(FC_STORAGE_PREFIX + deckId, JSON.stringify(Array.from(set)));
            } catch {}
        }

        function inicializarFlashcards() {
            const container = document.getElementById('flashcards-content');
            if (!container) return;

            fcState.decks = getFlashcardDecks();
            const deckSelect = document.getElementById('fc-deck');
            if (deckSelect) {
                deckSelect.innerHTML = '';
                fcState.decks.forEach(d => {
                    const opt = document.createElement('option');
                    opt.value = d.id;
                    opt.textContent = d.title;
                    deckSelect.appendChild(opt);
                });
                if (fcState.decks.length > 0) {
                    fcState.currentDeckId = fcState.decks[0].id;
                    fcState.known = loadKnownSet(fcState.currentDeckId);
                    buildOrder();
                    renderFlashcard();
                }
                deckSelect.addEventListener('change', () => {
                    fcState.currentDeckId = deckSelect.value;
                    fcState.known = loadKnownSet(fcState.currentDeckId);
                    buildOrder();
                    renderFlashcard(true);
                });
            }

            const onlyUnknownCb = document.getElementById('fc-only-unknown');
            if (onlyUnknownCb) {
                onlyUnknownCb.checked = false;
                onlyUnknownCb.addEventListener('change', () => {
                    fcState.onlyUnknown = onlyUnknownCb.checked;
                    buildOrder();
                    renderFlashcard(true);
                });
            }

            const shuffleBtn = document.getElementById('fc-shuffle');
            if (shuffleBtn) shuffleBtn.addEventListener('click', () => { shuffleOrder(); renderFlashcard(true); });

            const resetBtn = document.getElementById('fc-reset');
            if (resetBtn) resetBtn.addEventListener('click', () => {
                if (!fcState.currentDeckId) return;
                fcState.known = new Set();
                saveKnownSet(fcState.currentDeckId, fcState.known);
                buildOrder();
                renderFlashcard(true);
            });

            const card = document.getElementById('fc-card');
            if (card) card.addEventListener('click', flipCard);

            const prevBtn = document.getElementById('fc-prev');
            const nextBtn = document.getElementById('fc-next');
            const toggleKnownBtn = document.getElementById('fc-toggle-known');
            if (prevBtn) prevBtn.addEventListener('click', prevCard);
            if (nextBtn) nextBtn.addEventListener('click', nextCard);
            if (toggleKnownBtn) toggleKnownBtn.addEventListener('click', toggleKnown);
        }

        function currentDeck() {
            return fcState.decks.find(d => d.id === fcState.currentDeckId);
        }

        function buildOrder() {
            const deck = currentDeck();
            if (!deck) { fcState.order = []; fcState.pointer = 0; return; }
            const allIdx = deck.cards.map((_, i) => i);
            const filtered = fcState.onlyUnknown ? allIdx.filter(i => !fcState.known.has(i)) : allIdx;
            fcState.order = filtered;
            fcState.pointer = 0;
            updateCountersAndProgress();
        }

        function shuffleOrder() {
            for (let i = fcState.order.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [fcState.order[i], fcState.order[j]] = [fcState.order[j], fcState.order[i]];
            }
            fcState.pointer = 0;
        }

        function flipCard() {
            fcState.back = !fcState.back;
            const front = document.getElementById('fc-face-front');
            const back = document.getElementById('fc-face-back');
            if (front && back) {
                if (fcState.back) {
                    front.classList.add('hidden');
                    back.classList.remove('hidden');
                } else {
                    back.classList.add('hidden');
                    front.classList.remove('hidden');
                }
            }
        }

        function prevCard() {
            if (fcState.pointer > 0) fcState.pointer--;
            fcState.back = false;
            renderFlashcard();
        }

        function nextCard() {
            if (fcState.pointer < fcState.order.length - 1) fcState.pointer++;
            fcState.back = false;
            renderFlashcard();
        }

        function toggleKnown() {
            const deck = currentDeck();
            if (!deck || fcState.order.length === 0) return;
            const idx = fcState.order[fcState.pointer];
            if (fcState.known.has(idx)) fcState.known.delete(idx); else fcState.known.add(idx);
            saveKnownSet(fcState.currentDeckId, fcState.known);
            updateCountersAndProgress();
            // Atualiza rótulo do botão
            const btn = document.getElementById('fc-toggle-known');
            if (btn) btn.innerHTML = (fcState.known.has(idx)
                ? '<i class="fas fa-times mr-1"></i> Desmarcar dominado'
                : '<i class="fas fa-check mr-1"></i> Marcar como dominado');
        }

        function renderFlashcard(force = false) {
            const deck = currentDeck();
            const frontEl = document.getElementById('fc-front-text');
            const backEl = document.getElementById('fc-back-text');
            const counter = document.getElementById('fc-counter');
            const toggleBtn = document.getElementById('fc-toggle-known');
            const frontFace = document.getElementById('fc-face-front');
            const backFace = document.getElementById('fc-face-back');
            if (!deck || fcState.order.length === 0) {
                if (frontEl) frontEl.textContent = 'Nenhum cartão disponível.';
                if (backEl) backEl.textContent = 'Ajuste o filtro ou selecione outro deck.';
                if (counter) counter.textContent = '0/0';
                if (toggleBtn) toggleBtn.disabled = true;
                return;
            }
            if (force) fcState.back = false;
            const cardIdx = fcState.order[fcState.pointer];
            const card = deck.cards[cardIdx];
            if (frontEl) frontEl.textContent = card.front;
            if (backEl) backEl.textContent = card.back;
            if (counter) counter.textContent = `${fcState.pointer + 1}/${fcState.order.length}`;
            if (toggleBtn) {
                toggleBtn.disabled = false;
                toggleBtn.innerHTML = (fcState.known.has(cardIdx)
                    ? '<i class="fas fa-times mr-1"></i> Desmarcar dominado'
                    : '<i class="fas fa-check mr-1"></i> Marcar como dominado');
            }
            // garantir faces corretas
            if (frontFace && backFace) {
                backFace.classList.add('hidden');
                frontFace.classList.remove('hidden');
            }
            updateCountersAndProgress();
        }

        function updateCountersAndProgress() {
            const deck = currentDeck();
            const bar = document.getElementById('fc-progress');
            const txt = document.getElementById('fc-progress-text');
            if (!deck || !bar || !txt) return;
            const total = deck.cards.length;
            const done = Math.min(fcState.known.size, total);
            const pct = total > 0 ? Math.round((done / total) * 100) : 0;
            bar.style.width = pct + '%';
            txt.textContent = pct + '%';
        }

        // Simulador de Alocação de Ativos (8.5)
        function inicializarSimuladorAlocacao() {
            const sliders = ['acoes-br', 'acoes-int', 'renda-fixa', 'cripto'];
            const aplicarBtn = document.getElementById('aplicar-alocacao');
            
            if (!aplicarBtn) return;
            
            // Atualizar valores dos sliders
            sliders.forEach(id => {
                const slider = document.getElementById(id);
                const valueSpan = document.getElementById(`${id}-value`);
                
                if (slider && valueSpan) {
                    // Atualizar valor exibido
                    valueSpan.textContent = `${slider.value}%`;
                    
                    // Atualizar quando o slider for movido
                    slider.addEventListener('input', function() {
                        valueSpan.textContent = `${this.value}%`;
                        atualizarTotalAlocacao();
                    });
                }
            });
            
            // Atualizar total alocado
            function atualizarTotalAlocacao() {
                let total = 0;
                sliders.forEach(id => {
                    const slider = document.getElementById(id);
                    if (slider) total += parseInt(slider.value);
                });
                
                const totalSpan = document.getElementById('total-alocado');
                const aviso = document.getElementById('alocacao-aviso');
                
                if (totalSpan) {
                    totalSpan.textContent = `${total}%`;
                    
                    // Atualizar estilo com base no total
                    if (total === 100) {
                        totalSpan.className = 'px-3 py-1 text-sm font-bold rounded-full bg-green-100 text-green-800';
                        if (aviso) aviso.classList.add('hidden');
                        if (aplicarBtn) aplicarBtn.disabled = false;
                    } else {
                        totalSpan.className = 'px-3 py-1 text-sm font-bold rounded-full bg-red-100 text-red-800';
                        if (aviso) aviso.classList.remove('hidden');
                        if (aplicarBtn) aplicarBtn.disabled = true;
                    }
                }
            }
            
            // Aplicar alocação
            if (aplicarBtn) {
                aplicarBtn.addEventListener('click', function() {
                    const alocacoes = {};
                    let totalInvestido = 0;
                    
                    sliders.forEach(id => {
                        const slider = document.getElementById(id);
                        if (slider) {
                            alocacoes[id] = parseInt(slider.value);
                            totalInvestido += alocacoes[id];
                        }
                    });
                    
                    if (totalInvestido === 100) {
                        atualizarGraficoAlocacao(alocacoes);
                        atualizarPerfilRisco(alocacoes);
                        mostrarDicasAlocacao(alocacoes);
                    }
                });
            }
            
            // Inicializar gráfico vazio
            inicializarGraficoAlocacao();
        }
        
        function inicializarGraficoAlocacao() {
            const ctx = document.getElementById('alocacao-chart');
            if (!ctx) return;
            
            // Verificar se o Chart já está definido
            if (typeof Chart === 'undefined') {
                console.warn('Chart.js não está carregado. O gráfico de alocação não será exibido.');
                return;
            }
            
            // Se já existir um gráfico, destrua-o
            if (window.alocacaoChart) {
                window.alocacaoChart.destroy();
            }
            
            // Criar gráfico vazio
            window.alocacaoChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Ações Nacionais', 'Ações Internacionais', 'Renda Fixa', 'Criptomoedas'],
                    datasets: [{
                        data: [0, 0, 0, 0],
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(99, 102, 241, 0.8)',
                            'rgba(16, 185, 129, 0.8)',
                            'rgba(245, 158, 11, 0.8)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                pointStyle: 'circle'
                            }
                        }
                    },
                    cutout: '70%'
                }
            });
        }
        
        function atualizarGraficoAlocacao(alocacoes) {
            if (!window.alocacaoChart) return;
            
            const data = [
                alocacoes['acoes-br'] || 0,
                alocacoes['acoes-int'] || 0,
                alocacoes['renda-fixa'] || 0,
                alocacoes['cripto'] || 0
            ];
            
            window.alocacaoChart.data.datasets[0].data = data;
            window.alocacaoChart.update();
        }
        
        function atualizarPerfilRisco(alocacoes) {
            // Calcular pontuação de risco (0 a 100)
            const riscoAcoesBr = alocacoes['acoes-br'] * 0.7;
            const riscoAcoesInt = alocacoes['acoes-int'] * 0.8;
            const riscoRendaFixa = alocacoes['renda-fixa'] * 0.2;
            const riscoCripto = alocacoes['cripto'] * 1.5;
            
            const riscoTotal = (riscoAcoesBr + riscoAcoesInt + riscoRendaFixa + riscoCripto) / 100;
            const riscoPercentual = Math.min(Math.max(Math.round(riscoTotal * 100), 10), 90); // Limitar entre 10% e 90%
            
            // Atualizar barra de risco
            const barraRisco = document.getElementById('barra-risco');
            const nivelRisco = document.getElementById('nivel-risco');
            const retornoEsperado = document.getElementById('retorno-esperado');
            
            if (barraRisco) barraRisco.style.width = `${riscoPercentual}%`;
            
            // Determinar nível de risco e retorno esperado
            let nivel, retorno;
            
            if (riscoPercentual < 30) {
                nivel = 'Conservador';
                retorno = '4-6% a.a.';
            } else if (riscoPercentual < 60) {
                nivel = 'Moderado';
                retorno = '7-9% a.a.';
            } else if (riscoPercentual < 80) {
                nivel = 'Arrojado';
                retorno = '10-12% a.a.';
            } else {
                nivel = 'Muito Arrojado';
                retorno = '13%+ a.a.';
            }
            
            if (nivelRisco) nivelRisco.textContent = nivel;
            if (retornoEsperado) retornoEsperado.textContent = retorno;
        }
        
        function mostrarDicasAlocacao(alocacoes) {
            const dicasContainer = document.getElementById('dicas-alocacao');
            const dicasConteudo = document.getElementById('dicas-conteudo');
            
            if (!dicasContainer || !dicasConteudo) return;
            
            const dicas = [];
            
            // Analisar alocação e gerar dicas
            if (alocacoes['cripto'] > 20) {
                dicas.push('Considere reduzir sua exposição a criptomoedas para menos de 20% do portfólio para reduzir o risco.');
            }
            
            if (alocacoes['renda-fixa'] < 10 && alocacoes['acoes-br'] + alocacoes['acoes-int'] > 70) {
                dicas.push('Uma alocação menor em renda fixa pode aumentar significativamente o risco da sua carteira.');
            }
            
            if (alocacoes['acoes-int'] < 20) {
                dicas.push('Considere aumentar sua exposição a ações internacionais para melhor diversificação geográfica.');
            }
            
            if (dicas.length === 0) {
                dicas.push('Sua alocação parece bem equilibrada para um investidor de perfil moderado.');
            }
            
            // Exibir dicas
            dicasConteudo.innerHTML = dicas.map(dica => `<p class="mb-2">• ${dica}</p>`).join('');
            dicasContainer.classList.remove('hidden');
        }
        
        // Comparador de Corretoras Internacionais (8.6)
        function inicializarComparadorCorretoras() {
            const filtrarBtn = document.getElementById('filtrar-corretoras');
            
            if (!filtrarBtn) return;
            
            // Dados de exemplo das corretoras
            const corretoras = [
                {
                    nome: 'Interactive Brokers',
                    taxas: 'Baixas',
                    atendimento: 'Bom',
                    plataforma: 'Avançada',
                    avaliacao: 4.5,
                    paises: ['BR', 'US', 'UK', 'PT'],
                    ativos: ['Ações EUA', 'ETFs Globais', 'Opções', 'Futuros']
                },
                {
                    nome: 'Avenue',
                    taxas: 'Médias',
                    atendimento: 'Excelente',
                    plataforma: 'Simples',
                    avaliacao: 4.2,
                    paises: ['BR'],
                    ativos: ['Ações EUA', 'ETFs Globais', 'REITs']
                },
                {
                    nome: 'TD Ameritrade',
                    taxas: 'Baixas',
                    atendimento: 'Bom',
                    plataforma: 'Avançada',
                    avaliacao: 4.6,
                    paises: ['US'],
                    ativos: ['Ações EUA', 'ETFs Globais', 'Opções', 'Futuros', 'Fundos Imobiliários']
                },
                {
                    nome: 'eToro',
                    taxas: 'Médias',
                    atendimento: 'Bom',
                    plataforma: 'Intermediária',
                    avaliacao: 4.0,
                    paises: ['BR', 'US', 'UK', 'PT'],
                    ativos: ['Ações EUA', 'ETFs Globais', 'Criptomoedas']
                }
            ];
            
            // Filtrar corretoras
            filtrarBtn.addEventListener('click', function() {
                const pais = document.getElementById('pais').value;
                const valor = parseFloat(document.getElementById('valor').value) || 0;
                const ativosSelect = document.querySelector('select[multiple]');
                const ativosSelecionados = Array.from(ativosSelect.selectedOptions).map(opt => opt.value);
                
                // Filtrar corretoras
                const corretorasFiltradas = corretoras.filter(corretora => {
                    // Filtrar por país
                    if (pais && !corretora.paises.includes(pais)) return false;
                    
                    // Filtrar por ativos selecionados
                    if (ativosSelecionados.length > 0) {
                        const temTodosAtivos = ativosSelecionados.every(ativo => 
                            corretora.ativos.includes(ativo)
                        );
                        if (!temTodosAtivos) return false;
                    }
                    
                    return true;
                });
                
                // Exibir resultados
                exibirCorretoras(corretorasFiltradas);
            });
            
            // Exibir corretoras na tabela
            function exibirCorretoras(corretoras) {
                const tbody = document.getElementById('tabela-corretoras');
                const semResultados = document.getElementById('sem-resultados');
                
                if (!tbody || !semResultados) return;
                
                // Limpar tabela
                tbody.innerHTML = '';
                
                if (corretoras.length === 0) {
                    semResultados.classList.remove('hidden');
                    return;
                }
                
                semResultados.classList.add('hidden');
                
                // Adicionar corretoras à tabela
                corretoras.forEach(corretora => {
                    const tr = document.createElement('tr');
                    
                    // Estrelas de avaliação
                    const estrelas = Array(5).fill('').map((_, i) => {
                        const cheia = i < Math.floor(corretora.avaliacao);
                        const meia = !cheia && (i === Math.floor(corretora.avaliacao)) && (corretora.avaliacao % 1 >= 0.5);
                        
                        if (cheia) return '<i class="fas fa-star text-yellow-400"></i>';
                        if (meia) return '<i class="fas fa-star-half-alt text-yellow-400"></i>';
                        return '<i class="far fa-star text-yellow-400"></i>';
                    }).join('');
                    
                    tr.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <div class="text-sm font-medium text-gray-900">${corretora.nome}</div>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="text-sm text-gray-900">${corretora.taxas}</div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                ${corretora.atendimento}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            ${corretora.plataforma}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <div class="mr-2 text-yellow-400">
                                    ${estrelas}
                                </div>
                                <span class="text-sm text-gray-600">${corretora.avaliacao.toFixed(1)}</span>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                            <a href="#" class="text-blue-600 hover:text-blue-900">Detalhes</a>
                        </td>
                    `;
                    
                    tbody.appendChild(tr);
                });
            }
            
            // Exibir todas as corretoras inicialmente
            exibirCorretoras(corretoras);
        }
        
        // Inicializar o simulador de aposentadoria
        function inicializarSimuladorAposentadoria() {
            const calcularBtn = document.getElementById('calcular-aposentadoria');
            const retornoAnual = document.getElementById('retorno-anual');
            const retornoAnualValue = document.getElementById('retorno-anual-value');
            const inflacao = document.getElementById('inflacao');
            const inflacaoValue = document.getElementById('inflacao-value');
            
            if (!calcularBtn) return;
            
            // Atualizar valores exibidos
            if (retornoAnual && retornoAnualValue) {
                retornoAnualValue.textContent = `${retornoAnual.value}%`;
                retornoAnual.addEventListener('input', function() {
                    retornoAnualValue.textContent = `${this.value}%`;
                });
            }
            
            if (inflacao && inflacaoValue) {
                inflacaoValue.textContent = `${inflacao.value}%`;
                inflacao.addEventListener('input', function() {
                    inflacaoValue.textContent = `${this.value}%`;
                });
            }
            
            // Calcular aposentadoria
            calcularBtn.addEventListener('click', calcularAposentadoria);
        }
        
        function calcularAposentadoria() {
            // Obter valores dos inputs
            const idadeAtual = parseInt(document.getElementById('idade-atual').value) || 30;
            const idadeAposentadoria = parseInt(document.getElementById('idade-aposentadoria').value) || 65;
            const poupancaAtual = parseFloat(document.getElementById('poupanca-atual').value) || 0;
            const rendaMensalDesejada = parseFloat(document.getElementById('renda-mensal-desejada').value) || 10000;
            const retornoAnual = parseFloat(document.getElementById('retorno-anual').value) / 100 || 0.08;
            const inflacao = parseFloat(document.getElementById('inflacao').value) / 100 || 0.045;
            
            // Validar idades
            if (idadeAposentadoria <= idadeAtual) {
                alert('A idade de aposentadoria deve ser maior que a idade atual.');
                return;
            }
            
            // Calcular variáveis
            const anosParaAposentar = idadeAposentadoria - idadeAtual;
            const taxaReal = (1 + retornoAnual) / (1 + inflacao) - 1;
            const mesesParaAposentar = anosParaAposentar * 12;
            const rendaAnualDesejada = rendaMensalDesejada * 12;
            
            // Calcular valor necessário na aposentadoria (usando a regra dos 4%)
            const valorNecessario = rendaAnualDesejada * 25; // 4% de retorno anual = 25x o valor anual desejado
            
            // Calcular aporte mensal necessário
            let aporteMensal = 0;
            if (taxaReal !== 0) {
                const fator = Math.pow(1 + taxaReal, anosParaAposentar);
                aporteMensal = (valorNecessario - poupancaAtual * Math.pow(1 + retornoAnual, anosParaAposentar)) * (taxaReal / 12) / (fator - 1);
            } else {
                aporteMensal = (valorNecessario - poupancaAtual) / mesesParaAposentar;
            }
            
            // Arredondar valores
            aporteMensal = Math.max(0, Math.round(aporteMensal * 100) / 100);
            const valorTotalInvestido = Math.round(poupancaAtual + (aporteMensal * mesesParaAposentar));
            
            // Exibir resultados
            const resultadoDiv = document.getElementById('resultado-aposentadoria');
            if (resultadoDiv) {
                resultadoDiv.innerHTML = `
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-gray-600">Tempo até a aposentadoria:</span>
                            <span class="font-semibold">${anosParaAposentar} anos</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Valor necessário:</span>
                            <span class="font-semibold">R$ ${valorNecessario.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Valor já poupado:</span>
                            <span class="font-semibold">R$ ${poupancaAtual.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                        <div class="pt-4 mt-4 border-t border-gray-200">
                            <p class="text-sm text-gray-600 mb-2">Para atingir sua meta, você precisa economizar:</p>
                            <div class="text-2xl font-bold text-blue-600">R$ ${aporteMensal.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <p class="text-sm text-gray-500 mt-1">por mês pelos próximos ${anosParaAposentar} anos</p>
                        </div>
                        <div class="bg-blue-50 p-3 rounded-md mt-4">
                            <p class="text-sm text-blue-800">💡 <span class="font-medium">Dica:</span> Considere aumentar seus aportes anualmente para acompanhar a inflação.</p>
                        </div>
                    </div>
                `;
            }
            
            // Atualizar gráfico
            atualizarGraficoAposentadoria(anosParaAposentar, poupancaAtual, aporteMensal, retornoAnual);
        }
        
        function atualizarGraficoAposentadoria(anos, valorInicial, aporteMensal, taxaAnual) {
            const ctx = document.getElementById('grafico-aposentadoria');
            if (!ctx) return;
            
            // Verificar se o Chart já está definido
            if (typeof Chart === 'undefined') {
                console.warn('Chart.js não está carregado. O gráfico de aposentadoria não será exibido.');
                return;
            }
            
            // Se já existir um gráfico, destrua-o
            if (window.aposentadoriaChart) {
                window.aposentadoriaChart.destroy();
            }
            
            // Calcular dados para o gráfico
            const labels = [];
            const valores = [];
            let valorAtual = valorInicial;
            const taxaMensal = Math.pow(1 + taxaAnual, 1/12) - 1;
            
            for (let i = 0; i <= anos; i++) {
                labels.push(`Ano ${i}`);
                valores.push(valorAtual);
                
                // Calcular valor para o próximo ano
                for (let m = 0; m < 12; m++) {
                    valorAtual = (valorAtual + aporteMensal) * (1 + taxaMensal);
                }
            }
            
            // Criar gráfico
            window.aposentadoriaChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Patrimônio Acumulado',
                        data: valores,
                        borderColor: 'rgba(59, 130, 246, 0.8)',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `R$ ${context.raw.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'R$ ' + (value / 1000).toFixed(0) + 'k';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Inicializar análise fundamentalista
        function inicializarAnaliseFundamentalista() {
            const calcularBtn = document.getElementById('calcular-indices');
            if (!calcularBtn) return;
            
            calcularBtn.addEventListener('click', calcularIndices);
        }
        
        function calcularIndices() {
            // Obter valores dos inputs
            const ticker = document.getElementById('ticker').value || 'EMPRESA';
            const precoAtivo = parseFloat(document.getElementById('preco-ativo').value) || 0;
            const dividendos = parseFloat(document.getElementById('dividendos').value) || 0;
            const receitaLiquida = parseFloat(document.getElementById('receita-liquida').value) || 0;
            const lucroLiquido = parseFloat(document.getElementById('lucro-liquido').value) || 0;
            const patrimonioLiquido = parseFloat(document.getElementById('patrimonio-liquido').value) || 0;
            const dividaLiquida = parseFloat(document.getElementById('divida-liquida').value) || 0;
            const acoesTotais = parseFloat(document.getElementById('acoes-totais').value) || 0;
            
            // Calcular índices
            const ebitda = lucroLiquido * 1.5; // Aproximação
            const valorMercado = precoAtivo * acoesTotais / 1000000; // Em milhões
            const valorEmpresa = valorMercado + dividaLiquida; // EV = Valor de Mercado + Dívida Líquida
            const lucroPorAcao = acoesTotais > 0 ? (lucroLiquido * 1000000) / acoesTotais : 0;
            const vpa = acoesTotais > 0 ? (patrimonioLiquido * 1000000) / acoesTotais : 0;
            
            // Calcular indicadores
            const roe = patrimonioLiquido > 0 ? (lucroLiquido / patrimonioLiquido) * 100 : 0;
            const roa = receitaLiquida > 0 ? (lucroLiquido / receitaLiquida) * 100 : 0;
            const roic = (receitaLiquida + dividaLiquida) > 0 ? (lucroLiquido / (patrimonioLiquido + dividaLiquida)) * 100 : 0;
            const dividaEbitda = ebitda > 0 ? dividaLiquida / ebitda : 0;
            const dividaPl = patrimonioLiquido > 0 ? dividaLiquida / patrimonioLiquido : 0;
            const pl = lucroPorAcao > 0 ? precoAtivo / lucroPorAcao : 0;
            const pvp = vpa > 0 ? precoAtivo / vpa : 0;
            const evebitda = ebitda > 0 ? valorEmpresa / ebitda : 0;
            const dy = precoAtivo > 0 ? (dividendos / precoAtivo) * 100 : 0;
            const payout = lucroPorAcao > 0 ? (dividendos / lucroPorAcao) * 100 : 0;
            
            // Atualizar a interface
            document.getElementById('nome-empresa').textContent = ticker;
            document.getElementById('roe').textContent = roe.toFixed(2) + '%';
            document.getElementById('roa').textContent = roa.toFixed(2) + '%';
            document.getElementById('roic').textContent = roic.toFixed(2) + '%';
            document.getElementById('divida-ebitda').textContent = dividaEbitda.toFixed(2) + 'x';
            document.getElementById('divida-pl').textContent = dividaPl.toFixed(2) + 'x';
            document.getElementById('liquidez').textContent = 'N/A';
            document.getElementById('pl').textContent = pl.toFixed(2) + 'x';
            document.getElementById('pvp').textContent = pvp.toFixed(2) + 'x';
            document.getElementById('evebitda').textContent = evebitda.toFixed(2) + 'x';
            document.getElementById('dy').textContent = dy.toFixed(2) + '%';
            document.getElementById('payout').textContent = payout.toFixed(2) + '%';
            document.getElementById('cagr').textContent = 'N/A';
            
            // Gerar análise
            let analise = '';
            let pontuacao = 0;
            
            // Análise de rentabilidade
            if (roe > 20) { analise += 'A empresa apresenta excelente rentabilidade sobre o patrimônio líquido (ROE elevado). '; pontuacao += 2; }
            else if (roe > 10) { analise += 'A rentabilidade sobre o patrimônio líquido (ROE) está em níveis aceitáveis. '; pontuacao += 1; }
            else { analise += 'A rentabilidade sobre o patrimônio líquido (ROE) está baixa. '; }
            
            // Análise de endividamento
            if (dividaEbitda < 2) { analise += 'O nível de endividamento é baixo em relação ao EBITDA. '; pontuacao += 2; }
            else if (dividaEbitda < 4) { analise += 'O nível de endividamento está em patamares moderados. '; pontuacao += 1; }
            else { analise += 'O nível de endividamento está elevado em relação ao EBITDA. '; }
            
            // Análise de avaliação
            if (pl < 10) { analise += 'A empresa está com avaliação atrativa em termos de P/L. '; pontuacao += 2; }
            else if (pl < 20) { analise += 'A avaliação da empresa está em níveis razoáveis. '; pontuacao += 1; }
            else { analise += 'A avaliação da empresa parece elevada em termos de P/L. '; }
            
            // Análise de dividendos
            if (dy > 6) { analise += 'O rendimento de dividendos é atrativo. '; pontuacao += 2; }
            else if (dy > 3) { analise += 'O rendimento de dividendos está em níveis moderados. '; pontuacao += 1; }
            else { analise += 'O rendimento de dividendos está baixo. '; }
            
            // Recomendação final
            let recomendacao = '';
            let corRecomendacao = '';
            let porcentagemBarra = 0;
            
            if (pontuacao >= 7) {
                recomendacao = 'COMPRA';
                corRecomendacao = 'bg-green-100 text-green-800';
                porcentagemBarra = 100;
                analise += 'No geral, a empresa apresenta fundamentos sólidos para investimento de longo prazo.';
            } else if (pontuacao >= 4) {
                recomendacao = 'NEUTRO';
                corRecomendacao = 'bg-yellow-100 text-yellow-800';
                porcentagemBarra = 50;
                analise += 'A empresa apresenta aspectos positivos, mas recomenda-se cautela e análise mais aprofundada.';
            } else {
                recomendacao = 'VENDA';
                corRecomendacao = 'bg-red-100 text-red-800';
                porcentagemBarra = 10;
                analise += 'Recomenda-se cautela ao investir, pois a empresa apresenta fundamentos fracos.';
            }
            
            // Atualizar análise e recomendação
            document.getElementById('analise-texto').textContent = analise;
            const elementoRecomendacao = document.getElementById('recomendacao');
            if (elementoRecomendacao) {
                elementoRecomendacao.textContent = recomendacao;
                elementoRecomendacao.className = `px-3 py-1 rounded-full text-sm font-medium ${corRecomendacao}`;
            }
            
            const barraRecomendacao = document.getElementById('barra-recomendacao');
            if (barraRecomendacao) {
                barraRecomendacao.style.width = `${porcentagemBarra}%`;
                barraRecomendacao.className = `h-2.5 rounded-full ${porcentagemBarra > 66 ? 'bg-green-500' : porcentagemBarra > 33 ? 'bg-yellow-400' : 'bg-red-500'}`;
            }
            
            // Mostrar a seção de resultados
            document.getElementById('resultado-analise').classList.remove('hidden');
        }
        
        // Utilitário: inicializar tooltips (seguro sem dependências)
        function inicializarTooltips() {
            try {
                if (DISABLE_ENHANCED_TOOLTIPS || typeof tippy !== 'function') return; // Desativado
                const elements = Array.from(document.querySelectorAll('[data-tippy-content], [aria-label][data-tooltip], [data-tooltip]'));
                if (elements.length === 0) return;
                elements.forEach(el => {
                    const content = el.getAttribute('data-tippy-content') || el.getAttribute('aria-label') || el.getAttribute('data-tooltip');
                    if (!content) return;
                    tippy(el, {
                        content,
                        theme: document.documentElement.classList.contains('dark') ? 'light' : 'light',
                        animation: 'shift-away-subtle',
                        delay: [100, 0],
                        arrow: true,
                    });
                });
            } catch (e) {
                // nunca quebrar a UI por causa de tooltip
            }
        }

        // Inicializar todos os componentes quando o DOM estiver pronto
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar tooltips
            inicializarTooltips();
            
            // Inicializar o quiz de perfil de investidor
            inicializarQuizPerfilInvestidor();
            
            // Inicializar o simulador de investimentos
            if (document.getElementById('simulador-investimentos')) {
                inicializarSimuladorInvestimentos();
            }
            
            // Inicializar os desafios mensais
            if (document.getElementById('desafios-mensais')) {
                inicializarDesafiosMensais();
            }
            
            // Inicializar análise fundamentalista
            inicializarAnaliseFundamentalista();
            
            // Inicializar questionários interativos
            inicializarQuestionarios();

            // Aplicar tema salvo e configurar alternância de tema
            applySavedTheme();
            initThemeToggle();

            // Inicializar progresso de capítulos com persistência
            initChapterProgress();
        });
        
        // ====================================================
        // CÓDIGO PARA OS QUESTIONÁRIOS INTERATIVOS (SEÇÃO 8.9)
        // ====================================================

        // ===============================
        // TEMA (DARK/LIGHT) COM PERSISTÊNCIA
        // ===============================
        function applySavedTheme() {
            try {
                const stored = localStorage.getItem('theme');
                const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                const shouldDark = stored ? stored === 'dark' : prefersDark;
                const root = document.documentElement;
                if (shouldDark) {
                    root.classList.add('dark');
                } else {
                    root.classList.remove('dark');
                }
                updateThemeIcon();
            } catch (e) {
                // Falha no localStorage não deve quebrar a UI
                updateThemeIcon();
            }
        }

        function updateThemeIcon() {
            const icon = document.getElementById('themeIcon');
            if (!icon) return;
            const isDark = document.documentElement.classList.contains('dark');
            icon.classList.toggle('fa-moon', !isDark);
            icon.classList.toggle('fa-sun', isDark);
        }

        function initThemeToggle() {
            const btn = document.getElementById('themeToggle');
            if (!btn) return;
            btn.addEventListener('click', () => {
                const root = document.documentElement;
                const isDark = root.classList.toggle('dark');
                try {
                    localStorage.setItem('theme', isDark ? 'dark' : 'light');
                } catch (e) { /* ignorar */ }
                updateThemeIcon();
            });
            // Atualizar ícone se o sistema mudar a preferência
            if (window.matchMedia) {
                const mq = window.matchMedia('(prefers-color-scheme: dark)');
                if (mq.addEventListener) {
                    mq.addEventListener('change', () => applySavedTheme());
                } else if (mq.addListener) {
                    // Safari antigo
                    mq.addListener(() => applySavedTheme());
                }
            }
        }

        // ==============================================
        // PROGRESSO DE CAPÍTULOS COM INTERSECTIONOBSERVER
        // ==============================================
        function initChapterProgress() {
            const indicator = document.getElementById('chaptersIndicator');
            if (!indicator) return;

            const chapterIds = Array.from({ length: 10 }, (_, i) => `cap${i + 1}`);
            const sections = chapterIds
                .map(id => document.getElementById(id))
                .filter(Boolean);

            // Restaurar progresso salvo
            let completed = new Set();
            try {
                const saved = JSON.parse(localStorage.getItem('chaptersCompleted') || '[]');
                if (Array.isArray(saved)) completed = new Set(saved);
            } catch (e) { /* ignorar */ }

            function persist() {
                try { localStorage.setItem('chaptersCompleted', JSON.stringify(Array.from(completed))); } catch (e) { /* ignorar */ }
            }

            function updateIndicator() {
                indicator.textContent = `${completed.size}/${chapterIds.length}`;
            }

            // Inicial update com progresso salvo
            updateIndicator();

            // Observer para marcar capítulo como concluído quando a seção ficar bem visível
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (!entry.isIntersecting) return;
                    const id = entry.target.id;
                    // Considerar como concluído quando ao menos 60% visível
                    if (entry.intersectionRatio >= 0.6) {
                        if (!completed.has(id)) {
                            completed.add(id);
                            persist();
                            updateIndicator();
                        }
                    }
                });
            }, { threshold: [0.6], rootMargin: '0px 0px -10% 0px' });

            sections.forEach(sec => observer.observe(sec));
        }
        
        /**
         * Inicializa todos os questionários interativos
         */
        function inicializarQuestionarios() {
            // Inicializar o quiz de perfil de investidor
            inicializarQuizPerfilInvestidor();
            
            // Inicializar o simulador de investimentos
            inicializarSimuladorInvestimentos();
            
            // Inicializar os tabs dos questionários
            inicializarTabsQuestionarios();
        }
        
        /**
         * Inicializa a navegação por abas dos questionários
         */
        function inicializarTabsQuestionarios() {
            const tabs = document.querySelectorAll('[data-tab]');
            const tabContents = document.querySelectorAll('[data-tab-content]');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const target = tab.getAttribute('data-tab');
                    
                    // Atualizar tabs ativas
                    tabs.forEach(t => t.classList.remove('bg-primary-600', 'text-white'));
                    tab.classList.add('bg-primary-600', 'text-white');
                    
                    // Mostrar conteúdo da aba selecionada
                    tabContents.forEach(content => {
                        if (content.id === target) {
                            content.classList.remove('hidden');
                        } else {
                            content.classList.add('hidden');
                        }
                    });
                });
            });
            
            // Ativar a primeira aba por padrão
            if (tabs.length > 0) {
                tabs[0].click();
            }
        }
        
        // ===========================================
        // QUIZ DE PERFIL DE INVESTIDOR
        // ===========================================
        
        /**
         * Inicializa o quiz de perfil de investidor
         */
        function inicializarQuizPerfilInvestidor() {
            const quizContainer = document.getElementById('quiz-perfil-investidor');
            if (!quizContainer) return;
            
            // Configuração do quiz
            const quizData = [
                {
                    pergunta: "Qual é o seu objetivo principal ao investir?",
                    opcoes: [
                        { texto: "Preservar meu capital, mesmo que isso signifique baixos retornos", valor: 1 },
                        { texto: "Obter uma renda estável com algum potencial de crescimento", valor: 2 },
                        { texto: "Crescer meu capital ao longo do tempo, aceitando alguma volatilidade", valor: 3 },
                        { texto: "Maximizar meus retornos no longo prazo, aceitando alta volatilidade", valor: 4 }
                    ]
                },
                {
                    pergunta: "Por quanto tempo você pretende manter seus investimentos?",
                    opcoes: [
                        { texto: "Até 1 ano", valor: 1 },
                        { texto: "De 1 a 3 anos", valor: 2 },
                        { texto: "De 3 a 5 anos", valor: 3 },
                        { texto: "Mais de 5 anos", valor: 4 }
                    ]
                },
                {
                    pergunta: "Como você reagiria a uma queda de 20% no valor dos seus investimentos em um curto período?",
                    opcoes: [
                        { texto: "Venderia tudo para evitar mais perdas", valor: 1 },
                        { texto: "Venderia parte para reduzir o risco", valor: 2 },
                        { texto: "Manteria meus investimentos e aguardaria a recuperação", valor: 3 },
                        { texto: "Aproveitaria para comprar mais, já que estão mais baratos", valor: 4 }
                    ]
                },
                {
                    pergunta: "Qual percentual de perda você estaria disposto a aceitar em um ano?",
                    opcoes: [
                        { texto: "Até 5%", valor: 1 },
                        { texto: "Entre 5% e 10%", valor: 2 },
                        { texto: "Entre 10% e 20%", valor: 3 },
                        { texto: "Mais de 20%", valor: 4 }
                    ]
                },
                {
                    pergunta: "Qual é a sua principal fonte de renda?",
                    opcoes: [
                        { texto: "Aposentadoria ou renda fixa", valor: 1 },
                        { texto: "Salário estável", valor: 2 },
                        { texto: "Renda variável ou comissões", valor: 3 },
                        { texto: "Negócio próprio ou investimentos", valor: 4 }
                    ]
                },
                {
                    pergunta: "Qual é o seu conhecimento sobre investimentos?",
                    opcoes: [
                        { texto: "Iniciante - Estou começando a aprender", valor: 1 },
                        { texto: "Básico - Entendo os conceitos fundamentais", valor: 2 },
                        { texto: "Intermediário - Tenho experiência com diferentes tipos de investimentos", valor: 3 },
                        { texto: "Avançado - Tenho conhecimento aprofundado e experiência significativa", valor: 4 }
                    ]
                }
            ];
            
            // Variáveis do quiz
            let respostas = [];
            let perguntaAtual = 0;
            
            // Elementos da interface
            const containerPerguntas = document.getElementById('quiz-perguntas');
            const botaoAnterior = document.getElementById('quiz-anterior');
            const botaoProximo = document.getElementById('quiz-proximo');
            const botaoEnviar = document.getElementById('quiz-enviar');
            const barraProgresso = document.getElementById('quiz-progresso');
            const contadorPerguntas = document.getElementById('quiz-contador');
            const resultadoQuiz = document.getElementById('quiz-resultado');
            const botaoReiniciar = document.getElementById('quiz-reiniciar');
            
            // Inicializar o quiz
            function iniciarQuiz() {
                respostas = new Array(quizData.length).fill(null);
                perguntaAtual = 0;
                mostrarPergunta();
                atualizarBotoes();
                atualizarBarraProgresso();
                resultadoQuiz.classList.add('hidden');
            }
            
            // Mostrar a pergunta atual
            function mostrarPergunta() {
                if (perguntaAtual < 0 || perguntaAtual >= quizData.length) return;
                
                const pergunta = quizData[perguntaAtual];
                
                // Atualizar contador
                contadorPerguntas.textContent = `Pergunta ${perguntaAtual + 1} de ${quizData.length}`;
                
                // Criar HTML da pergunta
                let html = `
                    <div class="mb-6">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">${pergunta.pergunta}</h3>
                        <div class="space-y-3">
                `;
                
                // Adicionar opções de resposta
                pergunta.opcoes.forEach((opcao, index) => {
                    const respostaSelecionada = respostas[perguntaAtual] === opcao.valor ? 'bg-blue-50 border-blue-500' : 'border-gray-300';
                    html += `
                        <label class="flex items-center p-3 border rounded-lg cursor-pointer hover:bg-gray-50 ${respostaSelecionada}">
                            <input type="radio" name="resposta" value="${opcao.valor}" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300" ${respostas[perguntaAtual] === opcao.valor ? 'checked' : ''}>
                            <span class="ml-3 block text-sm font-medium text-gray-700">${opcao.texto}</span>
                        </label>
                    `;
                });
                
                html += `
                        </div>
                    </div>
                `;
                
                containerPerguntas.innerHTML = html;
                
                // Adicionar eventos aos radios
                const radios = containerPerguntas.querySelectorAll('input[type="radio"]');
                radios.forEach(radio => {
                    radio.addEventListener('change', (e) => {
                        respostas[perguntaAtual] = parseInt(e.target.value);
                        atualizarBotoes();
                    });
                });
                
                // Rolar para o topo
                containerPerguntas.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            
            // Atualizar estado dos botões de navegação
            function atualizarBotoes() {
                // Botão Anterior
                if (perguntaAtual === 0) {
                    botaoAnterior.classList.add('opacity-50', 'cursor-not-allowed');
                    botaoAnterior.disabled = true;
                } else {
                    botaoAnterior.classList.remove('opacity-50', 'cursor-not-allowed');
                    botaoAnterior.disabled = false;
                }
                
                // Botão Próximo/Enviar
                if (perguntaAtual === quizData.length - 1) {
                    botaoProximo.classList.add('hidden');
                    botaoEnviar.classList.remove('hidden');
                    botaoEnviar.disabled = respostas[perguntaAtual] === null;
                } else {
                    botaoProximo.classList.remove('hidden');
                    botaoEnviar.classList.add('hidden');
                    botaoProximo.disabled = respostas[perguntaAtual] === null;
                }
                
                // Atualizar barra de progresso
                atualizarBarraProgresso();
            }
            
            // Atualizar barra de progresso
            function atualizarBarraProgresso() {
                const progresso = ((perguntaAtual + 1) / quizData.length) * 100;
                barraProgresso.style.width = `${progresso}%`;
            }
            
            // Mostrar resultado do quiz
            function mostrarResultado() {
                // Calcular pontuação total
                const pontuacao = respostas.reduce((total, valor) => total + (valor || 0), 0);
                const pontuacaoMaxima = quizData.length * 4;
                const percentual = Math.round((pontuacao / pontuacaoMaxima) * 100);
                
                // Determinar perfil com base na pontuação
                let perfil, descricao, cor, recomendacoes, faixa, risco;
                
                if (percentual < 30) {
                    perfil = "Conservador";
                    faixa = "Até 30% em renda variável";
                    risco = "Baixo";
                    cor = "bg-green-100 text-green-800";
                    descricao = "Você prefere segurança e liquidez em seus investimentos, aceitando retornos menores em troca de menor risco. Seu foco principal é preservar seu capital.";
                    recomendacoes = [
                        "Tesouro Direto (SELIC, IPCA+)",
                        "CDBs de bancos grandes",
                        "LCI/LCA",
                        "Fundos de renda fixa",
                        "Até 30% em fundos multimercado conservadores"
                    ];
                } else if (percentual < 55) {
                    perfil = "Moderado";
                    faixa = "30% a 60% em renda variável";
                    risco = "Médio";
                    cor = "bg-blue-100 text-blue-800";
                    descricao = "Você busca um equilíbrio entre risco e retorno, aceitando alguma volatilidade em troca de retornos potencialmente maiores no médio prazo.";
                    recomendacoes = [
                        "Fundos de investimento balanceados",
                        "ETFs de índices amplos",
                        "Ações de empresas sólidas (blue chips)",
                        "Fundos imobiliários",
                        "Até 60% em renda variável"
                    ];
                } else if (percentual < 80) {
                    perfil = "Arrojado";
                    faixa = "60% a 85% em renda variável";
                    risco = "Alto";
                    cor = "bg-yellow-100 text-yellow-800";
                    descricao = "Você está disposto a assumir riscos significativos em busca de retornos acima da média, com um horizonte de investimento de médio a longo prazo.";
                    recomendacoes = [
                        "Ações individuais",
                        "Fundos de ações",
                        "ETFs setoriais",
                        "Fundos imobiliários",
                        "Até 85% em renda variável"
                    ];
                } else {
                    perfil = "Agressivo";
                    faixa = "Acima de 85% em renda variável";
                    risco = "Muito Alto";
                    cor = "bg-red-100 text-red-800";
                    descricao = "Você busca os maiores retornos possíveis e está disposto a enfrentar alta volatilidade e riscos significativos. Tem um horizonte de investimento de longo prazo e alta tolerância a perdas temporárias.";
                    recomendacoes = [
                        "Ações de pequenas empresas",
                        "Ações internacionais",
                        "Criptomoedas (pequena parcela)",
                        "Startups e private equity",
                        "Acima de 85% em renda variável"
                    ];
                }
                
                // Gerar HTML do resultado
                let html = `
                    <div class="text-center mb-8">
                        <div class="inline-flex items-center px-4 py-2 rounded-full text-sm font-medium ${cor} mb-4">
                            Seu perfil de investidor é: <span class="font-bold ml-1">${perfil}</span>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-900 mb-4">${perfil} - Nível de Risco: ${risco}</h3>
                        <p class="text-gray-700 mb-6 max-w-3xl mx-auto">${descricao}</p>
                        
                        <div class="grid md:grid-cols-3 gap-6 mb-8 max-w-4xl mx-auto">
                            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                                <div class="text-3xl font-bold text-primary-600 mb-2">${percentual}%</div>
                                <div class="text-sm text-gray-600">Perfil de Risco</div>
                            </div>
                            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                                <div class="text-xl font-bold text-gray-900 mb-2">${faixa}</div>
                                <div class="text-sm text-gray-600">Alocação Sugerida</div>
                            </div>
                            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                                <div class="text-xl font-bold text-gray-900 mb-2">${risco}</div>
                                <div class="text-sm text-gray-600">Nível de Risco</div>
                            </div>
                        </div>
                        
                        <div class="bg-blue-50 p-4 rounded-lg text-left max-w-3xl mx-auto mb-8">
                            <h4 class="font-semibold text-lg text-blue-800 mb-3 flex items-center">
                                <svg class="h-5 w-5 text-blue-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h2a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                </svg>
                                Recomendações de Alocação
                            </h4>
                            <ul class="space-y-2">
                                ${recomendacoes.map(item => `<li class="flex items-start">
                                    <svg class="h-5 w-5 text-green-500 mr-2 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                                    </svg>
                                    <span>${item}</span>
                                </li>`).join('')}
                            </ul>
                        </div>
                        
                        <div class="text-center">
                            <button id="quiz-reiniciar" class="px-6 py-3 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 transition-colors">
                                Fazer o teste novamente
                            </button>
                        </div>
                    </div>
                `;
                
                // Exibir resultado
                document.getElementById('quiz-container').classList.add('hidden');
                resultadoQuiz.innerHTML = html;
                resultadoQuiz.classList.remove('hidden');
                
                // Adicionar evento ao botão de reiniciar
                document.getElementById('quiz-reiniciar').addEventListener('click', iniciarQuiz);
                
                // Rolar para o resultado
                resultadoQuiz.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            
            // Event listeners
            botaoAnterior.addEventListener('click', () => {
                if (perguntaAtual > 0) {
                    perguntaAtual--;
                    mostrarPergunta();
                    atualizarBotoes();
                }
            });
            
            botaoProximo.addEventListener('click', () => {
                if (respostas[perguntaAtual] !== null) {
                    perguntaAtual++;
                    mostrarPergunta();
                    atualizarBotoes();
                }
            });
            
            botaoEnviar.addEventListener('click', () => {
                if (respostas[perguntaAtual] !== null) {
                    mostrarResultado();
                }
            });
            
            // Iniciar o quiz quando a página carregar
            iniciarQuiz();
        }
        
        // ===========================================
        // SIMULADOR DE INVESTIMENTOS
        // ===========================================
        
        /**
         * Inicializa o simulador de investimentos
         */
        function inicializarSimuladorInvestimentos() {
            const simuladorContainer = document.getElementById('simulador-investimentos');
            if (!simuladorContainer) return;
            
            // Configuração dos níveis de investimento
            const niveisInvestimento = {
                'iniciante': {
                    titulo: 'Iniciante',
                    descricao: 'Investimentos conservadores com baixo risco e liquidez',
                    opcoes: [
                        { nome: 'Tesouro Selic', retornoAnual: 0.12, risco: 'Baixo', liquidez: 'Alta' },
                        { nome: 'CDB 100% CDI', retornoAnual: 0.13, risco: 'Baixo', liquidez: 'Média' },
                        { nome: 'LCI/LCA 90% CDI', retornoAnual: 0.11, risco: 'Baixo', liquidez: 'Baixa' }
                    ]
                },
                'intermediario': {
                    titulo: 'Intermediário',
                    descricao: 'Estratégias balanceadas entre risco e retorno',
                    opcoes: [
                        { nome: 'Fundos Multimercado', retornoAnual: 0.18, risco: 'Médio', liquidez: 'Média' },
                        { nome: 'Fundos Imobiliários', retornoAnual: 0.15, risco: 'Médio', liquidez: 'Alta' },
                        { nome: 'Ações Blue Chips', retornoAnual: 0.22, risco: 'Médio-Alto', liquidez: 'Alta' }
                    ]
                },
                'avancado': {
                    titulo: 'Avançado',
                    descricao: 'Estratégias arrojadas com maior potencial de retorno e risco',
                    opcoes: [
                        { nome: 'Ações Small Caps', retornoAnual: 0.30, risco: 'Alto', liquidez: 'Média' },
                        { nome: 'Startups (Private Equity)', retornoAnual: 0.40, risco: 'Muito Alto', liquidez: 'Baixa' },
                        { nome: 'Criptomoedas', retornoAnual: 0.60, risco: 'Altíssimo', liquidez: 'Alta' }
                    ]
                }
            };
            
            // Elementos da interface
            const cardsNivel = document.querySelectorAll('.simulador-card');
            const containerSimulacao = document.getElementById('simulador-simulacao');
            const formularioSimulacao = document.getElementById('simulador-formulario');
            const resultadoSimulacao = document.getElementById('simulador-resultado');
            
            // Variáveis do simulador
            let nivelSelecionado = null;
            let opcaoSelecionada = null;
            
            // Inicializar cards de nível
            cardsNivel.forEach(card => {
                card.addEventListener('click', () => {
                    const nivel = card.getAttribute('data-nivel');
                    selecionarNivel(nivel);
                });
            });
            
            // Selecionar um nível de investimento
            function selecionarNivel(nivel) {
                nivelSelecionado = nivel;
                const dadosNivel = niveisInvestimento[nivel];
                
                // Atualizar cards
                cardsNivel.forEach(card => {
                    if (card.getAttribute('data-nivel') === nivel) {
                        card.classList.add('ring-2', 'ring-blue-500');
                    } else {
                        card.classList.remove('ring-2', 'ring-blue-500');
                    }
                });
                
                // Atualizar formulário
                const opcoesHTML = dadosNivel.opcoes.map((opcao, index) => `
                    <div class="p-4 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors" data-opcao="${index}">
                        <div class="flex justify-between items-start">
                            <div>
                                <h4 class="font-medium text-gray-900">${opcao.nome}</h4>
                                <p class="text-sm text-gray-600">Retorno anual: ${(opcao.retornoAnual * 100).toFixed(1)}%</p>
                            </div>
                            <div class="text-right">
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getCorRisco(opcao.risco)}">
                                    ${opcao.risco}
                                </span>
                                <p class="text-xs text-gray-500 mt-1">Liquidez: ${opcao.liquidez}</p>
                            </div>
                        </div>
                    </div>
                `).join('');
                
                containerSimulacao.innerHTML = `
                    <div class="mb-6">
                        <h3 class="text-lg font-medium text-gray-900 mb-2">${dadosNivel.titulo}</h3>
                        <p class="text-gray-600 mb-4">${dadosNivel.descricao}</p>
                        <div class="space-y-3" id="opcoes-investimento">
                            ${opcoesHTML}
                        </div>
                    </div>
                    ${formularioSimulacao.outerHTML}
                `;
                
                // Adicionar eventos às opções de investimento
                document.querySelectorAll('#opcoes-investimento > div').forEach(opcao => {
                    opcao.addEventListener('click', function() {
                        document.querySelectorAll('#opcoes-investimento > div').forEach(o => {
                            o.classList.remove('border-blue-500', 'bg-blue-50');
                            o.classList.add('border-gray-200');
                        });
                        
                        this.classList.remove('border-gray-200');
                        this.classList.add('border-blue-500', 'bg-blue-50');
                        
                        opcaoSelecionada = niveisInvestimento[nivelSelecionado].opcoes[parseInt(this.getAttribute('data-opcao'))];
                    });
                });
                
                // Adicionar evento ao formulário
                const form = document.getElementById('simulador-formulario');
                if (form) {
                    form.addEventListener('submit', function(e) {
                        e.preventDefault();
                        if (opcaoSelecionada) {
                            executarSimulacao(opcaoSelecionada);
                        } else {
                            alert('Por favor, selecione uma opção de investimento.');
                        }
                    });
                }
                
                // Rolar para o formulário
                containerSimulacao.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            
            // Executar simulação
            function executarSimulacao(opcao) {
                const valorInicial = parseFloat(document.getElementById('valor-inicial').value) || 0;
                const aporteMensal = parseFloat(document.getElementById('aporte-mensal').value) || 0;
                const prazo = parseInt(document.getElementById('prazo').value) || 1;
                
                // Validar valores
                if (valorInicial <= 0 && aporteMensal <= 0) {
                    alert('Informe um valor inicial ou aporte mensal para simular.');
                    return;
                }
                
                // Calcular projeção
                const taxaMensal = Math.pow(1 + opcao.retornoAnual, 1/12) - 1;
                let saldo = valorInicial;
                const dadosGrafico = [];
                
                for (let mes = 0; mes <= prazo * 12; mes++) {
                    if (mes > 0) {
                        saldo = (saldo + aporteMensal) * (1 + taxaMensal);
                    }
                    dadosGrafico.push({
                        mes: mes,
                        valor: saldo,
                        aporte: valorInicial + (aporteMensal * mes)
                    });
                }
                
                // Exibir resultados
                const totalAportado = valorInicial + (aporteMensal * prazo * 12);
                const rendimento = saldo - totalAportado;
                const rendimentoPercentual = totalAportado > 0 ? (rendimento / totalAportado) * 100 : 0;
                
                // Gerar HTML do resultado
                const resultadoHTML = `
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Resultado da Simulação</h3>
                        
                        <div class="grid md:grid-cols-2 gap-6 mb-6">
                            <div>
                                <h4 class="text-sm font-medium text-gray-500 mb-1">Investimento</h4>
                                <p class="text-lg font-semibold">${opcao.nome}</p>
                                <div class="mt-2 flex items-center">
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getCorRisco(opcao.risco)} mr-2">
                                        ${opcao.risco}
                                    </span>
                                    <span class="text-sm text-gray-600">Retorno: ${(opcao.retornoAnual * 100).toFixed(1)}% a.a.</span>
                                </div>
                            </div>
                            
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Total Aportado:</span>
                                    <span class="font-medium">R$ ${totalAportado.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Valor Final:</span>
                                    <span class="font-medium text-green-600">R$ ${saldo.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                                </div>
                                <div class="flex justify-between border-t border-gray-200 pt-2">
                                    <span class="text-gray-600">Rendimento:</span>
                                    <span class="font-medium ${rendimento >= 0 ? 'text-green-600' : 'text-red-600'}">
                                        R$ ${rendimento.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                                        (${rendimentoPercentual.toFixed(2)}%)
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="h-64 mb-6">
                            <canvas id="grafico-simulacao"></canvas>
                        </div>
                        
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h4 class="font-medium text-blue-800 mb-2">Análise do Investimento</h4>
                            <p class="text-sm text-blue-700">${gerarAnaliseInvestimento(opcao, prazo, rendimentoPercentual)}</p>
                        </div>
                        
                        <div class="mt-6 flex justify-end space-x-3">
                            <button onclick="document.getElementById('simulador-resultado').classList.add('hidden')" class="px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50">
                                Fechar
                            </button>
                            <button onclick="window.print()" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700">
                                Imprimir Relatório
                            </button>
                        </div>
                    </div>
                `;
                
                resultadoSimulacao.innerHTML = resultadoHTML;
                resultadoSimulacao.classList.remove('hidden');
                
                // Rolar para o resultado
                resultadoSimulacao.scrollIntoView({ behavior: 'smooth', block: 'start' });
                
                // Gerar gráfico
                gerarGraficoSimulacao(dadosGrafico);
            }
            
            // Gerar gráfico da simulação
            function gerarGraficoSimulacao(dados) {
                const ctx = document.getElementById('grafico-simulacao');
                if (!ctx) return;
                
                // Verificar se o Chart está disponível
                if (typeof Chart === 'undefined') {
                    console.warn('Chart.js não está carregado. O gráfico não será exibido.');
                    return;
                }
                
                // Se já existir um gráfico, destrua-o
                if (window.simulacaoChart) {
                    window.simulacaoChart.destroy();
                }
                
                // Configurações do gráfico
                const config = {
                    type: 'line',
                    data: {
                        labels: dados.map((_, i) => `${i} meses`),
                        datasets: [
                            {
                                label: 'Valor Investido',
                                data: dados.map(d => d.aporte),
                                borderColor: 'rgba(99, 102, 241, 0.8)',
                                backgroundColor: 'rgba(99, 102, 241, 0.1)',
                                borderWidth: 2,
                                tension: 0.3,
                                fill: false
                            },
                            {
                                label: 'Valor Acumulado',
                                data: dados.map(d => d.valor),
                                borderColor: 'rgba(16, 185, 129, 0.8)',
                                backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                borderWidth: 2,
                                tension: 0.3,
                                fill: true
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.dataset.label}: R$ ${context.raw.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                                    }
                                }
                            },
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 20,
                                    usePointStyle: true,
                                    pointStyle: 'circle'
                                }
                            }
                        },
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Período (meses)'
                                },
                                grid: {
                                    display: false
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'Valor (R$)'
                                },
                                ticks: {
                                    callback: function(value) {
                                        return 'R$ ' + (value / 1000).toFixed(0) + 'k';
                                    }
                                }
                            }
                        }
                    }
                };
                
                // Criar o gráfico
                window.simulacaoChart = new Chart(ctx, config);
            }
            
            // Gerar análise do investimento
            function gerarAnaliseInvestimento(opcao, prazo, rendimentoPercentual) {
                let analise = '';
                
                // Análise baseada no risco
                if (opcao.risco === 'Baixo' || opcao.risco === 'Médio-Baixo') {
                    analise += 'Este é um investimento de baixo risco, ideal para objetivos de curto prazo ou para quem prioriza a segurança do capital. ';
                } else if (opcao.risco === 'Médio' || opcao.risco === 'Médio-Alto') {
                    analise += 'Este investimento apresenta um equilíbrio entre risco e retorno, adequado para objetivos de médio a longo prazo. ';
                } else {
                    analise += 'Este é um investimento de alto risco, recomendado apenas para investidores com perfil arrojado e horizonte de longo prazo. ';
                }
                
                // Análise baseada no prazo
                if (prazo < 3) {
                    analise += 'O prazo selecionado é relativamente curto, o que pode aumentar a volatilidade dos resultados. ';
                } else if (prazo >= 3 && prazo <= 10) {
                    analise += 'O prazo selecionado permite uma boa exposição ao mercado, reduzindo os riscos de curto prazo. ';
                } else {
                    analise += 'Com um prazo extenso, você tem maior potencial de aproveitar os juros compostos e superar eventuais quedas do mercado. ';
                }
                
                // Dica final
                analise += 'Lembre-se de diversificar seus investimentos e considerar seus objetivos financeiros ao montar sua carteira.';
                
                return analise;
            }
            
            // Função auxiliar para obter a cor baseada no risco
            function getCorRisco(risco) {
                switch(risco) {
                    case 'Baixo':
                        return 'bg-green-100 text-green-800';
                    case 'Médio-Baixo':
                        return 'bg-blue-100 text-blue-800';
                    case 'Médio':
                        return 'bg-yellow-100 text-yellow-800';
                    case 'Médio-Alto':
                        return 'bg-orange-100 text-orange-800';
                    case 'Alto':
                    case 'Muito Alto':
                    case 'Altíssimo':
                        return 'bg-red-100 text-red-800';
                    default:
                        return 'bg-gray-100 text-gray-800';
                }
            }
            
            // Inicializar com o nível iniciante por padrão
            if (cardsNivel.length > 0) {
                selecionarNivel('iniciante');
            }
        }
        
        // ===========================================
        // DESAFIOS MENSAlS
        // ===========================================
        
        /**
         * Inicializa a seção de desafios mensais
         */
        function inicializarDesafiosMensais() {
            const container = document.getElementById('desafios-mensais');
            if (!container) return;
            
            // Dados dos desafios
            const desafios = [
                {
                    mes: 'Janeiro',
                    titulo: 'Organização Financeira',
                    descricao: 'Aprenda a organizar suas finanças pessoais e criar um orçamento realista.',
                    tarefas: [
                        'Mapear todas as receitas e despesas',
                        'Criar categorias de gastos',
                        'Estabelecer metas financeiras para o ano',
                        'Configurar uma planilha ou aplicativo de controle financeiro'
                    ],
                    concluido: false,
                    progresso: 0
                },
                {
                    mes: 'Fevereiro',
                    titulo: 'Fundos de Emergência',
                    descricao: 'Construa sua reserva de emergência para imprevistos financeiros.',
                    tarefas: [
                        'Calcular valor ideal para reserva (3-12 meses de despesas)',
                        'Abrir conta em um banco digital com boa rentabilidade',
                        'Automatizar depósitos mensais',
                        'Atingir 25% da meta de reserva'
                    ],
                    concluido: false,
                    progresso: 25
                },
                {
                    mes: 'Março',
                    titulo: 'Educação Financeira',
                    descricao: 'Aprofunde seus conhecimentos sobre investimentos e finanças.',
                    tarefas: [
                        'Ler um livro sobre educação financeira',
                        'Assistir a 4 vídeos educativos sobre investimentos',
                        'Participar de um webinar ou curso gratuito',
                        'Criar uma lista de termos financeiros para estudar'
                    ],
                    concluido: false,
                    progresso: 50
                },
                {
                    mes: 'Abril',
                    titulo: 'Dívidas e Crédito',
                    descricao: 'Aprenda a gerenciar dívidas e melhorar sua pontuação de crédito.',
                    tarefas: [
                        'Listar todas as dívidas atuais',
                        'Criar plano de pagamento para dívidas',
                        'Verificar e corrigir seu CPF nos órgãos de proteção ao crédito',
                        'Aprender sobre taxas de juros e como negociar dívidas'
                    ],
                    concluido: true,
                    progresso: 100
                },
                {
                    mes: 'Maio',
                    titulo: 'Primeiros Investimentos',
                    descricao: 'Dê seus primeiros passos no mundo dos investimentos.',
                    tarefas: [
                        'Abrir conta em uma corretora de valores',
                        'Aplicar em um título do Tesouro Direto',
                        'Investir em um CDB com liquidez diária',
                        'Configurar metas de investimento para o ano'
                    ],
                    concluido: false,
                    progresso: 75
                },
                {
                    mes: 'Junho',
                    titulo: 'Aposentadoria',
                    descricao: 'Comece a planejar seu futuro financeiro de longo prazo.',
                    tarefas: [
                        'Calcular valor necessário para aposentadoria',
                        'Abrir uma previdência privada ou conta de investimento para aposentadoria',
                        'Aprender sobre os diferentes tipos de planos de previdência',
                        'Estabelecer contribuição mensal para aposentadoria'
                    ],
                    concluido: false,
                    progresso: 0
                },
                {
                    mes: 'Julho',
                    titulo: 'Diversificação de Portfólio',
                    descricao: 'Monte uma carteira diversificada com classes de ativos diferentes.',
                    tarefas: [
                        'Definir percentual alvo por classe (RF, Ações, Fundos, Exterior)',
                        'Adicionar ao menos 1 ETF à carteira',
                        'Incluir um título de renda fixa com prazo distinto',
                        'Registrar alocação atual e alvo para acompanhamento'
                    ],
                    concluido: true,
                    progresso: 100
                },
                {
                    mes: 'Agosto',
                    titulo: 'Rebalanceamento Semestral',
                    descricao: 'Reequilibre sua carteira para voltar aos percentuais alvo.',
                    tarefas: [
                        'Comparar alocação atual vs. alvo',
                        'Realocar aportes para reduzir desvios',
                        'Definir banda de tolerância (ex.: ±5%)',
                        'Documentar as mudanças realizadas'
                    ],
                    concluido: true,
                    progresso: 100
                },
                {
                    mes: 'Setembro',
                    titulo: 'Ações e Fundos Imobiliários',
                    descricao: 'Estude e selecione ativos para renda e crescimento.',
                    tarefas: [
                        'Ler relatório de 2 empresas e 2 FIIs',
                        'Calcular DY e P/L dos ativos escolhidos',
                        'Definir tese de investimento em 3 pontos',
                        'Realizar um pequeno aporte em 1 ativo'
                    ],
                    concluido: true,
                    progresso: 100
                },
                {
                    mes: 'Outubro',
                    titulo: 'Proteção e Seguros',
                    descricao: 'Reforce sua segurança financeira com coberturas adequadas.',
                    tarefas: [
                        'Revisar seguro de vida, residência e auto',
                        'Criar checklist de coberturas essenciais',
                        'Cotar alternativas e comparar franquias',
                        'Atualizar contatos de emergência'
                    ],
                    concluido: true,
                    progresso: 100
                },
                {
                    mes: 'Novembro',
                    titulo: 'Impostos e Declaração de IR',
                    descricao: 'Organize documentos e simule o impacto tributário dos investimentos.',
                    tarefas: [
                        'Baixar informes das corretoras',
                        'Preencher planilha de apuração (day trade/mercado à vista)',
                        'Simular DARF quando aplicável',
                        'Organizar notas de corretagem por mês'
                    ],
                    concluido: true,
                    progresso: 100
                },
                {
                    mes: 'Dezembro',
                    titulo: 'Revisão Anual e Planejamento',
                    descricao: 'Feche o ano avaliando resultados e definindo metas para o próximo.',
                    tarefas: [
                        'Comparar desempenho real vs. meta',
                        'Revisar perfil de risco e alocação',
                        'Definir 3 metas SMART para o próximo ano',
                        'Criar plano de aportes mensais'
                    ],
                    concluido: true,
                    progresso: 100
                }
            ];
            
            // Elementos da interface
            const listaDesafios = document.getElementById('lista-desafios');
            const filtroMes = document.getElementById('filtro-mes');
            const filtroStatus = document.getElementById('filtro-status');
            
            // Inicializar a lista de desafios
            function carregarDesafios(filtroMes = 'todos', filtroStatus = 'todos') {
                if (!listaDesafios) return;
                
                // Filtrar desafios
                const desafiosFiltrados = desafios.filter(desafio => {
                    const mesFiltro = filtroMes === 'todos' || desafio.mes.toLowerCase() === filtroMes.toLowerCase();
                    const statusFiltro = filtroStatus === 'todos' || 
                                       (filtroStatus === 'concluidos' && desafio.concluido) ||
                                       (filtroStatus === 'pendentes' && !desafio.concluido);
                    
                    return mesFiltro && statusFiltro;
                });
                
                // Ordenar desafios (concluídos por último)
                desafiosFiltrados.sort((a, b) => {
                    if (a.concluido && !b.concluido) return 1;
                    if (!a.concluido && b.concluido) return -1;
                    return 0;
                });
                
                // Gerar HTML dos desafios
                listaDesafios.innerHTML = desafiosFiltrados.map(desafio => `
                    <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden ${desafio.concluido ? 'opacity-75' : ''}">
                        <div class="p-5">
                            <div class="flex justify-between items-start">
                                <div>
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 mb-2">
                                        ${desafio.mes}
                                    </span>
                                    <h3 class="text-lg font-medium text-gray-900">${desafio.titulo}</h3>
                                    <p class="mt-1 text-gray-600">${desafio.descricao}</p>
                                </div>
                                <button class="desafio-toggle p-2 rounded-full ${desafio.concluido ? 'text-green-600 bg-green-50 hover:bg-green-100' : 'text-gray-400 hover:text-gray-500 hover:bg-gray-50'}" 
                                        data-mes="${desafio.mes.toLowerCase()}">
                                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                    </svg>
                                </button>
                            </div>
                            
                            <div class="mt-4">
                                <h4 class="text-sm font-medium text-gray-700 mb-2">Tarefas:</h4>
                                <ul class="space-y-2">
                                    ${desafio.tarefas.map((tarefa, index) => `
                                        <li class="flex items-start">
                                            <span class="flex-shrink-0 h-5 w-5 text-${desafio.progresso >= ((index + 1) / desafio.tarefas.length) * 100 ? 'green' : 'gray'}-500">
                                                <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                                </svg>
                                            </span>
                                            <span class="ml-2 text-sm text-gray-600">${tarefa}</span>
                                        </li>
                                    `).join('')}
                                </ul>
                            </div>
                            
                            <div class="mt-4">
                                <div class="flex justify-between text-sm text-gray-600 mb-1">
                                    <span>Progresso</span>
                                    <span>${desafio.progresso}%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2.5">
                                    <div class="bg-blue-600 h-2.5 rounded-full" style="width: ${desafio.progresso}%"></div>
                                </div>
                            </div>
                            
                            <div class="mt-4 flex justify-between items-center">
                                <button class="text-sm font-medium text-blue-600 hover:text-blue-800" 
                                        onclick="expandirDesafio('${desafio.mes.toLowerCase()}')">
                                    Ver detalhes
                                </button>
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${desafio.concluido ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}">
                                    ${desafio.concluido ? 'Concluído' : 'Em andamento'}
                                </span>
                            </div>
                        </div>
                        
                        <!-- Detalhes expandidos (inicialmente ocultos) -->
                        <div class="border-t border-gray-200 px-5 py-4 bg-gray-50 hidden" id="detalhes-${desafio.mes.toLowerCase()}">
                            <h4 class="text-sm font-medium text-gray-700 mb-2">Dicas e Recursos:</h4>
                            <ul class="list-disc pl-5 space-y-1 text-sm text-gray-600">
                                <li>Assista a vídeos explicativos sobre o tema</li>
                                <li>Participe de nossa comunidade para tirar dúvidas</li>
                                <li>Baixe nossa planilha de acompanhamento</li>
                                <li>Agende uma mentoria com especialistas</li>
                            </ul>
                            
                            <div class="mt-4 flex flex-wrap gap-2">
                                <button class="inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                    Baixar Materiais
                                </button>
                                <button class="inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                    Compartilhar
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
                
                // Adicionar eventos aos botões de toggle
                document.querySelectorAll('.desafio-toggle').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const mes = this.getAttribute('data-mes');
                        toggleConclusaoDesafio(mes);
                    });
                });
            }
            
            // Alternar status de conclusão de um desafio
            function toggleConclusaoDesafio(mes) {
                const desafio = desafios.find(d => d.mes.toLowerCase() === mes);
                if (desafio) {
                    desafio.concluido = !desafio.concluido;
                    carregarDesafios(filtroMes.value, filtroStatus.value);
                    
                    // Mostrar feedback visual
                    const toast = document.createElement('div');
                    toast.className = 'fixed bottom-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg transform transition-all duration-300 translate-y-2 opacity-0';
                    toast.textContent = `Desafio de ${desafio.mes} ${desafio.concluido ? 'concluído' : 'marcado como pendente'}!`;
                    document.body.appendChild(toast);
                    
                    // Animar entrada
                    setTimeout(() => {
                        toast.classList.remove('translate-y-2', 'opacity-0');
                        toast.classList.add('translate-y-0', 'opacity-100');
                    }, 10);
                    
                    // Remover após 3 segundos
                    setTimeout(() => {
                        toast.classList.add('translate-y-2', 'opacity-0');
                        setTimeout(() => toast.remove(), 300);
                    }, 3000);
                }
            }
            
            // Expandir/Recolher detalhes do desafio
            window.expandirDesafio = function(mes) {
                const detalhes = document.getElementById(`detalhes-${mes}`);
                if (detalhes) {
                    detalhes.classList.toggle('hidden');
                    
                    // Rolar para o elemento se estiver expandindo
                    if (!detalhes.classList.contains('hidden')) {
                        detalhes.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                    }
                }
            };
            
            // Inicializar filtros
            if (filtroMes) {
                filtroMes.addEventListener('change', () => {
                    carregarDesafios(filtroMes.value, filtroStatus.value);
                });
            }
            
            if (filtroStatus) {
                filtroStatus.addEventListener('change', () => {
                    carregarDesafios(filtroMes.value, filtroStatus.value);
                });
            }
            
            // Inicializar a lista de desafios
            carregarDesafios();
        }
        
        
        /* =============================
           Busca Global (Ctrl/Cmd+K)
           ============================= */
        (function(){
            const state = { items: [], filtered: [], indexBuilt: false, selected: 0 };
            function ensureIds(el){
                if (!el.id) {
                    const base = el.textContent.trim().toLowerCase().replace(/[^a-z0-9à-ú]+/gi,'-').replace(/^-+|-+$/g,'');
                    let id = base || 'secao';
                    let i = 1;
                    while (document.getElementById(id)) { id = base + '-' + (i++); }
                    el.id = id;
                }
                return el.id;
            }
            function buildIndex(){
                if (state.indexBuilt) return;
                const headings = Array.from(document.querySelectorAll('h1, h2, h3'))
                    .filter(h => h.closest('.page'));
                state.items = headings.map(h => {
                    const id = ensureIds(h);
                    const chapter = h.closest('[id^="cap"]');
                    const chapterId = chapter ? chapter.id : '';
                    return { id, text: h.textContent.trim(), level: h.tagName, chapterId };
                }).filter(x => x.text.length >= 2);
                state.indexBuilt = true;
            }
            function openModal(){
                buildIndex();
                const modal = document.getElementById('searchModal');
                const input = document.getElementById('searchInput');
                const list = document.getElementById('searchList');
                if (!modal || !input || !list) return;
                modal.classList.remove('hidden');
                document.getElementById('searchOverlay')?.classList.remove('hidden');
                input.value = '';
                state.filtered = state.items;
                state.selected = 0;
                renderList();
                setTimeout(()=> input.focus(), 10);
            }
            function closeModal(){
                document.getElementById('searchModal')?.classList.add('hidden');
                document.getElementById('searchOverlay')?.classList.add('hidden');
            }
            function renderList(){
                const list = document.getElementById('searchList');
                if (!list) return;
                list.innerHTML = state.filtered.slice(0, 50).map((item, idx)=>`
                    <li class="px-3 py-2 rounded-md cursor-pointer ${idx===state.selected? 'bg-blue-600 text-white' : 'hover:bg-gray-100 dark:hover:bg-gray-700'}" data-id="${item.id}">
                        <div class="text-sm font-medium">${item.text}</div>
                        <div class="text-xs opacity-70">${item.chapterId || ''} • ${item.level}</div>
                    </li>`).join('');
            }
            function doFilter(q){
                const s = q.trim().toLowerCase();
                state.filtered = !s ? state.items : state.items.filter(it => it.text.toLowerCase().includes(s));
                state.selected = 0;
                renderList();
            }
            function goToSelected(){
                const item = state.filtered[state.selected];
                if (!item) return;
                closeModal();
                const el = document.getElementById(item.id);
                if (el) {
                    el.scrollIntoView({behavior:'smooth', block:'start'});
                    history.replaceState(null, '', `#${item.id}`);
                }
            }
            document.addEventListener('keydown', (e)=>{
                const isK = (e.key === 'k' || e.key === 'K');
                if ((e.ctrlKey || e.metaKey) && isK) { e.preventDefault(); openModal(); }
                if (e.key === 'Escape') closeModal();
            });
            document.addEventListener('click', (e)=>{
                if ((e.target).id === 'searchOverlay') closeModal();
            });
            document.getElementById('searchInput')?.addEventListener('input', (e)=> doFilter(e.target.value));
            document.getElementById('searchList')?.addEventListener('click', (e)=>{
                const li = (e.target.closest('li'));
                if (!li) return;
                const id = li.getAttribute('data-id');
                const idx = state.filtered.findIndex(x=>x.id===id);
                if (idx>=0) { state.selected = idx; goToSelected(); }
            });
            document.getElementById('searchInput')?.addEventListener('keydown', (e)=>{
                if (e.key === 'ArrowDown') { e.preventDefault(); state.selected = Math.min(state.selected+1, state.filtered.length-1); renderList(); }
                if (e.key === 'ArrowUp')   { e.preventDefault(); state.selected = Math.max(state.selected-1, 0); renderList(); }
                if (e.key === 'Enter')     { e.preventDefault(); goToSelected(); }
            });
            // Expor para botão (se existir no header)
            window.openSearch = openModal;
        })();

        /* =====================================
           Navegação de Capítulos e Barra Fixa
           ===================================== */
        (function(){
            const chapterIds = Array.from({length:10}, (_,i)=>`cap${i+1}`);
            const names = {
                cap1:'Capítulo 1', cap2:'Capítulo 2', cap3:'Capítulo 3', cap4:'Capítulo 4', cap5:'Capítulo 5',
                cap6:'Capítulo 6', cap7:'Capítulo 7', cap8:'Capítulo 8', cap9:'Capítulo 9', cap10:'Capítulo 10'
            };
            const footer = document.getElementById('chapterFooter');
            const prog = document.getElementById('chapterProgress');
            const prevBtn = document.getElementById('prevChapter');
            const nextBtn = document.getElementById('nextChapter');
            if (!footer || !prog || !prevBtn || !nextBtn) return;
            function getCurrentChapterIndex(){
                const centers = chapterIds.map((id, idx)=>{
                    const el = document.getElementById(id);
                    if (!el) return {idx, dist: Infinity};
                    const r = el.getBoundingClientRect();
                    const dist = Math.abs(r.top - window.innerHeight*0.2); // topo a 20% da viewport
                    return {idx, dist};
                }).sort((a,b)=>a.dist-b.dist);
                return centers[0]?.idx ?? 0;
            }
            function updateNav(){
                const i = getCurrentChapterIndex();
                const curId = chapterIds[i];
                const curEl = document.getElementById(curId);
                // Prev/Next enable
                prevBtn.disabled = i===0; nextBtn.disabled = i===chapterIds.length-1;
                prevBtn.setAttribute('data-target', chapterIds[Math.max(0,i-1)]);
                nextBtn.setAttribute('data-target', chapterIds[Math.min(chapterIds.length-1,i+1)]);
                prevBtn.title = i>0? names[chapterIds[i-1]]: 'Início';
                nextBtn.title = i<chapterIds.length-1? names[chapterIds[i+1]]: 'Fim';
                // Progresso do capítulo atual
                if (curEl) {
                    const top = curEl.offsetTop;
                    const height = curEl.offsetHeight;
                    const y = window.scrollY + 8; // margem
                    const pct = Math.max(0, Math.min(1, (y - top) / Math.max(1, (height - window.innerHeight))));
                    prog.style.width = (pct*100).toFixed(1)+'%';
                }
            }
            prevBtn.addEventListener('click', ()=>{
                const id = prevBtn.getAttribute('data-target');
                const el = document.getElementById(id);
                if (el) el.scrollIntoView({behavior:'smooth', block:'start'});
            });
            nextBtn.addEventListener('click', ()=>{
                const id = nextBtn.getAttribute('data-target');
                const el = document.getElementById(id);
                if (el) el.scrollIntoView({behavior:'smooth', block:'start'});
            });
            window.addEventListener('scroll', updateNav, {passive:true});
            window.addEventListener('resize', updateNav);
            document.addEventListener('DOMContentLoaded', updateNav);
            updateNav();
        })();

        /* =============================
           Mini TOC do Capítulo Atual
           ============================= */
        (function(){
            const toc = document.getElementById('miniToc');
            if (!toc) return;
            const chapterIds = Array.from({length:10}, (_,i)=>`cap${i+1}`);
            function currentChapterEl(){
                // mais visível perto do topo
                let best = null, bestDist = Infinity;
                chapterIds.forEach(id=>{
                    const el = document.getElementById(id); if (!el) return;
                    const d = Math.abs(el.getBoundingClientRect().top - 80);
                    if (d < bestDist) { bestDist = d; best = el; }
                });
                return best;
            }
            function buildToc(){
                const chap = currentChapterEl();
                if (!chap) return;
                const heads = Array.from(chap.querySelectorAll('h2, h3'));
                const items = heads.map(h=>{
                    if (!h.id) h.id = h.textContent.trim().toLowerCase().replace(/[^a-z0-9à-ú]+/gi,'-');
                    return {id: h.id, text: h.textContent.trim(), level: h.tagName};
                });
                const collapsed = localStorage.getItem('miniTocCollapsed') === '1';
                toc.innerHTML = `
                    <div class="toc-header mb-2">
                        <div class="text-xs uppercase tracking-wider text-gray-500">Neste capítulo</div>
                        <button id="miniTocToggle" class="text-gray-500 hover:text-gray-700 dark:text-gray-300" aria-expanded="${!collapsed}">
                            <i class="fas fa-chevron-down chev"></i>
                        </button>
                    </div>
                    <ul class="toc-list space-y-1">${items.map(it=>`
                        <li><a href="#${it.id}" class="toc-link text-sm text-gray-600 dark:text-gray-300 hover:text-primary-600 truncate ${it.level==='H3'?'pl-3':''}">${it.text}</a></li>
                    `).join('')}</ul>`;
                // apply collapsed state
                toc.classList.toggle('collapsed', collapsed);
                qs('#miniTocToggle', toc)?.addEventListener('click', ()=>{
                    const isCollapsed = toc.classList.toggle('collapsed');
                    localStorage.setItem('miniTocCollapsed', isCollapsed ? '1' : '0');
                });
                // Highlight ativo
                const links = Array.from(toc.querySelectorAll('a'));
                const map = new Map(links.map(a=>[a.getAttribute('href').slice(1), a]));
                const obs = new IntersectionObserver((entries)=>{
                    entries.forEach(en=>{
                        const a = map.get(en.target.id);
                        if (!a) return;
                        if (en.isIntersecting) {
                            links.forEach(l=>l.classList.remove('active'));
                            a.classList.add('active');
                        }
                    });
                }, {threshold:0.4, rootMargin:'-10% 0px -60% 0px'});
                heads.forEach(h=>obs.observe(h));
            }
            window.addEventListener('scroll', buildToc, {passive:true});
            window.addEventListener('resize', buildToc);
            document.addEventListener('DOMContentLoaded', buildToc);
            buildToc();
        })();

        
    </script>
    
    <!-- Global Search Modal -->
    <div id="searchOverlay" class="hidden fixed inset-0 bg-black/40 z-40"></div>
    <div id="searchModal" class="hidden fixed inset-0 z-50 flex items-start justify-center pt-24 px-4">
        <div class="w-full max-w-2xl rounded-lg bg-white dark:bg-gray-800 shadow-xl border border-gray-200 dark:border-gray-700">
            <div class="px-4 py-3 border-b border-gray-200 dark:border-gray-700">
                <input id="searchInput" type="text" placeholder="Buscar (Ctrl/Cmd + K)" class="w-full bg-transparent outline-none text-gray-900 dark:text-gray-100 placeholder-gray-400" />
            </div>
            <ul id="searchList" class="max-h-80 overflow-auto p-2"></ul>
            <div class="px-4 py-2 text-xs text-gray-500 border-t border-gray-200 dark:border-gray-700">Setas para navegar • Enter para ir • Esc para fechar</div>
        </div>
    </div>

    

    <!-- Mini TOC (desktop) -->
    <nav id="miniToc" class="hidden lg:block fixed right-4 top-24 z-20 w-64 p-3 rounded-lg bg-white/90 dark:bg-gray-900/90 backdrop-blur border border-gray-200 dark:border-gray-700 shadow-sm"></nav>

    
    <!-- Script externo do guia -->
    <script src="js/guia.js"></script>

    </body>
    </html>
